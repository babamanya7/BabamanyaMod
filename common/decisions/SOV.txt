####### NO STEP BACK! #######
@DAYS_DETERMINED = 180 #Used for propaganda campaign SOV_heroes_forward -> Value should be the same as SOV_default_propaganda_campaign_duration

SOV_gosproyektstroy_decision_category = {
	SOV_gosproyektstroy_bring_foreign_experts = {
		priority = 50

		icon = hol_attract_foreign_investors

		ai_will_do = {
			base = 10
		}

		targets = { USA ENG GER JAP }

		#target_trigger = {
		#	FROM = { SOV_is_valid_subject = yes }
		#}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_idea = SOV_gosproyektstroy_1
			NOT = { has_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag }
			FROM = {
				has_opinion = {
					target = ROOT
					value > 29
				}
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
			}
		}

		days_remove = SOV_gosproyektstroy_decision_time

		fire_only_once = yes

		visible = {
			has_idea = SOV_gosproyektstroy_1
			NOT = { has_country_flag = SOV_gosproyektstroy_level_2_flag }
			NOT = { has_country_flag = SOV_gosproyektstroy_level_3_flag }
			country_exists = FROM
			NOT = { has_war_with = FROM }
			FROM = { SOV_is_valid_subject = yes }
		}

		cost = SOV_gosproyektstroy_decision_cost

		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			set_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}

		remove_effect = {
			if = {
				limit = {
					FROM = { tag = USA }
				}
				set_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 1 } #USA
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_1
					add_idea = SOV_gosproyektstroy_2_usa
				}
			}
			else_if = {
				limit = {
					FROM = { tag = ENG }
				}
				set_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 2 } #ENG
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_1
					add_idea = SOV_gosproyektstroy_2_eng
				}
			}
			else_if = {
				limit = {
					FROM = { tag = GER }
				}
				set_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 3 } #GER
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_1
					add_idea = SOV_gosproyektstroy_2_ger
				}
			}
			else_if = {
				limit = {
					FROM = { tag = JAP }
				}
				set_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 4 } #JAP
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_1
					add_idea = SOV_gosproyektstroy_2_jap
				}
			}

			clr_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}
	}

	SOV_gosproyektstroy_focus_civ = {
		priority = 13

		icon = generic_construction

		ai_will_do = {
			base = 0.75
			modifier = {
				factor = 0
				OR = {
					has_war = yes
					any_other_country = {
						OR ={
							is_justifying_wargoal_against = ROOT
							ROOT = { is_justifying_wargoal_against = PREV }
						}
					}
				}
			}
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa #Done like this for tooltip purposes
				hidden_trigger = {
					OR = {
						has_idea = SOV_gosproyektstroy_2_eng
						has_idea = SOV_gosproyektstroy_2_ger
						has_idea = SOV_gosproyektstroy_2_jap
					}
				}
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag }
		}

		days_remove = SOV_gosproyektstroy_decision_time

		fire_only_once = yes

		visible = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa
				has_idea = SOV_gosproyektstroy_2_eng
				has_idea = SOV_gosproyektstroy_2_ger
				has_idea = SOV_gosproyektstroy_2_jap
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_level_3_flag }
		}

		cost = SOV_gosproyektstroy_decision_cost

		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			set_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}

		remove_effect = {
			set_country_flag = { flag = SOV_gosproyektstroy_level_3_flag value = 1 } #CIV
			if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 1 } #USA
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_usa
					add_idea = SOV_gosproyektstroy_3_usa_civ
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 2 } #ENG
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_eng
					add_idea = SOV_gosproyektstroy_3_eng_civ
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 3 } #GER
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_ger
					add_idea = SOV_gosproyektstroy_3_ger_civ
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 4 } #JAP
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_jap
					add_idea = SOV_gosproyektstroy_3_jap_civ
				}
			}

			clr_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}
	}

	SOV_gosproyektstroy_focus_mil = {
		priority = 12

		icon = generic_industry

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				OR = {
					has_war = yes
					any_other_country = {
						OR ={
							is_justifying_wargoal_against = ROOT
							ROOT = { is_justifying_wargoal_against = PREV }
						}
					}
				}
			}
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa #Done like this for tooltip purposes
				hidden_trigger = {
					OR = {
						has_idea = SOV_gosproyektstroy_2_eng
						has_idea = SOV_gosproyektstroy_2_ger
						has_idea = SOV_gosproyektstroy_2_jap
					}
				}
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag }
		}

		days_remove = SOV_gosproyektstroy_decision_time

		fire_only_once = yes

		visible = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa
				has_idea = SOV_gosproyektstroy_2_eng
				has_idea = SOV_gosproyektstroy_2_ger
				has_idea = SOV_gosproyektstroy_2_jap
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_level_3_flag }
		}

		cost = SOV_gosproyektstroy_decision_cost

		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			set_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}

		remove_effect = {
			set_country_flag = { flag = SOV_gosproyektstroy_level_3_flag value = 2 } #MIL
			if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 1 } #USA
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_usa
					add_idea = SOV_gosproyektstroy_3_usa_mil
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 2 } #ENG
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_eng
					add_idea = SOV_gosproyektstroy_3_eng_mil
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 3 } #GER
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_ger
					add_idea = SOV_gosproyektstroy_3_ger_mil
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 4 } #JAP
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_jap
					add_idea = SOV_gosproyektstroy_3_jap_mil
				}
			}

			clr_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}
	}

	SOV_gosproyektstroy_focus_dock = {
		priority = 11

		icon = GFX_decision_generic_naval

		ai_will_do = {
			base = 0.5
			modifier = {
				factor = 2
				has_completed_focus = SOV_pc_of_the_ussr_navy
				has_completed_focus = SOV_expand_shipbuilding_plants
			}
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa #Done like this for tooltip purposes
				hidden_trigger = {
					OR = {
						has_idea = SOV_gosproyektstroy_2_eng
						has_idea = SOV_gosproyektstroy_2_ger
						has_idea = SOV_gosproyektstroy_2_jap
					}
				}
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag }
		}

		days_remove = SOV_gosproyektstroy_decision_time

		fire_only_once = yes

		visible = {
			OR = {
				has_idea = SOV_gosproyektstroy_2_usa
				has_idea = SOV_gosproyektstroy_2_eng
				has_idea = SOV_gosproyektstroy_2_ger
				has_idea = SOV_gosproyektstroy_2_jap
			}
			NOT = { has_country_flag = SOV_gosproyektstroy_level_3_flag }
		}

		cost = SOV_gosproyektstroy_decision_cost

		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			set_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}

		remove_effect = {
			set_country_flag = { flag = SOV_gosproyektstroy_level_3_flag value = 3 } #DOCK
			if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 1 } #USA
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_usa
					add_idea = SOV_gosproyektstroy_3_usa_dock
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 2 } #ENG
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_eng
					add_idea = SOV_gosproyektstroy_3_eng_dock
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 3 } #GER
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_ger
					add_idea = SOV_gosproyektstroy_3_ger_dock
				}
			}
			else_if = {
				limit = {
					has_country_flag = { flag = SOV_gosproyektstroy_level_2_flag value = 4 } #JAP
				}
				swap_ideas = {
					remove_idea = SOV_gosproyektstroy_2_jap
					add_idea = SOV_gosproyektstroy_3_jap_dock
				}
			}

			clr_country_flag = SOV_gosproyektstroy_upgrade_in_progress_flag
		}
	}
}




########     ###    ########     ###    ##    ##  #######  ####    ###    
##     ##   ## ##   ##     ##   ## ##   ###   ## ##     ##  ##    ## ##   
##     ##  ##   ##  ##     ##  ##   ##  ####  ## ##     ##  ##   ##   ##  
########  ##     ## ########  ##     ## ## ## ## ##     ##  ##  ##     ## 
##        ######### ##   ##   ######### ##  #### ##     ##  ##  ######### 
##        ##     ## ##    ##  ##     ## ##   ### ##     ##  ##  ##     ## 
##        ##     ## ##     ## ##     ## ##    ##  #######  #### ##     ## 


SOV_paranoia_system = {

	SOV_forge_production_reports = { #Repeatable decision to reduce Paranoia
		priority = 310

		icon = GFX_decision_eng_trade_unions_support

		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				check_variable = { SOV_paranoia > 35 }
			}
			modifier = {
				add = 100
				check_variable = { SOV_paranoia > 75 }
			}
			modifier = {
				factor = 2
			}
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		cost = SOV_paranoia_calm_down_stalin_decision_cost

		days_re_enable = SOV_paranoia_calm_down_stalin_re_enable_days

		days_remove = 90

		modifier = {
			consumer_goods_factor = 0.02
		}

		complete_effect = {
			SOV_paranoia_medium_decrease_effect = yes

			custom_effect_tooltip = SOV_paranoia_calm_down_stalin_cd_tt
		}
	}

	SOV_inspection_in_the_administration = { #Repeatable decision to reduce Paranoia // Target Administration
		priority = 309

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
			custom_trigger_tooltip = {
				tooltip = SOV_paranoia_administration_purgeable_tt
				OR = {
					any_character = {
						is_character_slot = political_advisor
						SOV_character_can_be_purged = yes
					}
					NOT = { has_idea = SOV_understaffed_bureaucracy }
					NOT = { has_idea = SOV_lavrenty_beriya }
				}
			}
			NOT = { has_country_flag = SOV_paranoia_conducting_inspection_flag }
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			OR = {
				any_character = {
					is_character_slot = political_advisor
					SOV_character_can_be_purged = yes
				}
				NOT = { has_idea = SOV_understaffed_bureaucracy }
				NOT = { has_idea = SOV_lavrenty_beriya }
			}
			 
		}

		cost = SOV_paranoia_inspection_decision_cost

		days_remove = SOV_paranoia_inspection_remove_days

		days_re_enable = SOV_paranoia_inspection_re_enable_days

		complete_effect = {
			set_country_flag = SOV_paranoia_conducting_inspection_flag #Used to prevent random purges from popping up while this is active
		}

		remove_effect = {
			clr_country_flag = SOV_paranoia_conducting_inspection_flag
			set_country_flag = { flag = SOV_paranoia_random_purge_cooldown_from_decision_flag days = 15 } #Used to prevent random purges from popping up immediately after this is completed

			SOV_pick_regular_purge_administration_type_effect = yes
			SOV_paranoia_low_decrease_effect = yes

			custom_effect_tooltip = SOV_paranoia_inspection_cd_tt
		}
	}

	SOV_inspection_in_the_army = { #Repeatable decision to reduce Paranoia // Target Army
		priority = 308

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
			custom_trigger_tooltip = {
				tooltip = SOV_paranoia_army_purgeable_tt
				OR = {
					any_army_leader = {
						SOV_character_can_be_purged = yes
					}
					NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_army }
					NOT = { has_idea = SOV_training_activities_curtailed }
				}
			}
			NOT = { has_country_flag = SOV_paranoia_conducting_inspection_flag }
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			OR = {
				any_army_leader = {
					SOV_character_can_be_purged = yes
				}
				NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_army }
				NOT = { has_idea = SOV_training_activities_curtailed }
			}
			 
		}

		cost = SOV_paranoia_inspection_decision_cost

		days_remove = SOV_paranoia_inspection_remove_days

		days_re_enable = SOV_paranoia_inspection_re_enable_days

		complete_effect = {
			set_country_flag = SOV_paranoia_conducting_inspection_flag #Used to prevent random purges from popping up while this is active
		}

		remove_effect = {
			clr_country_flag = SOV_paranoia_conducting_inspection_flag
			set_country_flag = { flag = SOV_paranoia_random_purge_cooldown_from_decision_flag days = 15 } #Used to prevent random purges from popping up immediately after this is completed

			SOV_pick_regular_purge_army_type_effect = yes
			SOV_paranoia_medium_decrease_effect = yes
			

			custom_effect_tooltip = SOV_paranoia_inspection_cd_tt
		}
	}

	SOV_inspection_in_the_navy = { #Repeatable decision to reduce Paranoia // Target Navy
		priority = 307

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
			custom_trigger_tooltip = {
				tooltip = SOV_paranoia_navy_purgeable_tt
				OR = {
					any_navy_leader = {
						SOV_character_can_be_purged = yes
					}
					NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_navy }
					NOT = { has_idea = SOV_shipyard_staff_purged }
				}
			}
			NOT = { has_country_flag = SOV_paranoia_conducting_inspection_flag }
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			OR = {
				any_navy_leader = {
					SOV_character_can_be_purged = yes
				}
				NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_navy }
				NOT = { has_idea = SOV_shipyard_staff_purged }
			}
			 
		}

		cost = SOV_paranoia_inspection_decision_cost

		days_remove = SOV_paranoia_inspection_remove_days

		days_re_enable = SOV_paranoia_inspection_re_enable_days

		complete_effect = {
			set_country_flag = SOV_paranoia_conducting_inspection_flag #Used to prevent random purges from popping up while this is active
		}

		remove_effect = {
			clr_country_flag = SOV_paranoia_conducting_inspection_flag
			set_country_flag = { flag = SOV_paranoia_random_purge_cooldown_from_decision_flag days = 15 } #Used to prevent random purges from popping up immediately after this is completed

			SOV_pick_regular_purge_navy_type_effect = yes
			SOV_paranoia_low_decrease_effect = yes
			

			custom_effect_tooltip = SOV_paranoia_inspection_cd_tt
		}
	}

	SOV_inspection_in_the_airforce = { #Repeatable decision to reduce Paranoia // Target Airforce
		priority = 306

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
			custom_trigger_tooltip = {
				tooltip = SOV_paranoia_airforce_purgeable_tt
				OR = {
					NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_airforce }
					NOT = { has_idea = SOV_ground_based_training }
				}
			}
			NOT = { has_country_flag = SOV_paranoia_conducting_inspection_flag }
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			OR = {
				NOT = { has_idea = SOV_anti_soviet_military_thinking_banned_airforce }
				NOT = { has_idea = SOV_ground_based_training }
			}
			 
		}

		cost = SOV_paranoia_inspection_decision_cost

		days_remove = SOV_paranoia_inspection_remove_days

		days_re_enable = SOV_paranoia_inspection_re_enable_days

		complete_effect = {
			set_country_flag = SOV_paranoia_conducting_inspection_flag #Used to prevent random purges from popping up while this is active
		}

		remove_effect = {
			clr_country_flag = SOV_paranoia_conducting_inspection_flag
			set_country_flag = { flag = SOV_paranoia_random_purge_cooldown_from_decision_flag days = 15 } #Used to prevent random purges from popping up immediately after this is completed

			SOV_pick_regular_purge_airforce_type_effect = yes
			SOV_paranoia_low_decrease_effect = yes
			
			custom_effect_tooltip = SOV_paranoia_inspection_cd_tt
		}
	}

	SOV_loosen_prohibitions_in_military_academies_dec = {
		priority = 300

		icon = generic_brainwash

		ai_will_do = {
			base = 10
			modifier = {
				factor = 2
				has_war = yes
			}
			modifier = {
				factor = 10
				has_idea = SOV_anti_soviet_military_thinking_banned_army
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = { flag = SOV_third_moscow_trial_flag days > 365 }
		}

		visible = {
			OR = {
				has_idea = SOV_anti_soviet_military_thinking_banned_army
				has_idea = SOV_anti_soviet_military_thinking_banned_navy
				has_idea = SOV_anti_soviet_military_thinking_banned_airforce
			}
			 
		}

		days_remove = 30

		cost = 50

		modifier = {
			command_power_gain = -0.2
			political_power_gain = -0.2
		}

		complete_effect = {
		}

		remove_effect = {
			if = {
				limit = {
					has_idea = SOV_anti_soviet_military_thinking_banned_army
				}
				remove_ideas = SOV_anti_soviet_military_thinking_banned_army
			}
			if = {
				limit = {
					has_idea = SOV_anti_soviet_military_thinking_banned_navy
				}
				remove_ideas = SOV_anti_soviet_military_thinking_banned_navy
			}
			if = {
				limit = {
					has_idea = SOV_anti_soviet_military_thinking_banned_airforce
				}
				remove_ideas = SOV_anti_soviet_military_thinking_banned_airforce
			}
		}
	}

	SOV_reinforce_army_officer_ranks_with_veterans_dec = {
		priority = 291

		icon = generic_prepare_civil_war

		ai_will_do = {
			base = 10
			modifier = {
				factor = 2
				has_war = yes
			}
			modifier = {
				factor = 5
				has_idea = SOV_purged_junior_army_officers_2
			}
			modifier = {
				factor = 10
				has_idea = SOV_purged_junior_army_officers_3
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = { flag = SOV_third_moscow_trial_flag days > 365 }
		}

		visible = {
			OR = {
				has_idea = SOV_purged_junior_army_officers_1
				has_idea = SOV_purged_junior_army_officers_2
				has_idea = SOV_purged_junior_army_officers_3
			}
			 
		}

		days_remove = SOV_reinforce_officer_ranks_days

		days_re_enable = 1

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 49
			has_army_experience > 49
		}
		custom_cost_text = decision_cost_CP_50_pp_50_ArmXP_50

		complete_effect = {
			hidden_effect = {
				add_command_power = -50
				add_political_power = -50
				army_experience = -50
			}
		}

		remove_effect = {
			if = {
				limit = {
					has_idea = SOV_purged_junior_army_officers_3
				}
				swap_ideas = {
					remove_idea = SOV_purged_junior_army_officers_3
					add_idea = SOV_purged_junior_army_officers_2
				}
			}
			else_if = {
				limit = {
					has_idea = SOV_purged_junior_army_officers_2
				}
				swap_ideas = {
					remove_idea = SOV_purged_junior_army_officers_2
					add_idea = SOV_purged_junior_army_officers_1
				}
			}
			else_if = {
				limit = {
					has_idea = SOV_purged_junior_army_officers_1
				}
				remove_ideas = SOV_purged_junior_army_officers_1
			}
		}
	}

	SOV_reinforce_navy_officer_ranks_with_veterans_dec = {
		priority = 290

		icon = generic_naval

		ai_will_do = {
			base = 10
			modifier = {
				factor = 10
				has_war = yes
			}
			modifier = {
				factor = 10
				has_idea = SOV_purged_junior_navy_officers_2
			}
			modifier = {
				factor = 50
				has_idea = SOV_purged_junior_navy_officers_3
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = { flag = SOV_third_moscow_trial_flag days > 365 }
		}

		visible = {
			OR = {
				has_idea = SOV_purged_junior_navy_officers_1
				has_idea = SOV_purged_junior_navy_officers_2
				has_idea = SOV_purged_junior_navy_officers_3
			}
			 
		}

		days_remove = SOV_reinforce_officer_ranks_days

		days_re_enable = 1

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 49
			has_navy_experience > 49
		}
		custom_cost_text = decision_cost_CP_50_pp_50_NavXP_50

		complete_effect = {
			hidden_effect = {
				add_command_power = -50
				add_political_power = -50
				navy_experience = -50
			}
		}

		remove_effect = {
			if = {
				limit = {
					has_idea = SOV_purged_junior_navy_officers_3
				}
				swap_ideas = {
					remove_idea = SOV_purged_junior_navy_officers_3
					add_idea = SOV_purged_junior_navy_officers_2
				}
			}
			else_if = {
				limit = {
					has_idea = SOV_purged_junior_navy_officers_2
				}
				swap_ideas = {
					remove_idea = SOV_purged_junior_navy_officers_2
					add_idea = SOV_purged_junior_navy_officers_1
				}
			}
			else_if = {
				limit = {
					has_idea = SOV_purged_junior_navy_officers_1
				}
				remove_ideas = SOV_purged_junior_navy_officers_1
			}
			else = {
				log = "I CANNOT REMOVE A NS THAT DOESN'T EXIST!"
			}
		}
	}

	SOV_reinstate_mig_design_bureau = {
		priority = 285

		icon = generic_air

		ai_will_do = {
			base = 2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = {
				flag = SOV_mig_design_bureau_dissolved_flag
				days > 365
			}
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			has_country_flag = SOV_mig_design_bureau_dissolved_flag
		}

		days_remove = SOV_reinstate_aircraft_designer_days

		days_re_enable = 1

		cost = 0

		modifier = {
			political_power_gain = -0.25
			civilian_factory_use = 2
		}

		remove_effect = {
			clr_country_flag = SOV_mig_design_bureau_dissolved_flag
		}
	}

	SOV_reinstate_ilyushin_design_bureau = {
		priority = 284

		icon = generic_air

		ai_will_do = {
			base = 2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = {
				flag = SOV_ilyushin_design_bureau_dissolved_flag
				days > 365
			}
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			has_country_flag = SOV_ilyushin_design_bureau_dissolved_flag
		}

		days_remove = SOV_reinstate_aircraft_designer_days

		days_re_enable = 1

		cost = 0

		modifier = {
			political_power_gain = -0.25
			civilian_factory_use = 2
		}

		remove_effect = {
			clr_country_flag = SOV_ilyushin_design_bureau_dissolved_flag
		}
	}

	SOV_reinstate_tupolev_design_bureau = {
		priority = 283

		icon = generic_air

		ai_will_do = {
			base = 2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = {
				flag = SOV_tupolev_design_bureau_dissolved_flag
				days > 365
			}
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			has_country_flag = SOV_tupolev_design_bureau_dissolved_flag
		}

		days_remove = SOV_reinstate_aircraft_designer_days

		days_re_enable = 1

		cost = 0

		modifier = {
			political_power_gain = -0.25
			civilian_factory_use = 2
		}

		remove_effect = {
			clr_country_flag = SOV_tupolev_design_bureau_dissolved_flag
		}
	}

	SOV_reinstate_yakovlev_design_bureau = {
		priority = 282

		icon = generic_air

		ai_will_do = {
			base = 2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = {
				flag = SOV_yakovlev_design_bureau_dissolved_flag
				days > 365
			}
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			has_country_flag = SOV_yakovlev_design_bureau_dissolved_flag
		}

		days_remove = SOV_reinstate_aircraft_designer_days

		days_re_enable = 1

		cost = 0

		modifier = {
			political_power_gain = -0.25
			civilian_factory_use = 2
		}

		remove_effect = {
			clr_country_flag = SOV_yakovlev_design_bureau_dissolved_flag
		}
	}

	

	SOV_DEBUG_ACTIVATE_PARANOIA = { #TODO_Manu: Comment out
		priority = 281

		icon = eng_ally_imperialist_coup

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			NOT = { has_country_flag = SOV_paranoia_system_active_flag }
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			custom_effect_tooltip = "THIS ACTIVATES THE PARANOIA SYSTEM"
			SOV_initiate_paranoia_effect = yes
		}
	}

	SOV_DEBUG_DEACTIVATE_PARANOIA = { #TODO_Manu: Comment out
		priority = 281

		icon = eng_ally_imperialist_coup

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			custom_effect_tooltip = "THIS REMOVES THE PARANOIA SYSTEM"
			SOV_remove_paranoia_effect = yes
		}
	}
	
	SOV_DEBUG_show_debug_purge_decisions = { #TODO_Manu: Comment out
		priority = 281

		icon = eng_ally_imperialist_coup

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			NOT = { has_country_flag = SOV_TEST_show_debug_purge_decisions_flag }
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_TEST_show_debug_purge_decisions_flag
			#SOV_initiate_paranoia_effect = yes
		}
	}

	SOV_DEBUG_hide_debug_purge_decisions = { #TODO_Manu: Comment out
		priority = 201

		icon = eng_ally_imperialist_coup

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			clr_country_flag = SOV_TEST_show_debug_purge_decisions_flag
			#SOV_remove_paranoia_effect = yes
		}
	}

	SOV_DEBUG_MAKE_PURGE_DECISIONS_FASTER_HERE = {
		priority = 151

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			NOT = {
				has_country_flag = SOV_debug_fast_purge_decisions_flag
			}
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_debug_fast_purge_decisions_flag
			set_variable = { SOV_reinforce_officer_ranks_days = 3 }
			set_variable = { SOV_reinstate_aircraft_designer_days = 3 }
		}
	}

	SOV_DEBUG_REGULAR_PURGE_DECISIONS_DURATION_HERE = {
		priority = 150

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			has_country_flag = SOV_debug_fast_purge_decisions_flag
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			clr_country_flag = SOV_debug_fast_purge_decisions_flag
			set_variable = { SOV_reinforce_officer_ranks_days = 365 }
			set_variable = { SOV_reinstate_aircraft_designer_days = 180 }
		}
	}

	SOV_DEBUG_trigger_great_purge_trial_of_the_generals_dec = {
		priority = 99

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_great_purge_army_trial_of_the_generals_effect = yes
		}
	}

	SOV_DEBUG_trigger_great_purge_army_junior_officers_dec = {
		priority = 98

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_great_purge_army_junior_officers_effect = yes
		}
	}

	SOV_DEBUG_trigger_random_army_great_purge_dec = {
		priority = 97

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_pick_great_purge_army_type_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_general_accused_dec = {
		priority = 96

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_regular_purge_general_accused_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_conspiracy_in_the_academy_dec = {
		priority = 95

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_regular_purge_conspiracy_in_the_academy_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_anti_saboteur_campaign_dec = {
		priority = 94

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_regular_purge_anti_saboteur_campaign_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_general_accuses_general_dec = {
		priority = 93

		icon = generic_prepare_civil_war

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_regular_purge_general_accuses_general_effect = yes
		}
	}

	SOV_DEBUG_trigger_great_purge_moscow_trial_dec = {
		priority = 89

		icon = eng_trade_unions_support

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_great_purge_moscow_trial_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_advisor_accused_dec = {
		priority = 83

		icon = eng_trade_unions_support

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_advisor_accused_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_civil_servants_dec = {
		priority = 82

		icon = eng_trade_unions_support

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_civil_servants_purged_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_nkvd_dec = {
		priority = 81

		icon = eng_trade_unions_support

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_nkvd_effect = yes
		}
	}


	
	SOV_DEBUG_trigger_great_purge_trial_of_the_admirals_dec = {
		priority = 79

		icon = generic_naval

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_great_purge_trial_of_the_admirals_effect = yes
		}
	}

	SOV_DEBUG_trigger_great_purge_junior_naval_officers_effect = {
		priority = 78

		icon = generic_naval

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_great_purge_junior_naval_officers_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_admiral_accused_dec = {
		priority = 73

		icon = generic_naval

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_admiral_accused_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_naval_conspiracy_in_the_academys_dec = {
		priority = 72

		icon = generic_naval

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_naval_conspiracy_in_the_academy_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_naval_anti_saboteur_campaign_dec = {
		priority = 71

		icon = generic_naval

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_naval_anti_saboteur_campaign_effect = yes
		}
	}

	


	SOV_DEBUG_trigger_great_purge_airforce_chiefs_dec = {
		priority = 69

		icon = generic_air

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_great_purge_airforce_chiefs_effect = yes
		}
	}

	SOV_DEBUG_trigger_great_purge_airforce_design_bureau_dissolved_dec = {
		priority = 68

		icon = generic_air

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_great_purge_design_bureau_dissolved_effect = yes
		}
	}
	
	SOV_DEBUG_trigger_regular_purge_airforce_conspiracy_in_the_academys_dec = {
		priority = 62

		icon = generic_air

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_airforce_conspiracy_in_the_academy_effect = yes
		}
	}

	SOV_DEBUG_trigger_regular_purge_airforce_anti_saboteur_campaign_dec = {
		priority = 61

		icon = generic_air

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_trigger_regular_purge_airforce_anti_saboteur_campaign_effect = yes
		}
	}

	

	SOV_DEBUG_low_paranoia_increase_dec = {
		priority = 6

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_low_increase_effect = yes
		}
	}

	SOV_DEBUG_medium_paranoia_increase_dec = {
		priority = 5

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_medium_increase_effect = yes
		}
	}

	SOV_DEBUG_high_paranoia_increase_dec = {
		priority = 4

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_high_increase_effect = yes
		}
	}

	SOV_DEBUG_low_paranoia_decrease_dec = {
		priority = 3

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_low_decrease_effect = yes
		}
	}

	SOV_DEBUG_medium_paranoia_decrease_dec = {
		priority = 2

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_medium_decrease_effect = yes
		}
	}

	SOV_DEBUG_high_paranoia_decrease_dec = {
		priority = 1

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_paranoia_system_active_flag
		}

		visible = {
			has_country_flag = SOV_paranoia_system_active_flag
			has_country_flag = SOV_TEST_show_debug_purge_decisions_flag
		}

		cost = 0

		complete_effect = {
			SOV_paranoia_high_decrease_effect = yes
		}
	}

	SOV_DEBUG_show_all_purged_portraits = {
		priority = 1

		icon = eng_ally_imperialist_coup

		ai_will_do = {
			base = 0
		}

		allowed = { 
			always = yes
		}

		available = {
			always = yes
		}

		visible = {
			is_debug = yes
		}

		days_re_enable = 1

		cost = 0

		complete_effect = {
			#Custom
			set_variable = { SOV.SOV_paranoia_photo_zinovyev = 8 }
			set_variable = { SOV.SOV_paranoia_photo_radek = 9 }
			set_variable = { SOV.SOV_paranoia_photo_bukharin = 10 }
			set_variable = { SOV.SOV_paranoia_photo_trotsky = 11 }
			set_variable = { SOV.SOV_paranoia_photo_tukhachevsky = 12 }
			
			#Generic
			set_variable = { SOV_paranoia_portrait_index = 1 }
			set_temp_variable = { i = 0 }
			while_loop_effect = {
				limit = {
					check_variable = { i = 12 compare = less_than }
				}
				set_temp_variable = { SOV_generic_portrait_frame = SOV_paranoia_portrait_index }
				if = { #There are 6 portraits and 12 slots, so second round of generic portraits
					limit = {
						check_variable = { SOV_paranoia_portrait_index = 6 compare = greater_than }
					}
					subtract_from_temp_variable = { SOV_generic_portrait_frame = 6 }
				}
				add_to_temp_variable = { SOV_generic_portrait_frame = 1 }
				log = "Final FRAME is [?SOV_generic_portrait_frame]"

				add_to_array = {
					array = SOV_paranoia_generic_portraits_array
					value = SOV_generic_portrait_frame
					index = SOV_paranoia_portrait_index
				}
				
				add_to_variable = { SOV_paranoia_portrait_index = 1 }
				add_to_temp_variable = { i = 1 }
				log = "New index is [?SOV_paranoia_portrait_index]"
			}
		}
	}
}



########  ########   #######  ########     ###     ######      ###    ##    ## ########     ###        ######     ###    ##     ## ########     ###    ####  ######   ##    ## 
##     ## ##     ## ##     ## ##     ##   ## ##   ##    ##    ## ##   ###   ## ##     ##   ## ##      ##    ##   ## ##   ###   ### ##     ##   ## ##    ##  ##    ##  ###   ## 
##     ## ##     ## ##     ## ##     ##  ##   ##  ##         ##   ##  ####  ## ##     ##  ##   ##     ##        ##   ##  #### #### ##     ##  ##   ##   ##  ##        ####  ## 
########  ########  ##     ## ########  ##     ## ##   #### ##     ## ## ## ## ##     ## ##     ##    ##       ##     ## ## ### ## ########  ##     ##  ##  ##   #### ## ## ## 
##        ##   ##   ##     ## ##        ######### ##    ##  ######### ##  #### ##     ## #########    ##       ######### ##     ## ##        #########  ##  ##    ##  ##  #### 
##        ##    ##  ##     ## ##        ##     ## ##    ##  ##     ## ##   ### ##     ## ##     ##    ##    ## ##     ## ##     ## ##        ##     ##  ##  ##    ##  ##   ### 
##        ##     ##  #######  ##        ##     ##  ######   ##     ## ##    ## ########  ##     ##     ######  ##     ## ##     ## ##        ##     ## ####  ######   ##    ## 


SOV_propaganda_campaigns = {	
	SOV_debug_unlock_slot = {
		priority = 59

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			OR = {
				check_variable = { SOV_poster_left_icon_frame = SOV_propaganda_locked_slot_index }
				check_variable = { SOV_poster_center_icon_frame = SOV_propaganda_locked_slot_index }
				check_variable = { SOV_poster_right_icon_frame = SOV_propaganda_locked_slot_index }
			}
		}

		visible = {
			OR = {
				check_variable = { SOV_poster_left_icon_frame = SOV_propaganda_locked_slot_index }
				check_variable = { SOV_poster_center_icon_frame = SOV_propaganda_locked_slot_index }
				check_variable = { SOV_poster_right_icon_frame = SOV_propaganda_locked_slot_index }
			}
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			SOV_unlock_propaganda_campaign_slot_effect = yes
		}
	}

	SOV_debug_MAKE_CAMPAIGNS_FASTER_HERE = {
		priority = 51

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			NOT = {
				has_country_flag = SOV_debug_fast_propaganda_campaigns_flag
			}
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_debug_fast_propaganda_campaigns_flag
			set_variable = { SOV_default_propaganda_campaign_duration = 5 }
			set_variable = { SOV_default_propaganda_campaign_cooldown = 1 }
			set_variable = { SOV_default_propaganda_campaign_old_days = 2 }
		}
	}

	SOV_debug_REGULAR_CAMPAIGN_DURATION_HERE = {
		priority = 51

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			has_country_flag = SOV_debug_fast_propaganda_campaigns_flag
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			clr_country_flag = SOV_debug_fast_propaganda_campaigns_flag
			set_variable = { SOV_default_propaganda_campaign_duration = 180 }
			set_variable = { SOV_default_propaganda_campaign_cooldown = 90 }
			set_variable = { SOV_default_propaganda_campaign_old_days = 150 }
		}
	}

	SOV_debug_UNLOCK_ALL_CAMPAIGNS = {
		priority = 50

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			NOT = {
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag
			}
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_debug_unlock_propaganda_campaigns_flag
		}
	}

	SOV_propaganda_motherland_calls = { # ID = 3
		priority = 2

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0
			modifier = {
				add = 1
				surrender_progress > 0.4
			}
			modifier = {
				add = 10
				has_manpower < 500000
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_motherland_calls_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_motherland_calls_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_motherland_calls_cost > 90 } #Shouldn't even consider doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			has_idea = order_227
			any_enemy_country = {
				is_major = yes
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_motherland_calls_cost

		modifier = {
			weekly_manpower = 10000
			training_time_factor = -0.5
			minimum_training_level = -0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 3 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 3 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			# Okay this looks dumb I know but it's better than having to change 24 operations each time we feel like tweaking how propaganda campaign's cost escalates
			set_variable = { SOV_propaganda_cost = SOV_propaganda_motherland_calls_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_motherland_calls_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_victory_at_hand = { # ID = 4
		priority = 3

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_victory_at_hand_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_victory_at_hand_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_victory_at_hand_cost > 90 } #Shouldn't even consider doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			has_idea = order_227
			surrender_progress < 0.01
			any_enemy_country = {
				is_major = yes
				ROOT = {
					any_controlled_state = {
						is_core_of = PREV.PREV
					}
				}
			}
			SOV_propaganda_victory_at_hand_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_victory_at_hand_cost

		modifier = {
			army_attack_factor = 0.05
			org_loss_when_moving = -0.05
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 4 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 4 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_victory_at_hand_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_victory_at_hand_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_defend_moscow = { # ID = 5
		priority = 4

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 500
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_defend_moscow_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_defend_moscow_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_defend_moscow_cost > 90 } #Shouldn't even consider doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			controls_state = 219 #Moscow
			219 = {
				any_neighbor_state = {
					controller = {
						has_war_with = ROOT
					}
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_defend_moscow_cost

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 5 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes

			219 = { #Moscow
				add_dynamic_modifier = { modifier = SOV_defend_moscow scope = SOV }
				every_neighbor_state = {
					add_dynamic_modifier = { modifier = SOV_defend_moscow scope = SOV }
				}
			}
			custom_effect_tooltip = SOV_propaganda_defend_moscow_state_modifier_tt
		}

		remove_effect = {
			219 = { #Moscow
				remove_dynamic_modifier = { modifier = SOV_defend_moscow }
				every_neighbor_state = {
					remove_dynamic_modifier = { modifier = SOV_defend_moscow }
				}
			}

			set_variable = { SOV_propaganda_campaign_to_remove = 5 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_defend_moscow_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_defend_moscow_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_fight_to_the_last = { # ID = 6
		priority = 5

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0.75
			modifier = {
				factor = 10
				OR = {
					AND = {
						stockpile_ratio = {
							archetype = train_equipment
							ratio < 0.75
						}
						stockpile_ratio = {
							archetype = motorized_equipment
							ratio < 0.75
						}
					}
					stockpile_ratio = {
						archetype = convoy
						ratio < 5
					}
				}
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_fight_to_the_last_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_fight_to_the_last_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_fight_to_the_last_cost > 90 } #Shouldn't even consider doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
			has_war = yes
			surrender_progress > 0.01
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown


		cost = SOV_propaganda_fight_to_the_last_cost

		modifier = {
			army_org_factor = 0.05
			out_of_supply_factor = -0.25
			no_supply_grace = 70
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 6 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 6 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_fight_to_the_last_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_fight_to_the_last_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_hit_of_hammer = { # ID = 7
		priority = 6

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 10
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_hit_of_hammer_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_hit_of_hammer_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_hit_of_hammer_cost > 90 } #Shouldn't even consider doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
			has_war_with = GER
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_hit_of_hammer_cost

		modifier = {
			industrial_capacity_factory = 0.25
			industrial_capacity_dockyard = 0.25
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 7 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 7 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_hit_of_hammer_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_hit_of_hammer_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_transport = { # ID = 8
		priority = 7

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0.7
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_transport_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_transport_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_transport_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_transport_cost

		modifier = {
			production_speed_supply_node_factor = 0.15
			production_speed_rail_way_factor = 0.15
			supply_consumption_factor = -0.05
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 8 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 8 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_transport_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_transport_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_oil_for_the_motherland = { # ID = 9
		priority = 8

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 10
				fuel_ratio < 0.5
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_oil_for_the_motherland_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_oil_for_the_motherland_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_oil_for_the_motherland_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			any_controlled_state = {
				has_resources_amount = {
					resource = oil
					amount > 0
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_oil_for_the_motherland_cost

		modifier = {
			fuel_gain_factor = 0.15
			army_fuel_consumption_factor = -0.15
			air_fuel_consumption_factor = -0.15
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 9 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 9 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_oil_for_the_motherland_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_oil_for_the_motherland_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_more_metal = { # ID = 10
		priority = 9

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0.8
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_more_metal_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_more_metal_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_more_metal_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			any_controlled_state = {
				OR = {
					has_resources_amount = {
						resource = iron
						amount > 0
					}
					has_resources_amount = {
						resource = bauxite
						amount > 0
					}
					has_resources_amount = {
						resource = chromium
						amount > 0
					}
					has_resources_amount = {
						resource = tungsten
						amount > 0
					}
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_more_metal_cost

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 10 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			hidden_effect = {
				capital_scope = {
					set_variable = { SOV_iron_bonus = 0 }
					set_variable = { SOV_aluminium_bonus = 0 }
					set_variable = { SOV_chromium_bonus = 0 }
					set_variable = { SOV_tungsten_bonus = 0 }
				}
				every_controlled_state = {
					limit = {
						has_resources_amount = {
							resource = iron
							amount > 0
						}
					}
					capital_scope = { add_to_variable = { SOV_iron_bonus = 1 } }
				}

				every_controlled_state = {
					limit = {
						has_resources_amount = {
							resource = bauxite
							amount > 0
						}
					}
					capital_scope = { add_to_variable = { SOV_bauxite_bonus = 1 } }
				}

				every_controlled_state = {
					limit = {
						has_resources_amount = {
							resource = chromium
							amount > 0
						}
					}
					capital_scope = { add_to_variable = { SOV_chromium_bonus = 1 } }
				}

				every_controlled_state = {
					limit = {
						has_resources_amount = {
							resource = tungsten
							amount > 0
						}
					}
					capital_scope = { add_to_variable = { SOV_tungsten_bonus = 1 } }
				}
			}

			capital_scope = {
				add_dynamic_modifier = { modifier = SOV_increased_metals_production }
			}

			custom_effect_tooltip = SOV_propaganda_more_metal_tt
		}

		remove_effect = {
			capital_scope = {
				remove_dynamic_modifier = { modifier = SOV_increased_metals_production }
			}

			set_variable = { SOV_propaganda_campaign_to_remove = 10 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_more_metal_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_more_metal_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_high_yield = { # ID = 11
		priority = 10

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 10
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_high_yield_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_high_yield_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_high_yield_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

		}

		visible = {
			OR = {
				has_completed_focus = SOV_expand_the_agitprop
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_high_yield_cost

		modifier = {
			consumer_goods_factor = -0.02
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 11 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 11 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_high_yield_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_high_yield_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_for_the_motherland = { # ID = 12
		priority = 11

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 10
				has_manpower < 300000
			}
			modifier = {
				factor = 2
				OR = {
					command_power < 25
					has_army_experience < 25
				}
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_for_the_motherland_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_for_the_motherland_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_for_the_motherland_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			any_enemy_country = {
				is_major = yes
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_collectivist_propaganda
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_for_the_motherland_cost

		modifier = {
			experience_gain_army_factor = 0.15
			command_power_gain_mult = 0.15
			breakthrough_factor = 0.15
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 12 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 12 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_for_the_motherland_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_for_the_motherland_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_heroes_forward = { # ID = 13
		priority = 12

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 10
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_heroes_forward_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_heroes_forward_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_heroes_forward_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			any_unit_leader = {
				is_assigned = yes
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_positive_heroism
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_heroes_forward_cost

		modifier = {
			army_morale_factor = 0.15
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 13 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes

			custom_effect_tooltip = SOV_propaganda_heroes_forward_tt
			
			set_temp_variable = { temp_targets_index = 0 }
			while_loop_effect = {
				limit = {
					check_variable = { temp_targets_index = 5 compare = less_than }
				}
				if = {
					limit = {
						any_unit_leader = {
							is_assigned = yes
							NOT = { has_trait = trait_SOV_determined }
						}
					}
					random_unit_leader = {
						limit = {
							is_assigned = yes
							NOT = { has_trait = trait_SOV_determined }
						}
						add_timed_unit_leader_trait = {
							trait = trait_SOV_determined
							days = @DAYS_DETERMINED #Does not seem to support vars
						}
					}
				}
				else = {
					random_unit_leader = {
						limit = {
							NOT = { has_trait = trait_SOV_determined }
						}
						add_timed_unit_leader_trait = {
							trait = trait_SOV_determined
							days = @DAYS_DETERMINED #Does not seem to support vars
						}
					}
				}
				add_to_temp_variable = { temp_targets_index = 1 }
			}
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 13 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_heroes_forward_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_heroes_forward_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_anti_capitalism = { # ID = 14
		priority = 13

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				any_enemy_country = {
					is_major = yes
					has_government = democratic
				}
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_anti_capitalism_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_anti_capitalism_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_anti_capitalism_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			any_country = {
				has_government = democratic
				OR = {
					tag = ENG
					tag = FRA
					tag = GER
					tag = ITA
					tag = USA
					tag = JAP
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_anti_capitalist_policies
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_anti_capitalism_cost

		modifier = {
			opinion_gain_monthly_same_ideology_factor = 0.25
			democratic_acceptance = -100
			democratic_drift = -0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 14 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			custom_effect_tooltip = SOV_propaganda_anti_capitalism_tt
			set_variable = { SOV_anti_capitalist_target = 0 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			#Choose the "most powerful" capitalist country based on num of factories
			if = {
				limit = {
					ENG = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = ENG.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 1 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					FRA = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = FRA.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 2 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					GER = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = GER.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 3 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					ITA = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = ITA.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 4 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					USA = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = USA.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 5 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					JAP = { has_government = democratic }
				}
				set_temp_variable = { SOV_max_factories = JAP.num_of_factories }
				set_variable = { SOV_anti_capitalist_target = 6 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}

			if = {
				limit = {
					FRA = { has_government = democratic }
				}
				set_temp_variable = { SOV_compare_factories = FRA.num_of_factories }
				if = { #FIRST Vs FRA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = FRA.num_of_factories }
					set_variable = { SOV_anti_capitalist_target = 2 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					GER = { has_government = democratic }
				}
				set_temp_variable = { SOV_compare_factories = GER.num_of_factories }
				if = { #WINNER Vs GER
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = GER.num_of_factories }
					set_variable = { SOV_anti_capitalist_target = 3 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					ITA = { has_government = democratic }
				}
				set_temp_variable = { SOV_compare_factories = ITA.num_of_factories }
				if = { #WINNER Vs ITA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = ITA.num_of_factories }
					set_variable = { SOV_anti_capitalist_target = 4 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					USA = { has_government = democratic }
				}
				set_temp_variable = { SOV_compare_factories = USA.num_of_factories }
				if = { #WINNER Vs USA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = USA.num_of_factories }
					set_variable = { SOV_anti_capitalist_target = 5 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					JAP = { has_government = democratic }
				}
				set_temp_variable = { SOV_compare_factories = JAP.num_of_factories }
				if = { #WINNER Vs JAP
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = JAP.num_of_factories }
					set_variable = { SOV_anti_capitalist_target = 6 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 1 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_eng
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 2 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_fra
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 3 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_ger
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 4 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_ita
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 5 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_usa
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_capitalist_target = 6 }
				}
				add_timed_idea = {
					idea = SOV_anti_capitalist_campaign_jap
					days = SOV_default_propaganda_campaign_duration
				}
			}
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 14 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_anti_capitalism_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_anti_capitalism_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_anti_fascism = { # ID = 15
		priority = 14

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				any_enemy_country = {
					is_major = yes
					has_government = democratic
				}
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_anti_fascism_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_anti_fascism_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_anti_fascism_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			any_country = {
				has_government = fascism
				OR = {
					tag = ENG
					tag = FRA
					tag = GER
					tag = ITA
					tag = USA
					tag = JAP
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_anti_fascist_policies
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_anti_fascism_cost

		modifier = {
			opinion_gain_monthly_same_ideology_factor = 0.25
			fascism_acceptance = -100
			fascism_drift = -0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 15 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			custom_effect_tooltip = SOV_propaganda_anti_fascism_tt
			set_variable = { SOV_anti_fascist_target = 0 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			#Choose the "most powerful" fascist country based on num of factories
			if = {
				limit = {
					ENG = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = ENG.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 1 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					FRA = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = FRA.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 2 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					GER = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = GER.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 3 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					ITA = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = ITA.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 4 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					USA = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = USA.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 5 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}
			else_if = {
				limit = {
					JAP = { has_government = fascism }
				}
				set_temp_variable = { SOV_max_factories = JAP.num_of_factories }
				set_variable = { SOV_anti_fascist_target = 6 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
			}

			if = {
				limit = {
					FRA = { has_government = fascism }
				}
				set_temp_variable = { SOV_compare_factories = FRA.num_of_factories }
				if = { #FIRST Vs FRA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = FRA.num_of_factories }
					set_variable = { SOV_anti_fascist_target = 2 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					GER = { has_government = fascism }
				}
				set_temp_variable = { SOV_compare_factories = GER.num_of_factories }
				if = { #WINNER Vs GER
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = GER.num_of_factories }
					set_variable = { SOV_anti_fascist_target = 3 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					ITA = { has_government = fascism }
				}
				set_temp_variable = { SOV_compare_factories = ITA.num_of_factories }
				if = { #WINNER Vs ITA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = ITA.num_of_factories }
					set_variable = { SOV_anti_fascist_target = 4 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					USA = { has_government = fascism }
				}
				set_temp_variable = { SOV_compare_factories = USA.num_of_factories }
				if = { #WINNER Vs USA
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = USA.num_of_factories }
					set_variable = { SOV_anti_fascist_target = 5 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					JAP = { has_government = fascism }
				}
				set_temp_variable = { SOV_compare_factories = JAP.num_of_factories }
				if = { #WINNER Vs JAP
					limit = {
						check_variable = { SOV_max_factories < SOV_compare_factories }
					}
					set_temp_variable = { SOV_max_factories = JAP.num_of_factories }
					set_variable = { SOV_anti_fascist_target = 6 } #1=ENG / 2=FRA / 3=GER / 4=ITA / 5=USA / 6=JAP
				}
			}

			if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 1 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_eng
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 2 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_fra
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 3 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_ger
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 4 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_ita
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 5 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_usa
					days = SOV_default_propaganda_campaign_duration
				}
			}
			else_if = {
				limit = {
					check_variable = { SOV_anti_fascist_target = 6 }
				}
				add_timed_idea = {
					idea = SOV_anti_fascist_campaign_jap
					days = SOV_default_propaganda_campaign_duration
				}
			}
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 15 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_anti_fascism_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_anti_fascism_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_treacherous_enemy = { # ID = 16
		priority = 15

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				agency_upgrade_number > 4
			}
			modifier = {
				factor = 0
				has_intelligence_agency = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_treacherous_enemy_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_treacherous_enemy_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_treacherous_enemy_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_smersh
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_treacherous_enemy_cost

		modifier = {
			encryption = 1
			enemy_operative_detection_chance_factor = 0.25
			enemy_operative_capture_chance_factor = 0.25
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 16 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 16 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_treacherous_enemy_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_treacherous_enemy_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_do_not_blab = { # ID = 17
		priority = 16

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				has_war = yes
			}
			modifier = {
				factor = 5
				any_enemy_country = {
					is_major = yes
				}
			}
			modifier = {
				factor = 0
				has_intelligence_agency = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_do_not_blab_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_do_not_blab_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_do_not_blab_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_smersh
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_do_not_blab_cost

		modifier = {
			army_intel_to_others = -50
			navy_intel_to_others = -50
			airforce_intel_to_others = -50
			civilian_intel_to_others = -50
			foreign_subversive_activites = -0.25
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 17 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 17 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_do_not_blab_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_do_not_blab_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_sweep_scum_out = { # ID = 18
		priority = 17

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0.5
			modifier = {
				add = 100
				has_country_flag = { flag = SOV_great_patriotic_war_flag days > 365 }
			}
			modifier = {
				factor = 0.1
				surrender_progress > 0.75
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_sweep_scum_out_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_sweep_scum_out_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_sweep_scum_out_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			any_enemy_country = {
				any_controlled_state = {
					is_core_of = ROOT
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_the_komsomol
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_sweep_scum_out_cost

		modifier = {
			army_core_attack_factor = 0.1
			army_core_defence_factor = 0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 18 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 18 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_sweep_scum_out_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_sweep_scum_out_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_knowledge = { # ID = 19
		priority = 18

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 5
			modifier = {
				factor = 10
				has_war = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_knowledge_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_knowledge_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_knowledge_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_the_komsomol
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_knowledge_cost

		modifier = {
			research_speed_factor = 0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 19 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 19 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_knowledge_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_knowledge_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_builders_of_communism = { # ID = 20
		priority = 19

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 2
			modifier = {
				factor = 10
				has_war = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_builders_of_communism_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_builders_of_communism_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_builders_of_communism_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_the_komsomol
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_builders_of_communism_cost

		modifier = {
			research_speed_factor = 0.05
			communism_drift = 0.1
			opinion_gain_monthly_same_ideology_factor = 0.25
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 20 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			custom_effect_tooltip = SOV_propaganda_builders_of_communism_effect_tt
			if = {
				limit = {
					any_country = {
						is_subject_of = ROOT
					}
				}
				hidden_effect = {
					every_country = {
						limit = {
							is_subject_of = ROOT
						}
						country_event = NSB_soviet_propaganda_capmaign_events.1
					}
				}
			}
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 20 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_builders_of_communism_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_builders_of_communism_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_glory_to_partisans = { # ID = 21
		priority = 20

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 10
				agency_upgrade_number > 4
				
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_glory_to_partisans_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_glory_to_partisans_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_glory_to_partisans_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			any_enemy_country = {
				NOT = { original_tag = SOV }
				any_controlled_state = {
					is_core_of = ROOT
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_organization_of_the_partisans
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_glory_to_partisans_cost

		modifier = {
			operation_targeted_sabotage_resources_outcome = 0.25
			operation_targeted_sabotage_infrastructure_outcome = 0.25
			operation_targeted_sabotage_industry_outcome = 0.25
			operation_make_resistance_contacts_outcome = 0.25
			operation_boost_resistance_outcome = 0.25
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 21 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			random_list = {
				50 = { load_oob = "SOV_partisan_1" }
				50 = { load_oob = "SOV_partisan_2" }
			}
			GER = { country_event = { id = ger_armor.405 hours = 4 }}
		}
		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 21 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_glory_to_partisans_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_glory_to_partisans_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_death_to_invaders = { # ID = 22
		priority = 21

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1
			modifier = {
				factor = 5
				
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_death_to_invaders_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_death_to_invaders_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_death_to_invaders_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = yes
			any_enemy_country = {
				NOT = { original_tag = SOV }
				any_controlled_state = {
					is_core_of = ROOT
				}
			}
		}

		visible = {
			OR = {
				has_completed_focus = SOV_organization_of_the_partisans
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_death_to_invaders_cost

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 22 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			set_global_flag = SOV_propaganda_death_to_invaders_active_flag #This is used to dynamically add/remove the state modifier when a state is gained/lost by SOV

			if = {
				limit = {
					any_enemy_country = {
						any_controlled_state = {
							is_core_of = ROOT
						}
					}
				}
				every_enemy_country = {
					limit = {
						any_controlled_state = {
							is_core_of = ROOT
						}
					}
					every_controlled_state = {
						limit = {
							is_core_of = ROOT
						}
						add_dynamic_modifier = { modifier = SOV_invaders_must_die }
					}
				}
			}
			else = {
				custom_effect_tooltip = SOV_propaganda_death_to_invaders_no_invaders_tt
			}
			custom_effect_tooltip = SOV_propaganda_death_to_invaders_state_modifier_tt
		}

		remove_effect = {
			every_state = {
				limit = {
					has_dynamic_modifier = { modifier = SOV_invaders_must_die }
				}
				remove_dynamic_modifier = { modifier = SOV_invaders_must_die }
			}

			clr_global_flag = SOV_propaganda_death_to_invaders_active_flag

			set_variable = { SOV_propaganda_campaign_to_remove = 22 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_death_to_invaders_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_death_to_invaders_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_stalin = { # ID = 23
		priority = 22

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 5
			modifier = {
				factor = 2
				has_war = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_stalin_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_stalin_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_stalin_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_stalins_cult_of_personality
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_stalin_cost

		modifier = {
			political_power_factor = 0.1
			command_power_gain_mult = 0.1
			war_support_weekly = 0.01
			communism_drift = 0.1
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 23 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 23 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_stalin_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_stalin_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_rebuild_to_glory = { # ID = 24
		priority = 23

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 3
			modifier = {
				factor = 2
				has_war = no
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_rebuild_to_glory_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_rebuild_to_glory_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_rebuild_to_glory_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_restoration_and_development
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_rebuild_to_glory_cost

		modifier = {
			industry_repair_factor = 0.15
			production_speed_buildings_factor = 0.05
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 24 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 24 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_rebuild_to_glory_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_rebuild_to_glory_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_peace = { # ID = 25
		priority = 24

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 2
			modifier = {
				factor = 0
				any_country = {
					SOV = { is_justifying_wargoal_against = PREV }
				}
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_peace_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_peace_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_peace_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			has_war = no
			NOT = { has_country_flag = SOV_punished_for_breaking_flag }
		}

		visible = {
			OR = {
				has_completed_focus = SOV_restoration_and_development
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
			NOT = { has_country_flag = SOV_punished_for_breaking_flag }
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_peace_cost

		modifier = {
			stability_weekly = 0.005
			consumer_goods_factor = -0.03
			opinion_gain_monthly_factor = 0.25
			enemy_justify_war_goal_time = 0.50
			war_support_weekly = -0.005
			industrial_capacity_factory = -0.05
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 25 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
			set_rule = { can_send_volunteers = no }

			set_country_flag = SOV_propaganda_peace_active_flag
		}

		remove_effect = {
			set_rule = { can_send_volunteers = yes }

			clr_country_flag = SOV_propaganda_peace_active_flag

			set_variable = { SOV_propaganda_campaign_to_remove = 25 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_peace_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_peace_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}

	SOV_propaganda_happy_life = { # ID = 26
		priority = 25

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 3
			modifier = {
				factor = 2
				has_war = no
			}
			modifier = {
				factor = 10
				has_stability < 0.4
			}
			modifier = {
				factor = 10
				has_stability < 0.2
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_happy_life_cost > 30 } #Less likely to do it a third time
			}
			modifier = {
				factor = 0.1
				check_variable = { SOV_propaganda_happy_life_cost > 45 } #Even less likely to do it a fourth time
			}
			modifier = {
				factor = 0
				check_variable = { SOV_propaganda_happy_life_cost > 90 } #Shouldn't even considered doing it a fifth time
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SOV_propaganda_poster_slot_available = yes

			surrender_progress < 0.01
		}

		visible = {
			OR = {
				has_completed_focus = SOV_restoration_and_development
				has_country_flag = SOV_debug_unlock_propaganda_campaigns_flag #debug
			}
		}

		days_remove = SOV_default_propaganda_campaign_duration

		days_re_enable = SOV_default_propaganda_campaign_cooldown

		cost = SOV_propaganda_happy_life_cost

		modifier = {
			stability_weekly = 0.01
			compliance_growth = 0.05
			resistance_decay = 0.05
			resistance_damage_to_garrison = 0.15
			consumer_goods_factor = 0.03
		}

		complete_effect = {
			set_variable = { SOV_new_propaganda_campaign = 26 }
			SOV_pick_propaganda_campaign_slot_effect = yes
			SOV_achievement_propaganda_counter_effect = yes
		}

		remove_effect = {
			set_variable = { SOV_propaganda_campaign_to_remove = 26 }
			SOV_reset_propaganda_campaign_slot_effect = yes

			set_variable = { SOV_propaganda_cost = SOV_propaganda_happy_life_cost }
			SOV_increase_propaganda_campaign_cost_effect = yes
			set_variable = { SOV_propaganda_happy_life_cost = SOV_propaganda_cost }
			clear_variable = SOV_propaganda_cost

			custom_effect_tooltip = SOV_propaganda_campaign_cooldown_tt
		}
	}
}



########  #######  ########  ######## ####  ######   ##    ##    ########   #######  ##       #### ######## ####  ######   ######  
##       ##     ## ##     ## ##        ##  ##    ##  ###   ##    ##     ## ##     ## ##        ##     ##     ##  ##    ## ##    ## 
##       ##     ## ##     ## ##        ##  ##        ####  ##    ##     ## ##     ## ##        ##     ##     ##  ##       ##       
######   ##     ## ########  ######    ##  ##   #### ## ## ##    ########  ##     ## ##        ##     ##     ##  ##        ######  
##       ##     ## ##   ##   ##        ##  ##    ##  ##  ####    ##        ##     ## ##        ##     ##     ##  ##             ## 
##       ##     ## ##    ##  ##        ##  ##    ##  ##   ###    ##        ##     ## ##        ##     ##     ##  ##    ## ##    ## 
##        #######  ##     ## ######## ####  ######   ##    ##    ##         #######  ######## ####    ##    ####  ######   ######  


###############################
### COVERT SUPPORT FOR POUM ###
###############################

SOV_soviet_aid_to_poum_decision_category = {
	SOV_organize_covert_depots_poum = { #DECISION AVAILABLE PRIOR TO THE POUM SPLIT
		priority = 50

		icon = ger_military_buildup

		ai_will_do = {
			base = 30
			modifier = {
				factor = 0.01
				has_war = yes
				command_power < 50
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_global_flag = spanish_civil_war
		}

		visible = {
			NOT = { has_global_flag = SPR_anarchist_uprising_flag }
			NOT = { has_global_flag = scw_over }
			is_subject = no
		}

		cancel_if_not_visible = yes

		fire_only_once = yes

		days_remove = SOV_default_poum_days

		custom_cost_trigger = {
			command_power > 74
		}
		custom_cost_text = decision_cost_CP_75

		complete_effect = {
			hidden_effect = {
				add_command_power = -75
			}
		}

		remove_effect = {
			set_global_flag = SOV_poum_has_covert_depots_from_soviets_flag
			effect_tooltip = {
				custom_effect_tooltip = SOV_organize_covert_depots_poum_tt
				SPC = {
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = 6000
						producer = ROOT
					}
					add_equipment_to_stockpile = {
						type = support_equipment
						amount = 600
						producer = ROOT
					}
					add_equipment_to_stockpile = {
						type = artillery_equipment
						amount = 120
						producer = ROOT
					}
					add_equipment_to_stockpile = {
						type = motorized_equipment
						amount = 60
						producer = ROOT
					}
					add_equipment_to_stockpile = {
						type = train_equipment
						amount = 6
						producer = ROOT
					}
					add_opinion_modifier = {
						target = ROOT
						modifier = SOV_sent_us_weapons
					}
				}
			}
			custom_effect_tooltip = decision_only_once_tt
		}
	}

	SOV_send_infantry_equipment_poum = {
		priority = 50

		icon = generic_industry

		ai_will_do = {
			base = 1.2
			modifier = {
				factor = 0.1
				has_war = yes
				has_equipment = { infantry_equipment < 10000 }
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			SPR_scw_in_progress = yes
			country_exists = SPC
			SPC = { has_completed_focus = SPR_the_anti_fascist_workers_revolution }
			NOT = { has_war_with = SPC }
		}

		days_remove = SOV_default_poum_days

		days_re_enable = SOV_default_poum_cd

		custom_cost_trigger = {
			command_power > 24
		}
		custom_cost_text = decision_cost_CP_25			

		complete_effect = {
			hidden_effect = {
				add_command_power = -25
			}
		}

		remove_effect = {	
			effect_tooltip = {
				SPC = {
					add_equipment_to_stockpile = {
						type = infantry_equipment
						amount = 6000
						producer = FROM
					}
					add_opinion_modifier = {
						target = ROOT
						modifier = SOV_sent_us_weapons
					}
				}
			}
			hidden_effect = {
				SPC = {
					country_event = { id = NSB_soviet_foreign_politics_events.250 hours = 2 }
					add_ai_strategy = {
						type = befriend
						id = SOV		
						value = 5
					}
				}
			}
			custom_effect_tooltip = SOV_default_poum_cd_tt
		}
	}

	SOV_organize_popular_brigades_poum = {
		priority = 50

		icon = generic_nationalism

		ai_will_do = {
			base = 1.2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			SPR_scw_in_progress = yes
			country_exists = SPC
			SPC = { has_completed_focus = SPR_the_anti_fascist_workers_revolution }
			NOT = { has_war_with = SPC }
		}

		days_remove = SOV_default_poum_days

		days_re_enable = SOV_default_poum_cd

		custom_cost_trigger = {
			command_power > 24
			has_political_power > 24
		}
		custom_cost_text = decision_cost_CP_25_pp_25	

		complete_effect = {
			hidden_effect = {
				add_command_power = -25
				add_political_power = -25
			}
		}

		remove_effect = {
			effect_tooltip = {
				SPC ={
					division_template = {
						name = "International Marxist Brigades"
						is_locked = yes
						priority = 1
						template_counter = 14
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
						}
					}
					capital_scope = {
						create_unit = { 
							division = "name = \"International Marxist Brigade\" division_template = \"International Marxist Brigades\" start_experience_factor = 0.1 start_equipment_factor = 1.0" owner = SPC count = 6
						}
					}
				}
			}
			hidden_effect = {
				SPC = {
					country_event = { id = NSB_soviet_spanish_civil_war.2 hours = 1 }
					add_ai_strategy = {
						type = befriend
						id = SOV		
						value = 5
					}
				}
			}
			custom_effect_tooltip = SOV_default_poum_cd_tt
		}
	}

	SOV_send_elite_commandos_poum = {
		priority = 50

		icon = generic_military

		ai_will_do = {
			base = 1.2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			SPR_scw_in_progress = yes
			country_exists = SPC
			SPC = { has_completed_focus = SPR_the_anti_fascist_workers_revolution }
			NOT = { has_war_with = SPC }
		}

		days_remove = SOV_default_poum_days

		days_re_enable = SOV_long_poum_cd

		custom_cost_trigger = {
			command_power > 49
		}
		custom_cost_text = decision_cost_CP_50	

		complete_effect = {
			hidden_effect = {
				add_command_power = -50
			}
		}

		remove_effect = {
			effect_tooltip = {
				SPC ={
					add_timed_idea = {
						idea = SOV_soviet_commandos_poum
						days = 180
					}
					division_template = {
						name = "Soviet Special Brigades"
						is_locked = yes
						priority = 1
						template_counter = 02
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 0 y = 2 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
							infantry = { x = 1 y = 2 }
						}
						support = {
							engineer = { x = 0 y = 0 }
							recon = { x = 0 y = 1 }
							artillery = { x = 0 y = 2 }
							anti_tank = { x = 0 y = 3 }
						}
					}
					capital_scope = {
						create_unit = { 
							division = "name = \"Soviet Special Brigade\" division_template = \"Soviet Special Brigades\" start_experience_factor = 0.7 start_equipment_factor = 1.0" owner = SPC count = 2
						}
					}
				}
			}
			hidden_effect = {
				SPC = {
					country_event = { id = NSB_soviet_spanish_civil_war.3 hours = 1 }
					add_ai_strategy = {
						type = befriend
						id = SOV		
						value = 5
					}
				}
				if = {
					limit = {
						NOT = { has_country_flag = SOV_send_elite_commandos_poum_flag }
					}
					set_country_flag = SOV_send_elite_commandos_poum_flag
				}
			}
			custom_effect_tooltip = SOV_long_poum_cd_tt
		}
	}

	SOV_organize_popular_speeches_poum = {
		priority = 50

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1.2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
		}

		visible = {
			SPR_scw_in_progress = yes
			country_exists = SPC
			SPC = { has_completed_focus = SPR_the_anti_fascist_workers_revolution }
			NOT = { has_war_with = SPC }
		}

		days_remove = SOV_default_poum_days

		days_re_enable = SOV_default_poum_cd

		cost = 25

		remove_effect = {
			effect_tooltip = {
				SPC ={
					add_timed_idea = {
						idea = SOV_popular_speeches_poum
						days = 180
					}
					division_template = {
						name = "International Marxist Brigades"
						is_locked = yes
						priority = 1
						template_counter = 14
						regiments = {
							infantry = { x = 0 y = 0 }
							infantry = { x = 0 y = 1 }
							infantry = { x = 1 y = 0 }
							infantry = { x = 1 y = 1 }
						}
					}
					capital_scope = {
						create_unit = { 
							division = "name = \"International Marxist Brigade\" division_template = \"International Marxist Brigades\" start_experience_factor = 0.1 start_equipment_factor = 1.0" owner = SPC count = 2
						}
					}
				}
			}
			hidden_effect = {
				SPC = {
					country_event = { id = NSB_soviet_spanish_civil_war.4 hours = 1 }
					add_ai_strategy = {
						type = befriend
						id = SOV		
						value = 5
					}
				}
			}
			custom_effect_tooltip = SOV_default_poum_cd_tt
		}
	}

	SOV_infiltrate_stalinist_plans_in_spain_poum = {
		priority = 50

		icon = eng_propaganda_campaigns

		ai_will_do = {
			base = 1.2
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_completed_focus = SOV_send_military_advisors_to_spain
			NOT = { has_completed_focus = SOV_coup_detat }
			has_country_flag = SOV_send_elite_commandos_poum_flag
		}

		visible = {
			SPR_scw_in_progress = yes
			country_exists = SPC
			country_exists = SPD
			NOT = { has_completed_focus = SOV_coup_detat }
			SPC = { has_completed_focus = SPR_the_anti_fascist_workers_revolution }
			NOT = { has_war_with = SPC }
			NOT = { is_in_faction_with = SPD }
		}

		cancel_if_not_visible = yes

		days_remove = SOV_default_poum_days

		fire_only_once = yes

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 14
		}
		custom_cost_text = decision_cost_CP_50_pp_15

		remove_effect = {
			effect_tooltip = {
				SPC ={
					add_timed_idea = {
						idea = SOV_agents_in_the_stalinist_command_poum
						days = 365
					}
				}
			}
			hidden_effect = {
				SPC = {
					country_event = { id = NSB_soviet_spanish_civil_war.5 hours = 1 }
					add_ai_strategy = {
						type = befriend
						id = SOV		
						value = 5
					}
				}
			}
			custom_effect_tooltip = decision_only_once_tt
		}
	}
}


### MIDDLE EAST ###
###################

SOV_diplomacy_middle_east_decision_category = {
	

	SOV_preparations_for_operation_countenance = { # Mission for SOV (or SOV + ENG) to prepare the invasion of Iran
		priority = 50

		icon = hol_draw_up_staff_plans

		allowed = {
			OR = {
				original_tag = SOV
				original_tag = ENG
			}
		}

		available =  {
			hidden_trigger = { always = no }
		}

		activation = {
			always = no
		}

		cancel_trigger = {
			OR = {
				is_subject = yes
				NOT = { country_exists = PER }
				is_in_faction_with = PER
				has_war_with = PER
				has_guaranteed = PER
				has_non_aggression_pact_with = PER
				AND = {
					has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
					SOV = { has_war_with = ENG }
				}
			}
		}

		is_good = yes

		days_mission_timeout = SOV.SOV_operation_countenance_preparation_days

		timeout_effect = {
			if = { #SOV invading alone
				limit = {
					NOT = { has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag }
				}
				declare_war_on = {
					target = PER
					type = puppet_wargoal_focus
				}
			}
			else = { #SOV + ENG invading together
				if = { #SOV triggers the actual effects
					limit = {
						original_tag = SOV
					}
					declare_war_on = {
						target = PER
						type = puppet_wargoal_focus
					}
					ENG = {
						add_to_war = { targeted_alliance = SOV enemy = PER hostility_reason = asked_to_join }
					}
				}
				else = { #ENG only sees a fake
					effect_tooltip = {
						SOV = {
							declare_war_on = {
								target = PER
								type = puppet_wargoal_focus
							}
						}
						add_to_war = { targeted_alliance = SOV enemy = PER hostility_reason = asked_to_join }
					}

					hidden_effect = { news_event = { id = nsb_news.104 days = 4 random_days = 2 } } #Only ENG sends the news event.
				}
			}
			activate_mission = SOV_operation_countenance
			if = { #Activate mission for ENG if joint operation
				limit = {
					has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
				}
				ENG = {
					activate_mission = SOV_operation_countenance
				}
			}
			custom_effect_tooltip = SOV_preparations_for_operation_countenance_mission_tt

			hidden_effect = { #Add all AI strategies
				SOV_anglo_soviet_invasion_add_ai_strategies_effect = yes
			}
		}
	}

	SOV_operation_countenance = { # Mission for SOV (or SOV + ENG) to capitulate Iran in time, before they seek foreign help
		priority = 50

		icon = generic_operation

		allowed = {
			OR = {
				original_tag = SOV
				original_tag = ENG
			}
		}

		available =  {
			PER = { has_capitulated = yes }
			all_of_scopes = {
				array = SOV_iranian_initial_states
				OR = {
					is_controlled_by = SOV
					any_allied_country = {
						controls_state = PREV
					}
					AND = {
						has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
						OR = {
							is_controlled_by = ENG
							ENG = {
								any_allied_country = {
									controls_state = PREV
								}
							}
						}
					}
				}
			}
		}

		activation = {
			always = no
		}

		days_mission_timeout = SOV.SOV_operation_countenance_mission_days

		timeout_effect = { #FAIL -> Lose some stuff and Iran wants to enter an alliance
			add_political_power = -25
			add_command_power = -25
			add_war_support = -0.05

			hidden_effect = { #AI strategies
				if = {
					limit = {
						OR = {
							original_tag = SOV
							AND = {
								original_tag = ENG
								has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
								NOT = { country_exists = SOV }
							}
						}
					}
					SOV_failed_anglo_soviet_invasion_ai_strategies_effect = yes
				}
			}
		}

		complete_effect = {
			add_command_power = 50
			add_war_support = 0.1

			effect_tooltip = {
				if = { #Soviets alone (or joint but ENG died)
					limit = {
						OR = {
							has_global_flag = SOV_soviet_invasion_of_iran_flag
							AND = {
								has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
								NOT = { country_exists = ENG }
							}
						}
					}
					FROM = {
						puppet = ROOT #SOV puppet Iran
						transfer_state = 419 #Tibriz (AZB)
						transfer_state = 420 #Gilan (AZB)
						transfer_state = 416 #Khorasan
					}
					give_resource_rights = { receiver = SOV state = 411 }
					give_resource_rights = { receiver = SOV state = 412 }
					give_resource_rights = { receiver = SOV state = 413 }
				}
				else_if = {
					limit = {
						has_global_flag = SOV_agreed_anglo_soviet_invasion_of_iran_flag
					}
					ENG = {
						puppet = ROOT #ENG gets to puppet Iran
					}
					SOV = {
						transfer_state = 419 #Tibriz (AZB)
						transfer_state = 420 #Gilan (AZB)
						transfer_state = 416 #Khorasan
					}
					FROM = { 
						give_resource_rights = { receiver = SOV state = 411 }
						give_resource_rights = { receiver = SOV state = 412 }
						give_resource_rights = { receiver = ENG state = 413 }
						give_military_access = ROOT
					}
				}
			}
		}
	}
}



############
### ASIA ###
############

SOV_diplomacy_asia_decision_category = {
	

	SOV_peace_deal_for_south_sakhalin_and_kuril_islands = {
		priority = 999

		icon = eng_trade_unions_support

		ai_will_do = {
			base = 2
			modifier = {
				factor = 0
				controls_state = 282
			}
		}

		targets = { JAP }

		target_trigger = {
			FROM = { tag = JAP }
		}

		target_root_trigger = {
			has_completed_focus = SOV_recover_the_kuril_islands
			country_exists = JAP
			has_war_with = JAP
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			controls_state = 537
			JAP = { owns_state = 537 }
			controls_state = 555
			JAP = { owns_state = 555 }
			surrender_progress < 0.01
		}

		visible = {
		}

		fire_only_once = yes

		cost = SOV_peace_deal_cost

		complete_effect = {
			JAP = { country_event = { id = NSB_soviet_foreign_politics_events.260 hours = 4 random_hours = 2 } }
			custom_effect_tooltip = if_they_accept
			effect_tooltip = {
				JAP = {
					white_peace = FROM
				}
				537 = {
					add_core_of = ROOT
				}
				555 = {
					add_core_of = ROOT
				}
				transfer_state = 537
				transfer_state = 555
			}
		}
	}

	SOV_peace_deal_for_hokkaido = {
		priority = 999

		icon = eng_trade_unions_support

		ai_will_do = {
			base = 4
			modifier = {
				factor = 0
				controls_state = 282
			}
		}

		targets = { JAP }

		target_trigger = {
			FROM = { tag = JAP }
		}

		target_root_trigger = {
			has_completed_focus = SOV_recover_the_kuril_islands
			country_exists = JAP
			has_war_with = JAP
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			controls_state = 537
			JAP = { owns_state = 537 }
			controls_state = 555
			JAP = { owns_state = 555 }
			controls_state = 536
			JAP = { owns_state = 536 }
			surrender_progress < 0.01
		}

		visible = {
		}

		fire_only_once = yes

		cost = SOV_peace_deal_cost

		complete_effect = {
			JAP = { country_event = { id = NSB_soviet_foreign_politics_events.261 hours = 4 random_hours = 2 } }
			custom_effect_tooltip = if_they_accept
			effect_tooltip = {
				JAP = {
					white_peace = FROM
				}
				537 = {
					add_core_of = ROOT
				}
				555 = {
					add_core_of = ROOT
				}
				536 = {
					add_core_of = ROOT
				}
				transfer_state = 537
				transfer_state = 555
				transfer_state = 536
			}
		}
	}

	SOV_sinkiang_mineral_prospection_sik = {
		priority = 50

		icon = generic_construction

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SIK = {
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 619 #YARKAND
			}
			num_of_civilian_factories_available_for_projects > 0
			NOT = { has_country_flag = SOV_sinkiang_investment_ongoing_flag }			
		}

		visible = {
			has_completed_focus = SOV_the_gobi_gambit
			SIK = { #Relevant states under Sinkiang control
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 619 #YARKAND	
			}
			is_subject = no
			has_capitulated = no
			NOT = { has_country_flag = SOV_sinkiang_prospection_rejected_flag }
			NOT = { has_country_flag = SOV_sinkiang_prospection_flag } #Do not do this twice, one with SIK one without SIK
		}

		cancel_trigger = {
			OR = {
				SIK = { #Relevant states under Sinkiang control
					OR = {
						SOV_is_valid_subject = no
						has_war_with = ROOT
						NOT = { has_full_control_of_state = 617 } #URUMQI
						NOT = { has_full_control_of_state = 619 } #YARKAND
					}
				}
				is_subject = yes
				has_capitulated = yes
				has_country_flag = SOV_sinkiang_prospection_rejected_flag
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			hidden_effect = {
				SIK = {
					remove_mission = SOV_sinkiang_mineral_prospection_mission_dummy
				}
			}
		}

		days_remove = SOV_sinkiang_mineral_prospection_days

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_sinkiang_investment_ongoing_flag
			SIK = {
				country_event = { id = NSB_soviet_foreign_politics_events.273 hours = 2 }
			}
			# IF THEY ACCEPT
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_complied_with_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_cg_tt_sov				
			}
			# IF THEY REFUSE
			custom_effect_tooltip = if_they_refuse_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_rejected_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_refuse_tt
			}
		}

		remove_effect = {
			hidden_effect = { #Decrease SIK's desire to join Chinese faction (and other AI strategies)
				SOV_approach_sinkiang_diplomacy_effect = yes
				SIK = {
					add_ai_strategy = { #This is added in Gobi Gambit + all 3 investment decisions
						type = alliance
						id = SOV		
						value = 4
					}
				}
			}
			619 = { #YARKAND - Minerals and Infra
				add_resource = {
					type = bauxite
					amount = 3
				}
				add_resource = {
					type = chromium
					amount = 3
				}
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			617 = { #URUMQI
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			# Urumqi - Kashgar
			build_railway = {
				path = { 4709 4770 7702 4682 7949 2015 }
			}

			#Supply Hub in Kashgar
			619 = {
				add_building_construction = {
					type = supply_node
					level = 1
					province = 2015
					instant_build = yes
				}
			}

			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			set_country_flag = SOV_sinkiang_prospection_flag
		}
	}

	SOV_sinkiang_oil_prospection_sik = {
		priority = 50

		icon = generic_construction

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SIK = {
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 618 #DZUNGARIA
			}
			num_of_civilian_factories_available_for_projects > 1
			NOT = { has_country_flag = SOV_sinkiang_investment_ongoing_flag }			
		}

		visible = {
			has_completed_focus = SOV_the_gobi_gambit
			SIK = { #Relevant states under Sinkiang control
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 618 #DZUNGARIA		
			}
			is_subject = no
			has_capitulated = no
			NOT = { has_country_flag = SOV_sinkiang_oil_prospection_rejected_flag }
			NOT = { has_country_flag = SOV_sinkiang_oil_prospection_flag } #Do not do this twice, one with SIK one without SIK
		}

		cancel_trigger = {
			OR = {
				SIK = { #Relevant states under Sinkiang control
					OR = {
						SOV_is_valid_subject = no
						has_war_with = ROOT
						NOT = { has_full_control_of_state = 617 } #URUMQI
						NOT = { has_full_control_of_state = 618 } #DZUNGARIA
					}
				}
				is_subject = yes
				has_capitulated = yes
				has_country_flag = SOV_sinkiang_oil_prospection_rejected_flag
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			hidden_effect = {
				SIK = {
					remove_mission = SOV_sinkiang_oil_prospection_mission_dummy
				}
			}
		}

		days_remove = SOV_sinkiang_oil_prospection_days
		
		fire_only_once = yes

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 2
		}

		complete_effect = {
			set_country_flag = SOV_sinkiang_investment_ongoing_flag
			SIK = {
				country_event = { id = NSB_soviet_foreign_politics_events.276 hours = 2 }
			}
			# IF THEY ACCEPT
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_complied_with_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_cg_tt_sov				
			}
			# IF THEY REFUSE
			custom_effect_tooltip = if_they_refuse_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_rejected_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_refuse_tt
			}
		}

		remove_effect = {
			hidden_effect = { #Decrease SIK's desire to join Chinese faction (and other AI strategies)
				SOV_approach_sinkiang_diplomacy_effect = yes
				SIK = {
					add_ai_strategy = { #This is added in Gobi Gambit + all 3 investment decisions
						type = alliance
						id = SOV		
						value = 4
					}
				}
			}
			618 = { #DZUNGARIA - Minerals, oil and Infra
				add_resource = {
					type = bauxite
					amount = 3
				}
				add_resource = {
					type = tungsten
					amount = 3
				}
				add_resource = {
					type = oil
					amount = 6
				}
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			SIK = { give_resource_rights = { receiver = SOV state = 618 } } # Grant Resource rights to SOV
			617 = { #URUMQI - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			# Urumqi - Altay
			build_railway = {
				path = { 4709 10674 1783 1844 12737 4823 }
			}
			#Supply Hub in Altay
			618 = {
				add_building_construction = {
					type = supply_node
					level = 1
					province = 4823
					instant_build = yes
				}
			}

			SIK = { add_ideas = SOV_expanded_exploitation_of_gold_mines }

			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			set_country_flag = SOV_sinkiang_oil_prospection_flag
		}
	}

	SOV_sinkiang_military_aid_sik = {
		priority = 50

		icon = generic_military

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SIK = {
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 618 #DZUNGARIA
			}
			num_of_civilian_factories_available_for_projects > 0
			has_equipment = { fighter_equipment > 39 }
			has_equipment = { infantry_equipment > 499 }
			NOT = { has_country_flag = SOV_sinkiang_investment_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_the_gobi_gambit
			SIK = { #Relevant states under Sinkiang control
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 759 #KUNLUN SHAN		
			}
			is_subject = no
			has_capitulated = no
			NOT = { has_country_flag = SOV_sinkiang_military_aid_rejected_flag }
			NOT = { has_country_flag = SOV_sinkiang_military_aid_flag } #Do not do this twice, one with SIK one without SIK
		}

		cancel_trigger = {
			OR = {
				SIK = { #Relevant states under Sinkiang control
					OR = {
						SOV_is_valid_subject = no
						has_war_with = ROOT
						NOT = { has_full_control_of_state = 617 } #URUMQI
						NOT = { has_full_control_of_state = 759 } #KUNLUN SHAN
					}
				}
				is_subject = yes
				has_capitulated = yes
				has_country_flag = SOV_sinkiang_military_aid_rejected_flag
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			hidden_effect = {
				SIK = {
					remove_mission = SOV_sinkiang_military_aid_mission_dummy
				}
			}
		}

		days_remove = SOV_sinkiang_military_aid_days
		
		fire_only_once = yes

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_sinkiang_investment_ongoing_flag
			SIK = {
				country_event = { id = NSB_soviet_foreign_politics_events.278 hours = 2 }
			}
			# IF THEY ACCEPT
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_complied_with_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_cg_tt_sov

				send_equipment = {
					type = fighter_equipment
					amount = 40
					target = SIK
				}
				send_equipment = {
					type = infantry_equipment
					amount = 500
					target = SIK
				}
			}
			# IF THEY REFUSE
			custom_effect_tooltip = if_they_refuse_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_rejected_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_refuse_tt
			}
		}

		remove_effect = {
			hidden_effect = { #Decrease SIK's desire to join Chinese faction (and other AI strategies)
				SOV_approach_sinkiang_diplomacy_effect = yes
				SIK = {
					add_ai_strategy = { #This is added in Gobi Gambit + all 3 investment decisions
						type = alliance
						id = SOV		
						value = 4
					}
				}
			}
			617 = { #URUMQI - Mil
				if = {
					limit = {
						free_building_slots = {
							building = arms_factory
							size > 0
							include_locked = yes
						}
					}
					add_extra_state_shared_building_slots = 1
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
				}
			}
			759 = { #KUNLUN SHAN - Infra + Air base + Forts
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				if = {
					limit = {
						air_base < 9
					}
					add_building_construction = {
						type = air_base
						level = 2
						instant_build = yes
					}
				}
				else_if = {
					limit = {
						air_base < 10
					}
					add_building_construction = {
						type = air_base
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 10315
						id = 2074
						id = 1698
						id = 4947
					}
					instant_build = yes
				}
			}
			if = {  #DABANCHENG - Forts
				limit = {
					SIK = { has_full_control_of_state = 760 }
				}
				760 = {
					add_building_construction = {
						type = bunker
						level = 1
						province = {
							id = 1838
							id = 4843
						}
						instant_build = yes
					}
				}
			}

			SIK = {
				add_tech_bonus = {
					name = NSB_soviet_foreign_politics_events.278.t
					bonus = 1
					uses = 2
					category = air_equipment
				}
				air_experience = 50
				army_experience = 50
			}
			
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			set_country_flag = SOV_sinkiang_military_aid_flag
		}
	}

	SOV_sinkiang_support_expansion_sik = {
		priority = 50

		icon = infiltrate_state

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			SIK = {
				SOV_is_valid_subject = yes
				is_in_faction_with = ROOT
				has_full_control_of_state = 604 #QINGHAI
				has_full_control_of_state = 755 #HAIXI
				has_full_control_of_state = 756 #JIUQUAN
				has_full_control_of_state = 754 #GOLOG
				has_full_control_of_state = 753 #GANNAN
				has_full_control_of_state = 283 #GANSU
				has_full_control_of_state = 616 #NINGXIA
			}
			num_of_civilian_factories_available_for_projects > 2
			has_equipment = { motorized_equipment > 299 }
			NOT = { has_country_flag = SOV_sinkiang_investment_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_the_gobi_gambit
			SIK = { #Relevant states under Sinkiang control
				SOV_is_valid_subject = yes
				NOT = { has_war_with = ROOT }
				has_full_control_of_state = 617 #URUMQI
				has_full_control_of_state = 759 #KUNLUN SHAN		
			}
			is_subject = no
			has_capitulated = no
			NOT = { has_country_flag = SOV_sinkiang_support_expansion_rejected_flag }
			NOT = { has_country_flag = SOV_sinkiang_support_expansion_flag } #Do not do this twice, one with SIK one without SIK
		}

		cancel_trigger = {
			OR = {
				SIK = { #Relevant states under Sinkiang control
					OR = {
						SOV_is_valid_subject = no
						has_war_with = ROOT
						NOT = { is_in_faction_with = ROOT }
						NOT = { has_full_control_of_state = 604 } #QINGHAI
						NOT = { has_full_control_of_state = 755 } #HAIXI
						NOT = { has_full_control_of_state = 756 } #JIUQUAN
						NOT = { has_full_control_of_state = 754 } #GOLOG
						NOT = { has_full_control_of_state = 753 } #GANNAN
						NOT = { has_full_control_of_state = 283 } #GANSU
						NOT = { has_full_control_of_state = 616 } #NINGXIA
					}
				}
				is_subject = yes
				has_capitulated = yes
				has_country_flag = SOV_sinkiang_support_expansion_rejected_flag
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			hidden_effect = {
				SIK = {
					remove_mission = SOV_sinkiang_support_expansion_mission_dummy
				}
			}
		}

		days_remove = SOV_sinkiang_support_expansion_days
		
		fire_only_once = yes

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 3
		}

		complete_effect = {
			set_country_flag = SOV_sinkiang_investment_ongoing_flag
			SIK = {
				country_event = { id = NSB_soviet_foreign_politics_events.280 hours = 2 }
			}
			# IF THEY ACCEPT
			custom_effect_tooltip = if_they_accept_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_complied_with_our_demands
				}
				send_equipment = {
					type = motorized_equipment
					amount = 300
					target = SIK
				}
				custom_effect_tooltip = SOV_sinikiang_influence_cg_tt_sov
			}
			# IF THEY REFUSE
			custom_effect_tooltip = if_they_refuse_tt
			effect_tooltip = {
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_rejected_our_demands
				}
				custom_effect_tooltip = SOV_sinikiang_influence_refuse_tt
			}
		}

		remove_effect = {
			hidden_effect = { #Decrease SIK's desire to join Chinese faction (and other AI strategies)
				SOV_approach_sinkiang_diplomacy_effect = yes
				SIK = {
					add_ai_strategy = { #This is added in Gobi Gambit + all 3 investment decisions
						type = alliance
						id = SOV		
						value = 4
					}
				}
			}
			755 = { #HAIXI - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			756 = { #JIUQUAN - Infra + Oil
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_resource = {
					type = oil
					amount = 12
				}
			}
			604 = { #QINGHAI (Golmud) - Infra 
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 7940
					}
					instant_build = yes
				}
			}
			754 = { #GOLOG (Lanzhou) - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 12732
					}
					instant_build = yes
				}
			}
			283 = { #GANSU - Infra + Air Base + Fort
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				if = {
					limit = {
						air_base < 9
					}
					add_building_construction = {
						type = air_base
						level = 2
						instant_build = yes
					}
				}
				else_if = {
					limit = {
						air_base < 10
					}
					add_building_construction = {
						type = air_base
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 531
					}
					instant_build = yes
				}
			}
			
			clr_country_flag = SOV_sinkiang_investment_ongoing_flag
			set_country_flag = SOV_sinkiang_support_expansion_flag
		}
	}

	SOV_formalize_of_the_soviet_republic_of_sinkiang = {
		priority = 20

		icon = generic_nationalism

		ai_will_do = {
			base = 0.8
		}

		fire_only_once = yes

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = SOV_sinkiang_prospection_flag
			has_country_flag = SOV_sinkiang_oil_prospection_flag
			has_country_flag = SOV_sinkiang_military_aid_flag
			SIK = {
				is_in_faction_with = ROOT
				has_opinion = {
					target = ROOT
					value > 80
				}
				has_government = communism
			}
			has_country_flag = { flag = SOV_sinkiang_joined_comintern_counter_flag days > 730 }
			custom_trigger_tooltip = {
				tooltip = SOV_sinkiang_joined_comintern_days_tt
				has_country_flag = {
					flag = SOV_sinkiang_joined_comintern_counter_flag
					days > 730
				}
			}
			strength_ratio = {
			    tag = SIK
			    ratio > 2
			}
		}

		visible = {
			has_completed_focus = SOV_the_gobi_gambit
			country_exists = SIK
			SIK = {
				is_subject = no
			}
			NOT = { has_war_with = FROM }
		}

		cost = 100

		complete_effect = { 
			SIK = {
				country_event = { id = NSB_soviet_foreign_politics_events.282 hours = 2 }
			}
			# IF THEY ACCEPT
			custom_effect_tooltip = if_they_accept_tt			
			effect_tooltip = {
				puppet = SIK
				add_opinion_modifier = {
					target = SIK
					modifier = SOV_complied_with_our_demands
				}
			}

			# IF THEY REFUSE
			custom_effect_tooltip = if_they_refuse_tt
			add_opinion_modifier = {
				target = ROOT
				modifier = SOV_rejected_our_demands
			}

			custom_effect_tooltip = SOV_formalize_of_the_soviet_republic_of_sinkiang_only_once_tt
		}
	}
}


 ######  #### ##    ## ##    ## ####    ###    ##    ##  ######   ####  ######     ########  ##     ## ##     ## ##     ## #### ########  ######  
##    ##  ##  ###   ## ##   ##   ##    ## ##   ###   ## ##    ##  #### ##    ##    ##     ## ##     ## ###   ### ###   ###  ##  ##       ##    ## 
##        ##  ####  ## ##  ##    ##   ##   ##  ####  ## ##         ##  ##          ##     ## ##     ## #### #### #### ####  ##  ##       ##       
 ######   ##  ## ## ## #####     ##  ##     ## ## ## ## ##   #### ##    ######     ##     ## ##     ## ## ### ## ## ### ##  ##  ######    ######  
      ##  ##  ##  #### ##  ##    ##  ######### ##  #### ##    ##             ##    ##     ## ##     ## ##     ## ##     ##  ##  ##             ## 
##    ##  ##  ##   ### ##   ##   ##  ##     ## ##   ### ##    ##       ##    ##    ##     ## ##     ## ##     ## ##     ##  ##  ##       ##    ## 
 ######  #### ##    ## ##    ## #### ##     ## ##    ##  ######         ######     ########   #######  ##     ## ##     ## #### ########  ######  


SOV_soviet_aid_decision_category = {
	SOV_sinkiang_mineral_prospection_mission_dummy = { # Fake "Mission" for Sinkiang so that they can see Soviet progress on this
		priority = 50

		icon = generic_construction

		allowed = { 
			original_tag = SOV
		}

		available =  {
			hidden_trigger = { always = no }
		}

		activation = {
			always = no
		}

		cancel_trigger = {
			OR = {
				SOV_is_valid_subject = no
				has_war_with = SOV
				NOT = { has_full_control_of_state = 617 } #URUMQI
				NOT = { has_full_control_of_state = 619 } #YARKAND
				SOV = { is_subject = yes }
				SOV = { has_capitulated = yes }
			}
		}

		is_good = yes

		days_mission_timeout = SOV.SOV_sinkiang_mineral_prospection_days

		timeout_effect = {
			effect_tooltip = {
				619 = { #YARKAND - Minerals and Infra
					add_resource = {
						type = bauxite
						amount = 3
					}
					add_resource = {
						type = chromium
						amount = 3
					}
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
				}
				617 = { #URUMQI
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
				}
				# Urumqi - Kashgar
				build_railway = {
					path = { 4709 4770 7702 4682 7949 2015 }
				}

				#Supply Hub in Kashgar
				619 = {
					add_building_construction = {
						type = supply_node
						level = 1
						province = 2015
						instant_build = yes
					}
				}
			}
		}
	}

	SOV_sinkiang_oil_prospection_mission_dummy = { # Fake "Mission" for Sinkiang so that they can see Soviet progress on this
		priority = 50

		icon = generic_construction

		allowed = { 
			original_tag = SOV
		}

		available =  {
			hidden_trigger = { always = no }
		}

		activation = {
			always = no
		}

		cancel_trigger = {
			OR = {
				SOV_is_valid_subject = no
				has_war_with = SOV
				NOT = { has_full_control_of_state = 617 } #URUMQI
				NOT = { has_full_control_of_state = 618 } #DZUNGARIA
				SOV = { is_subject = yes }
				SOV = { has_capitulated = yes }
			}
		}

		is_good = yes

		days_mission_timeout = SOV.SOV_sinkiang_oil_prospection_days

		timeout_effect = {
			effect_tooltip = {
				618 = { #DZUNGARIA - Minerals, oil and Infra
					add_resource = {
						type = bauxite
						amount = 3
					}
					add_resource = {
						type = tungsten
						amount = 3
					}
					add_resource = {
						type = oil
						amount = 6
					}
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
				}
				give_resource_rights = { receiver = SOV state = 618 } # Grant Resource rights to SOV
				617 = { #URUMQI - Infra
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
				}
				# Urumqi - Altay
				build_railway = {
					path = { 4709 10674 1783 1844 12737 4823 }
				}
				#Supply Hub in Altay
				618 = {
					add_building_construction = {
						type = supply_node
						level = 1
						province = 4823
						instant_build = yes
					}
				}
				
				add_ideas = SOV_expanded_exploitation_of_gold_mines
			}
		}
	}

	SOV_sinkiang_military_aid_mission_dummy = { # Fake "Mission" for Sinkiang so that they can see Soviet progress on this
		priority = 50

		icon = generic_military

		allowed = { 
			original_tag = SOV
		}

		available =  {
			hidden_trigger = { always = no }
		}

		activation = {
			always = no
		}

		cancel_trigger = {
			OR = {
				SOV_is_valid_subject = no
				has_war_with = SOV
				NOT = { has_full_control_of_state = 617 } #URUMQI
				NOT = { has_full_control_of_state = 759 } #KUNLUN SHAN
				SOV = { is_subject = yes }
				SOV = { has_capitulated = yes }
			}
		}

		is_good = yes

		days_mission_timeout = SOV.SOV_sinkiang_military_aid_days

		timeout_effect = {
			effect_tooltip = {
				617 = { #URUMQI - Mil
					if = {
						limit = {
							free_building_slots = {
								building = arms_factory
								size > 0
								include_locked = yes
							}
						}
						add_extra_state_shared_building_slots = 1
						add_building_construction = {
							type = arms_factory
							level = 1
							instant_build = yes
						}
					}
				}
				759 = { #KUNLUN SHAN - Infra + Air base + Forts
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
					if = {
						limit = {
							air_base < 9
						}
						add_building_construction = {
							type = air_base
							level = 2
							instant_build = yes
						}
					}
					else_if = {
						limit = {
							air_base < 10
						}
						add_building_construction = {
							type = air_base
							level = 1
							instant_build = yes
						}
					}
					add_building_construction = {
						type = bunker
						level = 1
						province = {
							id = 10315
							id = 2074
							id = 1698
							id = 4947
						}
						instant_build = yes
					}
				}
				if = {  #DABANCHENG - Forts
					limit = {
						has_full_control_of_state = 760
					}
					760 = {
						add_building_construction = {
							type = bunker
							level = 1
							province = {
								id = 1838
								id = 4843
							}
							instant_build = yes
						}
					}
				}
				add_tech_bonus = {
					name = NSB_soviet_foreign_politics_events.278.t
					bonus = 1
					uses = 2
					category = air_equipment
				}
				air_experience = 50
				army_experience = 50
			}
		}
	}

	SOV_sinkiang_support_expansion_mission_dummy = { # Fake "Mission" for Sinkiang so that they can see Soviet progress on this
		priority = 50

		icon = infiltrate_state

		allowed = { 
			original_tag = SOV
		}

		available =  {
			hidden_trigger = { always = no }
		}

		activation = {
			always = no
		}

		cancel_trigger = {
			OR = { #Relevant states under Sinkiang control
				SOV_is_valid_subject = no
				has_war_with = ROOT
				NOT = { is_in_faction_with = ROOT }
				NOT = { has_full_control_of_state = 604 } #QINGHAI
				NOT = { has_full_control_of_state = 755 } #HAIXI
				NOT = { has_full_control_of_state = 756 } #JIUQUAN
				NOT = { has_full_control_of_state = 754 } #GOLOG
				NOT = { has_full_control_of_state = 753 } #GANNAN
				NOT = { has_full_control_of_state = 283 } #GANSU
				NOT = { has_full_control_of_state = 616 } #NINGXIA
			}
			SOV = {
				OR = {
					is_subject = yes
					has_capitulated = yes
					has_country_flag = SOV_sinkiang_support_expansion_rejected_flag
				}
			}
		}

		is_good = yes

		days_mission_timeout = SOV.SOV_sinkiang_support_expansion_days

		timeout_effect = {
			effect_tooltip = {
				755 = { #HAIXI - Infra
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
				}
				756 = { #JIUQUAN - Infra + Oil
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
					add_resource = {
						type = oil
						amount = 12
					}
				}
				604 = { #QINGHAI (Golmud) - Infra 
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
					add_building_construction = {
						type = bunker
						level = 1
						province = {
							id = 7940
						}
						instant_build = yes
					}
				}
				754 = { #GOLOG (Lanzhou) - Infra
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
					add_building_construction = {
						type = bunker
						level = 1
						province = {
							id = 12732
						}
						instant_build = yes
					}
				}
				283 = { #GANSU - Infra + Air Base + Fort
					if = {
						limit = {
							infrastructure < 5
						}
						add_building_construction = {
							type = infrastructure
							level = 1
							instant_build = yes
						}
					}
					if = {
						limit = {
							air_base < 9
						}
						add_building_construction = {
							type = air_base
							level = 2
							instant_build = yes
						}
					}
					else_if = {
						limit = {
							air_base < 10
						}
						add_building_construction = {
							type = air_base
							level = 1
							instant_build = yes
						}
					}
					add_building_construction = {
						type = bunker
						level = 1
						province = {
							id = 531
						}
						instant_build = yes
					}
				}
			}
		}
	}
}


########  ########  ######   #######  ##     ## ########   ######  ########    ########  ########   #######   ######  ########  ########  ######  ######## ####  #######  ##    ## 
##     ## ##       ##    ## ##     ## ##     ## ##     ## ##    ## ##          ##     ## ##     ## ##     ## ##    ## ##     ## ##       ##    ##    ##     ##  ##     ## ###   ## 
##     ## ##       ##       ##     ## ##     ## ##     ## ##       ##          ##     ## ##     ## ##     ## ##       ##     ## ##       ##          ##     ##  ##     ## ####  ## 
########  ######    ######  ##     ## ##     ## ########  ##       ######      ########  ########  ##     ##  ######  ########  ######   ##          ##     ##  ##     ## ## ## ## 
##   ##   ##             ## ##     ## ##     ## ##   ##   ##       ##          ##        ##   ##   ##     ##       ## ##        ##       ##          ##     ##  ##     ## ##  #### 
##    ##  ##       ##    ## ##     ## ##     ## ##    ##  ##    ## ##          ##        ##    ##  ##     ## ##    ## ##        ##       ##    ##    ##     ##  ##     ## ##   ### 
##     ## ########  ######   #######   #######  ##     ##  ######  ########    ##        ##     ##  #######   ######  ##        ########  ######     ##    ####  #######  ##    ## 


prospect_for_resources = {
	SOV_sinkiang_mineral_prospection = { #Development in Sinkiang but without Sinkiang
		priority = 50

		icon = generic_construction

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_completed_focus = SOV_the_gobi_gambit
			has_full_control_of_state = 617 #URUMQI
			has_full_control_of_state = 619 #YARKAND
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			NOT = { has_country_flag = SOV_sinkiang_prospection_flag } #Do not do this twice, one with SIK one without SIK
			has_full_control_of_state = 617 #URUMQI
			has_full_control_of_state = 619 #YARKAND
		}

		cancel_if_not_visible = yes

		days_remove = SOV_sinkiang_mineral_prospection_days

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 1
		}

		remove_effect = {
			619 = { #YARKAND - Minerals and Infra
				add_resource = {
					type = bauxite
					amount = 3
				}
				add_resource = {
					type = chromium
					amount = 3
				}
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			617 = { #URUMQI
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			# Urumqi - Kashgar
			build_railway = {
				path = { 4709 4770 7702 4682 7949 2015 }
			}

			#Supply Hub in Kashgar
			619 = {
				add_building_construction = {
					type = supply_node
					level = 1
					province = 2015
					instant_build = yes
				}
			}

			set_country_flag = SOV_sinkiang_prospection_flag
		}
	}

	SOV_sinkiang_oil_prospection = { #Development in Sinkiang but without Sinkiang
		priority = 50

		icon = generic_construction

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_completed_focus = SOV_the_gobi_gambit
			has_full_control_of_state = 617 #URUMQI
			has_full_control_of_state = 618 #DZUNGARIA
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			NOT = { has_country_flag = SOV_sinkiang_oil_prospection_flag } #Do not do this twice, one with SIK one without SIK
			has_full_control_of_state = 617 #URUMQI
			has_full_control_of_state = 618 #DZUNGARIA
		}

		cancel_if_not_visible = yes

		days_remove = SOV_sinkiang_mineral_prospection_days

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 2
		}

		remove_effect = {
			618 = { #DZUNGARIA - Minerals, oil and Infra
				add_resource = {
					type = bauxite
					amount = 3
				}
				add_resource = {
					type = tungsten
					amount = 3
				}
				add_resource = {
					type = oil
					amount = 6
				}
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			617 = { #URUMQI - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			# Urumqi - Altay
			build_railway = {
				path = { 4709 10674 1783 1844 12737 4823 }
			}
			#Supply Hub in Altay
			618 = {
				add_building_construction = {
					type = supply_node
					level = 1
					province = 4823
					instant_build = yes
				}
			}

			set_country_flag = SOV_sinkiang_oil_prospection_flag
		}
	}

	SOV_jiuquan_oil_prospection = { #Development in Jiuquan but without Sinkiang or XSM
		priority = 50

		icon = generic_construction

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_completed_focus = SOV_the_gobi_gambit
			has_full_control_of_state = 604 #QINGHAI
			has_full_control_of_state = 755 #HAIXI
			has_full_control_of_state = 756 #JIUQUAN
			has_full_control_of_state = 754 #GOLOG
			has_full_control_of_state = 753 #GANNAN
			has_full_control_of_state = 283 #GANSU
			has_full_control_of_state = 616 #NINGXIA
			num_of_civilian_factories_available_for_projects > 1
		}

		visible = {
			NOT = { has_country_flag = SOV_sinkiang_support_expansion_flag } #Do not do this twice, one with SIK one without SIK
			has_full_control_of_state = 604 #QINGHAI
			has_full_control_of_state = 755 #HAIXI
			has_full_control_of_state = 756 #JIUQUAN
			has_full_control_of_state = 754 #GOLOG
			has_full_control_of_state = 753 #GANNAN
			has_full_control_of_state = 283 #GANSU
			has_full_control_of_state = 616 #NINGXIA
		}

		cancel_if_not_visible = yes

		days_remove = SOV_sinkiang_support_expansion_days

		cost = SOV_sinkiang_proposal_cost

		modifier = {
			civilian_factory_use = 2
		}

		remove_effect = {
			755 = { #HAIXI - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
			}
			756 = { #JIUQUAN - Infra + Oil
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_resource = {
					type = oil
					amount = 12
				}
			}
			604 = { #QINGHAI (Golmud) - Infra 
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 7940
					}
					instant_build = yes
				}
			}
			754 = { #GOLOG (Lanzhou) - Infra
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 12732
					}
					instant_build = yes
				}
			}
			283 = { #GANSU - Infra + Air Base + Fort
				if = {
					limit = {
						infrastructure < 5
					}
					add_building_construction = {
						type = infrastructure
						level = 1
						instant_build = yes
					}
				}
				if = {
					limit = {
						air_base < 9
					}
					add_building_construction = {
						type = air_base
						level = 2
						instant_build = yes
					}
				}
				else_if = {
					limit = {
						air_base < 10
					}
					add_building_construction = {
						type = air_base
						level = 1
						instant_build = yes
					}
				}
				add_building_construction = {
					type = bunker
					level = 1
					province = {
						id = 531
					}
					instant_build = yes
				}
			}
			set_country_flag = SOV_sinkiang_support_expansion_flag
		}
	}
}



##     ## ######## ########   ######   ########    ########  ########  ######  ####  ######   ##    ## ######## ########   ######  
###   ### ##       ##     ## ##    ##  ##          ##     ## ##       ##    ##  ##  ##    ##  ###   ## ##       ##     ## ##    ## 
#### #### ##       ##     ## ##        ##          ##     ## ##       ##        ##  ##        ####  ## ##       ##     ## ##       
## ### ## ######   ########  ##   #### ######      ##     ## ######    ######   ##  ##   #### ## ## ## ######   ########   ######  
##     ## ##       ##   ##   ##    ##  ##          ##     ## ##             ##  ##  ##    ##  ##  #### ##       ##   ##         ## 
##     ## ##       ##    ##  ##    ##  ##          ##     ## ##       ##    ##  ##  ##    ##  ##   ### ##       ##    ##  ##    ## 
##     ## ######## ##     ##  ######   ########    ########  ########  ######  ####  ######   ##    ## ######## ##     ##  ######  


SOV_merge_designers_dec_cat = {

	SOV_debug_merge_designers_FASTER_AND_FREE = {
		priority = 999

		icon = eng_ally_imperialist_coup

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_merge_tank_and_materiel_plants
				has_completed_focus = SOV_merge_naval_plants
				has_completed_focus = SOV_merge_aircraft_plants
			}
			NOT = {
				has_country_flag = SOV_debug_fast_merge_desingers_flag
			}
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_debug_fast_merge_desingers_flag
			set_variable = { SOV_merge_designers_cost = 0 }
			set_variable = { SOV_merge_designers_time = 3 }
		}
	}

	SOV_debug_merge_designers_BACK_TO_REGULAR_STUFF = {
		priority = 999

		icon = eng_ally_imperialist_coup

		ai_will_do = {
			base = 0
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			OR = {
				has_completed_focus = SOV_merge_tank_and_materiel_plants
				has_completed_focus = SOV_merge_naval_plants
				has_completed_focus = SOV_merge_aircraft_plants
			}
			has_country_flag = SOV_debug_fast_merge_desingers_flag
			is_debug = yes
		}

		cost = 0

		complete_effect = {
			clr_country_flag = SOV_debug_fast_merge_desingers_flag
			set_variable = { SOV_merge_designers_cost = 50 }
			set_variable = { SOV_merge_designers_time = 90 }
		}
	}

	#####################
	### TANK DESIGNER ###
	#####################
	SOV_merge_tank_plant = {
		priority = 53

		icon = GFX_decision_generic_merge_plant_tank

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_tank_designer_any = yes
			NOT = { has_country_flag = SOV_merge_tank_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_tank_merged_1 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_tank_designer_any = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_tank_plant_tt
			hidden_effect = {
				SOV_upgrade_appropriate_tank_designer_1_effect = yes
			}
		}
	}

	SOV_merge_tank_plant_2 = {
		priority = 52

		icon = GFX_decision_generic_merge_plant_tank

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 252 #GORKY
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_tank_designer_any = yes
			NOT = { has_country_flag = SOV_merge_tank_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_tank_merged_2 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_tank_designer_any = no
				NOT = { has_full_control_of_state = 252 } #GORKY
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_tank_plant_2_tt
			hidden_effect = {
				SOV_upgrade_appropriate_tank_designer_2_effect = yes
			}
		}
	}

	SOV_merge_tank_plant_3 = {
		priority = 51

		icon = GFX_decision_generic_merge_plant_tank

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 653 #SVERDLOVSK
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_tank_designer_any = yes
			NOT = { has_country_flag = SOV_merge_tank_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_tank_merged_3 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_tank_designer_any = no
				NOT = { has_full_control_of_state = 653 } #SVERDLOVSK
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_tank_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_tank_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_tank_plant_3_tt
			hidden_effect = {
				SOV_upgrade_appropriate_tank_designer_3_effect = yes
			}
		}
	}


	######################
	### NAVAL DESIGNER ###
	######################

	SOV_merge_ship_plant_1_baltic = {
		priority = 24

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_baltic = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_dlc = "Man the Guns" #Coastal Defense Ships
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_1_baltic = no
			SOV_has_active_ship_designer_any_black_sea = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_baltic = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_1_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_1_baltic_effect = yes
			}
			set_technology = { coastal_defense_ships = 1 }
		}
	}

	SOV_merge_ship_plant_2_baltic = {
		priority = 23

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			has_completed_focus = SOV_surface_warfare
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_baltic = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_2_baltic = no
			NOT = { has_completed_focus = SOV_submarine_warfare }
			SOV_has_active_ship_designer_any_black_sea = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_baltic = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_2_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_2_baltic_effect = yes
			}
		}
	}

	SOV_merge_ship_plant_3_baltic = {
		priority = 22

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			has_completed_focus = SOV_submarine_warfare
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_baltic = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_3_baltic = no
			NOT = { has_completed_focus = SOV_surface_warfare }
			SOV_has_active_ship_designer_any_black_sea = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_baltic = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_3_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_3_baltic_effect = yes
			}
		}
	}

	SOV_merge_ship_plant_4_baltic = {
		priority = 21

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_baltic = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_4_baltic = no
			SOV_has_active_ship_designer_any_black_sea = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_baltic = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_4_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_4_baltic_effect = yes
			}
		}
	}

	SOV_merge_ship_plant_1_black_sea = {
		priority = 14

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 197 #MYKOLAIV
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_black_sea = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_dlc = "Man the Guns" #Coastal Defense Ships
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_1_black_sea = no
			SOV_has_active_ship_designer_any_baltic = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_black_sea = no
				NOT = { has_full_control_of_state = 197 } #MYKOLAIV
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_1_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_1_black_sea_effect = yes
			}
			set_technology = { coastal_defense_ships = 1 }
		}
	}

	SOV_merge_ship_plant_2_black_sea = {
		priority = 13

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 202 #KIEV
			has_completed_focus = SOV_surface_warfare
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_black_sea = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_2_black_sea = no
			NOT = { has_completed_focus = SOV_submarine_warfare }
			SOV_has_active_ship_designer_any_baltic = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_black_sea = no
				NOT = { has_full_control_of_state = 202 } #KIEV
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_2_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_2_black_sea_effect = yes
			}
		}
	}

	SOV_merge_ship_plant_3_black_sea = {
		priority = 12

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 227 #STALINO
			has_completed_focus = SOV_submarine_warfare
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_black_sea = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_3_black_sea = no
			NOT = { has_completed_focus = SOV_surface_warfare }
			SOV_has_active_ship_designer_any_baltic = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_black_sea = no
				NOT = { has_full_control_of_state = 227 } #STALINO
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_3_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_3_black_sea_effect = yes
			}
		}
	}

	SOV_merge_ship_plant_4_black_sea = {
		priority = 11

		icon = GFX_decision_generic_merge_plant_ship

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195 #LENINGRAD
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_ship_designer_any_black_sea = yes
			NOT = { has_country_flag = SOV_merge_ship_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_naval_plants
			SOV_has_ship_merged_4_black_sea = no
			SOV_has_active_ship_designer_any_baltic = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_ship_designer_any_black_sea = no
				NOT = { has_full_control_of_state = 195 } #LENINGRAD
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_ship_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_ship_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_ship_plant_4_tt
			hidden_effect = {
				SOV_upgrade_appropriate_ship_designer_4_black_sea_effect = yes
			}
		}
	}


	#########################
	### AIRCRAFT DESIGNER ###
	#########################
	SOV_merge_aircraft_plant_1 = {
		priority = 33

		icon = GFX_decision_generic_merge_plant_aircraft

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 251 #KUYBYSHEV
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_aircraft_designer_any = yes
			NOT = { has_country_flag = SOV_merge_aircraft_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_aircraft_plants
			SOV_has_aircraft_merged_1 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_aircraft_designer_any = no
				NOT = { has_full_control_of_state = 251 } #KUYBYSHEV
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_aircraft_plant_1_tt
			hidden_effect = {
				SOV_upgrade_appropriate_aircraft_designer_1_effect = yes
			}
		}
	}

	SOV_merge_aircraft_plant_2 = {
		priority = 32

		icon = GFX_decision_generic_merge_plant_aircraft

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 219 #MOSCOW
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_aircraft_designer_any = yes
			NOT = { has_country_flag = SOV_merge_aircraft_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_aircraft_plants
			SOV_has_aircraft_merged_2 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_aircraft_designer_any = no
				NOT = { has_full_control_of_state = 219 } #MOSCOW
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_aircraft_plant_2_tt
			hidden_effect = {
				SOV_upgrade_appropriate_aircraft_designer_2_effect = yes
			}

			add_resource = {
				type = aluminium
				amount = 3
				state = 219
			}
		}
	}

	SOV_merge_aircraft_plant_3 = {
		priority = 31

		icon = GFX_decision_generic_merge_plant_aircraft

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 808 #RIGA
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_aircraft_designer_any = yes
			NOT = { has_country_flag = SOV_merge_aircraft_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_aircraft_plants
			SOV_has_aircraft_merged_3 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_aircraft_designer_any = no
				NOT = { has_full_control_of_state = 808 } #RIGA
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_aircraft_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_aircraft_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_aircraft_plant_3_tt
			hidden_effect = {
				SOV_upgrade_appropriate_aircraft_designer_3_effect = yes
			}
		}
	}


	#########################
	### MATERIEL DESIGNER ###
	#########################
	SOV_merge_materiel_plant_1_artillery = {
		priority = 45

		icon = GFX_decision_generic_merge_plant_materiel

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 398 #PERM
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_materiel_designer_grabin = yes
			NOT = { has_country_flag = SOV_merge_materiel_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_materiel_merged_1_artillery = no
			SOV_has_active_materiel_designer_tula = no
			SOV_has_active_materiel_designer_gaz = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_materiel_designer_grabin = no
				NOT = { has_full_control_of_state = 398 } #PERM
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_materiel_plant_1_artillery_tt
			hidden_effect = {
				SOV_upgrade_appropriate_materiel_designer_1_artillery_effect = yes
			}
		}
	}

	SOV_merge_materiel_plant_1_infantry = {
		priority = 44

		icon = GFX_decision_generic_merge_plant_materiel

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 399 #IZHEVSK
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_materiel_designer_tula = yes
			NOT = { has_country_flag = SOV_merge_materiel_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_materiel_merged_1_infantry = no
			SOV_has_active_materiel_designer_grabin = no
			SOV_has_active_materiel_designer_gaz = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_materiel_designer_tula = no
				NOT = { has_full_control_of_state = 399 } #IZHEVSK
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_materiel_plant_1_infantry_tt
			hidden_effect = {
				SOV_upgrade_appropriate_materiel_designer_1_infantry_effect = yes
			}
		}
	}

	SOV_merge_materiel_plant_1_motorized = {
		priority = 43

		icon = GFX_decision_generic_merge_plant_materiel

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 252 #GORKY
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_materiel_designer_gaz = yes
			NOT = { has_country_flag = SOV_merge_materiel_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_materiel_merged_1_motorized = no
			SOV_has_active_materiel_designer_grabin = no
			SOV_has_active_materiel_designer_tula = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_materiel_designer_gaz = no
				NOT = { has_full_control_of_state = 252 } #GORKY
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_materiel_plant_1_motorized_tt
			hidden_effect = {
				SOV_upgrade_appropriate_materiel_designer_1_motorized_effect = yes
			}
		}
	}

	SOV_merge_materiel_plant_2 = {
		priority = 42

		icon = GFX_decision_generic_merge_plant_materiel

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 227 #STALINO
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_materiel_designer_any = yes
			NOT = { has_country_flag = SOV_merge_materiel_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_materiel_merged_2 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_materiel_designer_any = no
				NOT = { has_full_control_of_state = 227 } #STALINO
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_materiel_plant_2_tt
			hidden_effect = {
				SOV_upgrade_appropriate_materiel_designer_2_effect = yes
			}
		}
	}

	SOV_merge_materiel_plant_3 = {
		priority = 41

		icon = GFX_decision_generic_merge_plant_materiel

		ai_will_do = {
			base = 0.5
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 582 #MAGNITOGORSK
			num_of_civilian_factories_available_for_projects > 0
			SOV_has_active_materiel_designer_any = yes
			NOT = { has_country_flag = SOV_merge_materiel_decision_ongoing_flag }
		}

		visible = {
			has_completed_focus = SOV_merge_tank_and_materiel_plants
			SOV_has_materiel_merged_3 = no
		}

		cancel_trigger = {
			OR = {
				SOV_has_active_materiel_designer_any = no
				NOT = { has_full_control_of_state = 582 } #MAGNITOGORSK
			}
		}

		cancel_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		cost = SOV_merge_designers_cost

		days_remove = SOV_merge_designers_time

		modifier = {
			civilian_factory_use = 1
		}

		complete_effect = {
			set_country_flag = SOV_merge_materiel_decision_ongoing_flag
		}

		remove_effect = {
			clr_country_flag = SOV_merge_materiel_decision_ongoing_flag

			custom_effect_tooltip = SOV_merge_materiel_plant_3_tt
			hidden_effect = {
				SOV_upgrade_appropriate_materiel_designer_3_effect = yes
			}
		}
	}
}



   ###     ######     ###    ########  ######## ##     ## ##    ##     #######  ########     ######   ######  #### ######## ##    ##  ######  ########  ######  
  ## ##   ##    ##   ## ##   ##     ## ##       ###   ###  ##  ##     ##     ## ##          ##    ## ##    ##  ##  ##       ###   ## ##    ## ##       ##    ## 
 ##   ##  ##        ##   ##  ##     ## ##       #### ####   ####      ##     ## ##          ##       ##        ##  ##       ####  ## ##       ##       ##       
##     ## ##       ##     ## ##     ## ######   ## ### ##    ##       ##     ## ######       ######  ##        ##  ######   ## ## ## ##       ######    ######  
######### ##       ######### ##     ## ##       ##     ##    ##       ##     ## ##                ## ##        ##  ##       ##  #### ##       ##             ## 
##     ## ##    ## ##     ## ##     ## ##       ##     ##    ##       ##     ## ##          ##    ## ##    ##  ##  ##       ##   ### ##    ## ##       ##    ## 
##     ##  ######  ##     ## ########  ######## ##     ##    ##        #######  ##           ######   ######  #### ######## ##    ##  ######  ########  ######  


SOV_national_academy_of_sciences_dec_cat = {
	SOV_debug_FASTER_AND_FREE = {
		priority = 51

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			is_debug = yes
			has_completed_focus = SOV_national_academies_of_sciences
			NOT = {
				has_country_flag = SOV_debug_fast_national_academy_of_sicences_flag
			}
		}

		cost = 0

		complete_effect = {
			set_country_flag = SOV_debug_fast_national_academy_of_sicences_flag
			set_variable = { SOV_national_academy_of_sciences_construction_cost = 0 }
			set_variable = { SOV_national_academy_of_sciences_construction_time = 3 }
		}
	}

	SOV_debug_BACK_TO_REGULAR_STUFF = {
		priority = 51

		icon = eng_ally_imperialist_coup

		allowed = { 
			original_tag = SOV
		}

		available = {
			always = yes
		}

		visible = {
			is_debug = yes
			has_completed_focus = SOV_national_academies_of_sciences
			has_country_flag = SOV_debug_fast_national_academy_of_sicences_flag
		}

		cost = 0

		complete_effect = {
			clr_country_flag = SOV_debug_fast_national_academy_of_sicences_flag
			set_variable = { SOV_national_academy_of_sciences_construction_cost = 50 }
			set_variable = { SOV_national_academy_of_sciences_construction_time = 90 }
		}
	}

	SOV_build_national_academy_of_sciences_independent_republic = {
		priority = 2

		icon = GFX_decision_SOV_academy_of_sciences

		ai_will_do = { #Puppets get prio so that they receive bonus too
			base = 0.9
		}

		target_trigger = {
			FROM = {
				SOV_is_valid_academy_of_sciences_target = yes
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			has_completed_focus = SOV_national_academies_of_sciences
			country_exists = FROM
			FROM = {
				SOV_is_valid_academy_of_sciences_target = yes
			}
			SOV_has_already_built_national_academy_of_sciences = no
		}

		fire_only_once = yes

		cost = SOV_national_academy_of_sciences_construction_cost

		days_remove = SOV_national_academy_of_sciences_construction_time

		modifier = {
			civilian_factory_use = 4
		}

		remove_effect = {
			custom_effect_tooltip = SOV_build_national_academy_of_sciences_independent_republic_tt
			hidden_effect = {
				add_to_variable = { var = SOV_Army_research_speed value = 1 }
				SOV_political_instability_update_effect = yes
			}
			SOV_set_appropriate_national_academy_of_sciences_flag_effect = yes #Set Appropriate flag to avoid duplicates with the other set of decisions for non-existing countries
			FROM = {
				country_event = NSB_soviet_academy_of_sciences.1
				effect_tooltip = {
					add_ideas = SOV_national_academy_of_sciences_puppet
				}
			}
		}
	}

	SOV_build_national_academy_of_sciences_integrated_republic_BLR = {
		priority = 1

		icon = GFX_decision_SOV_academy_of_sciences

		ai_will_do = { #Integrated republics go after puppets
			base = 0.5
		}

		cosmetic_tag = BLR
		cosmetic_ideology = communism

		allowed = {
			original_tag = SOV
		}

		available = {
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			has_completed_focus = SOV_national_academies_of_sciences
			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_BLR_flag }
			NOT = { country_exists = BLR }
		}

		fire_only_once = yes

		cost = SOV_national_academy_of_sciences_construction_cost

		days_remove = SOV_national_academy_of_sciences_construction_time

		modifier = {
			civilian_factory_use = 4
		}

		remove_effect = {
			BLR = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
			set_country_flag = SOV_national_academy_of_sciences_built_BLR_flag
		}
	}

	SOV_build_national_academy_of_sciences_integrated_republic_UKR = {
		priority = 1

		icon = GFX_decision_SOV_academy_of_sciences

		ai_will_do = { #Integrated republics go after puppets
			base = 0.5
		}

		cosmetic_tag = UKR
		cosmetic_ideology = communism

		allowed = { 
			original_tag = SOV
		}

		available = {
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			has_completed_focus = SOV_national_academies_of_sciences
			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_UKR_flag }
			NOT = { country_exists = UKR }
		}

		fire_only_once = yes

		cost = SOV_national_academy_of_sciences_construction_cost

		days_remove = SOV_national_academy_of_sciences_construction_time

		modifier = {
			civilian_factory_use = 4
		}

		remove_effect = {
			UKR = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
			set_country_flag = SOV_national_academy_of_sciences_built_UKR_flag
		}
	}

	# SOV_build_national_academy_of_sciences_integrated_republic_GEO = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = GEO
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_GEO_flag }
	# 		NOT = { country_exists = GEO }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		GEO = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_GEO_flag
	# 	}
	# }

	# SOV_build_national_academy_of_sciences_integrated_republic_ARM = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = ARM
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_ARM_flag }
	# 		NOT = { country_exists = ARM }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		ARM = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_ARM_flag
	# 	}
	# }

	# SOV_build_national_academy_of_sciences_integrated_republic_AZR = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = AZR
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_AZR_flag }
	# 		NOT = { country_exists = AZR }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		AZR = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_AZR_flag
	# 	}
	# }
	
	# SOV_build_national_academy_of_sciences_integrated_republic_UZB = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = UZB
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_UZB_flag }
	# 		NOT = { country_exists = UZB }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		UZB = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_UZB_flag
	# 	}
	# }
	
	# SOV_build_national_academy_of_sciences_integrated_republic_TMS = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = TMS
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_TMS_flag }
	# 		NOT = { country_exists = TMS }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		TMS = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_TMS_flag
	# 	}
	# }
	
	# SOV_build_national_academy_of_sciences_integrated_republic_KYR = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = KYR
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_KYR_flag }
	# 		NOT = { country_exists = KYR }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		KYR = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_KYR_flag
	# 	}
	# }
	
	# SOV_build_national_academy_of_sciences_integrated_republic_TAJ = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = TAJ
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_TAJ_flag }
	# 		NOT = { country_exists = TAJ }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		TAJ = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_TAJ_flag
	# 	}
	# }
	
	#Not gonna have these unless they're released, just like with the others
#	SOV_build_national_academy_of_sciences_integrated_republic_DON = {
#		priority = 1
#
#		icon = GFX_decision_SOV_academy_of_sciences
#
#		ai_will_do = { #Integrated republics go after puppets
#			base = 0.5
#		}
#
#		cosmetic_tag = DON
#		cosmetic_ideology = communism
#
#		allowed = { 
#			original_tag = SOV
#		}
#
#		available = {
#			num_of_civilian_factories_available_for_projects > 0
#		}
#
#		visible = {
#			has_completed_focus = SOV_national_academies_of_sciences
#			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_DON_flag }
#			NOT = { country_exists = DON }
#		}
#
#		fire_only_once = yes
#
#		cost = SOV_national_academy_of_sciences_construction_cost
#
#		days_remove = SOV_national_academy_of_sciences_construction_time
#
#		modifier = {
#			civilian_factory_use = 4
#		}
#
#		remove_effect = {
#			DON = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
#			set_country_flag = SOV_national_academy_of_sciences_built_DON_flag
#		}
#	}
#	
#	SOV_build_national_academy_of_sciences_integrated_republic_KUB = {
#		priority = 1
#
#		icon = GFX_decision_SOV_academy_of_sciences
#
#		ai_will_do = { #Integrated republics go after puppets
#			base = 0.5
#		}
#
#		cosmetic_tag = KUB
#		cosmetic_ideology = communism
#
#		allowed = { 
#			original_tag = SOV
#		}
#
#		available = {
#			num_of_civilian_factories_available_for_projects > 0
#		}
#
#		visible = {
#			has_completed_focus = SOV_national_academies_of_sciences
#			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_KUB_flag }
#			NOT = { country_exists = KUB }
#		}
#
#		fire_only_once = yes
#
#		cost = SOV_national_academy_of_sciences_construction_cost
#
#		days_remove = SOV_national_academy_of_sciences_construction_time
#
#		modifier = {
#			civilian_factory_use = 4
#		}
#
#		remove_effect = {
#			KUB = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
#			set_country_flag = SOV_national_academy_of_sciences_built_KUB_flag
#		}
# #	}
	
# 	SOV_build_national_academy_of_sciences_integrated_republic_EST = {
# 		priority = 1

# 		icon = GFX_decision_SOV_academy_of_sciences

# 		ai_will_do = { #Integrated republics go after puppets
# 			base = 0.5
# 		}

# 		cosmetic_tag = EST
# 		cosmetic_ideology = communism

# 		allowed = { 
# 			original_tag = SOV
# 		}

# 		available = {
# 			num_of_civilian_factories_available_for_projects > 0
# 		}

# 		visible = {
# 			has_completed_focus = SOV_national_academies_of_sciences
# 			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_EST_flag }
# 			NOT = { country_exists = EST }
# 		}

# 		fire_only_once = yes

# 		cost = SOV_national_academy_of_sciences_construction_cost

# 		days_remove = SOV_national_academy_of_sciences_construction_time

# 		modifier = {
# 			civilian_factory_use = 4
# 		}

# 		remove_effect = {
# 			EST = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
# 			set_country_flag = SOV_national_academy_of_sciences_built_EST_flag
# 		}
# 	}

# 	SOV_build_national_academy_of_sciences_integrated_republic_LAT = {
# 		priority = 1

# 		icon = GFX_decision_SOV_academy_of_sciences

# 		ai_will_do = { #Integrated republics go after puppets
# 			base = 0.5
# 		}

# 		cosmetic_tag = LAT
# 		cosmetic_ideology = communism

# 		allowed = { 
# 			original_tag = SOV
# 		}

# 		available = {
# 			num_of_civilian_factories_available_for_projects > 0
# 		}

# 		visible = {
# 			has_completed_focus = SOV_national_academies_of_sciences
# 			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_LAT_flag }
# 			NOT = { country_exists = LAT }
# 		}

# 		fire_only_once = yes

# 		cost = SOV_national_academy_of_sciences_construction_cost

# 		days_remove = SOV_national_academy_of_sciences_construction_time

# 		modifier = {
# 			civilian_factory_use = 4
# 		}

# 		remove_effect = {
# 			LAT = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
# 			set_country_flag = SOV_national_academy_of_sciences_built_LAT_flag
# 		}
# 	}
	
# 	SOV_build_national_academy_of_sciences_integrated_republic_LIT = {
# 		priority = 1

# 		icon = GFX_decision_SOV_academy_of_sciences

# 		ai_will_do = { #Integrated republics go after puppets
# 			base = 0.5
# 		}

# 		cosmetic_tag = LIT
# 		cosmetic_ideology = communism

# 		allowed = { 
# 			original_tag = SOV
# 		}

# 		available = {
# 			num_of_civilian_factories_available_for_projects > 0
# 		}

# 		visible = {
# 			has_completed_focus = SOV_national_academies_of_sciences
# 			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_LIT_flag }
# 			NOT = { country_exists = LIT }
# 		}

# 		fire_only_once = yes

# 		cost = SOV_national_academy_of_sciences_construction_cost

# 		days_remove = SOV_national_academy_of_sciences_construction_time

# 		modifier = {
# 			civilian_factory_use = 4
# 		}

# 		remove_effect = {
# 			LIT = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
# 			set_country_flag = SOV_national_academy_of_sciences_built_LIT_flag
# 		}
# 	}
	
	SOV_build_national_academy_of_sciences_integrated_republic_POL = {
		priority = 1

		icon = GFX_decision_SOV_academy_of_sciences

		ai_will_do = { #Integrated republics go after puppets
			base = 0.5
		}

		cosmetic_tag = POL
		cosmetic_ideology = communism

		allowed = { 
			original_tag = SOV
		}

		available = {
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			has_completed_focus = SOV_national_academies_of_sciences
			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_POL_flag }
			NOT = { country_exists = POL }
		}

		fire_only_once = yes

		cost = SOV_national_academy_of_sciences_construction_cost

		days_remove = SOV_national_academy_of_sciences_construction_time

		modifier = {
			civilian_factory_use = 4
		}

		remove_effect = {
			POL = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
			set_country_flag = SOV_national_academy_of_sciences_built_POL_flag
		}
	}
	
	SOV_build_national_academy_of_sciences_integrated_republic_FIN = {
		priority = 1

		icon = GFX_decision_SOV_academy_of_sciences

		ai_will_do = { #Integrated republics go after puppets
			base = 0.5
		}

		cosmetic_tag = FIN
		cosmetic_ideology = communism

		allowed = { 
			original_tag = SOV
		}

		available = {
			num_of_civilian_factories_available_for_projects > 0
		}

		visible = {
			has_completed_focus = SOV_national_academies_of_sciences
			NOT = { has_country_flag = SOV_national_academy_of_sciences_built_FIN_flag }
			NOT = { country_exists = FIN }
		}

		fire_only_once = yes

		cost = SOV_national_academy_of_sciences_construction_cost

		days_remove = SOV_national_academy_of_sciences_construction_time

		modifier = {
			civilian_factory_use = 4
		}

		remove_effect = {
			FIN = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
			set_country_flag = SOV_national_academy_of_sciences_built_FIN_flag
		}
	}

	# SOV_build_national_academy_of_sciences_integrated_republic_TAN = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = TAN
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_TAN_flag }
	# 		NOT = { country_exists = TAN }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		TAN = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier
	# 		set_country_flag = SOV_national_academy_of_sciences_built_TAN_flag
	# 	}
	# }

	# SOV_build_national_academy_of_sciences_integrated_republic_MON = {
	# 	priority = 1

	# 	icon = GFX_decision_SOV_academy_of_sciences

	# 	ai_will_do = { #Integrated republics go after puppets
	# 		base = 0.5
	# 	}

	# 	cosmetic_tag = MON
	# 	cosmetic_ideology = communism

	# 	allowed = { 
	# 		original_tag = SOV
	# 	}

	# 	available = {
	# 		num_of_civilian_factories_available_for_projects > 0
	# 	}

	# 	visible = {
	# 		has_completed_focus = SOV_national_academies_of_sciences
	# 		NOT = { has_country_flag = SOV_national_academy_of_sciences_built_MON_flag }
	# 		NOT = { country_exists = MON }
	# 	}

	# 	fire_only_once = yes

	# 	cost = SOV_national_academy_of_sciences_construction_cost

	# 	days_remove = SOV_national_academy_of_sciences_construction_time

	# 	modifier = {
	# 		civilian_factory_use = 4
	# 	}

	# 	remove_effect = {
	# 		MON = { SOV_build_national_academy_of_sciences_effect = yes } #Tooltip + increase research speed in dynamic modifier // Done in this scope for tooltip reasons
	# 		set_country_flag = SOV_national_academy_of_sciences_built_MON_flag
	# 	}
	# }
}


##    ## #### ##       ##          ######## ########   #######  ########  ######  ##    ## ##    ##               ##    ##  #######     ##          ###    ########  
##   ##   ##  ##       ##             ##    ##     ## ##     ##    ##    ##    ## ##   ##   ##  ##                ###   ## ##     ##    ##         ## ##   ##     ## 
##  ##    ##  ##       ##             ##    ##     ## ##     ##    ##    ##       ##  ##     ####                 ####  ## ##     ##    ##        ##   ##  ##     ## 
#####     ##  ##       ##             ##    ########  ##     ##    ##     ######  #####       ##       #######    ## ## ## ##     ##    ##       ##     ## ########  
##  ##    ##  ##       ##             ##    ##   ##   ##     ##    ##          ## ##  ##      ##                  ##  #### ##     ##    ##       ######### ##   ##   
##   ##   ##  ##       ##             ##    ##    ##  ##     ##    ##    ##    ## ##   ##     ##                  ##   ### ##     ##    ##       ##     ## ##    ##  
##    ## #### ######## ########       ##    ##     ##  #######     ##     ######  ##    ##    ##                  ##    ##  #######     ######## ##     ## ##     ## 


SOV_kill_trotsky_dec_cat = {
	SOV_raid_trotskys_villa = {
		priority = 2

		icon = generic_prepare_civil_war

		ai_will_do = {
			base = 0
			modifier = {
				add = 50
				date > 1940.2.1 #Historical 24/05/1940
				NOT = { has_country_flag = SOV_raided_trotskys_villa_flag }
			}
		}

		target_trigger = {
			FROM = {
				owns_state = 277
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_equipment = { infantry_equipment > 49 }
			has_equipment = { support_equipment > 49 }
			NOT = { has_country_flag = SOV_attempting_to_kill_trotsky_flag }
		}

		visible = {
			has_completed_focus = SOV_behead_the_snake
			OR = {
				has_global_flag = trotsky_exile_mexico
				has_global_flag = flag_mexico_invited_trotsky_to_government
			}
			NOT = { has_global_flag = flag_trotsky_dead }
			NOT = { has_global_flag = flag_trotsky_has_returned_to_ussr_from_mexico }
		}

		cost = 75

		days_remove = 60

		modifier = {
			political_power_factor = -0.1
		}

		complete_effect = {
			set_country_flag = SOV_attempting_to_kill_trotsky_flag
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = -50
				producer = SOV
			}
			add_equipment_to_stockpile = {
				type = support_equipment
				amount = -50
				producer = SOV
			}
		}

		remove_effect = {
			hidden_effect = {
				clr_country_flag = SOV_attempting_to_kill_trotsky_flag
				set_country_flag = SOV_raided_trotskys_villa_flag
				random_list = {
					50 = {
						modifier = {
							factor = 2
							FROM = {
								communism > 0.5
							}
						}
						modifier = {
							factor = 5
							FROM = {
								is_in_faction_with = ROOT
							}
						}
						ROOT = { news_event = { id = nsb_news.100 } } #SUCCESS - Kill Trotsky and swap Trotskyite Plot NS
					}
					50 = {
						modifier = {
							factor = 0
							FROM = {
								is_subject_of = ROOT
							}
						}
						ROOT = { news_event = { id = nsb_news.101 } } #FAILURE - Trotsky still alive
					}
				}
			}
			custom_effect_tooltip = SOV_raid_trotskys_villa_tt
		}
	}
}


   ###    ########  #######  ##     ## ####  ######     ########  ########   #######        ## ########  ######  ######## 
  ## ##      ##    ##     ## ###   ###  ##  ##    ##    ##     ## ##     ## ##     ##       ## ##       ##    ##    ##    
 ##   ##     ##    ##     ## #### ####  ##  ##          ##     ## ##     ## ##     ##       ## ##       ##          ##    
##     ##    ##    ##     ## ## ### ##  ##  ##          ########  ########  ##     ##       ## ######   ##          ##    
#########    ##    ##     ## ##     ##  ##  ##          ##        ##   ##   ##     ## ##    ## ##       ##          ##    
##     ##    ##    ##     ## ##     ##  ##  ##    ##    ##        ##    ##  ##     ## ##    ## ##       ##    ##    ##    
##     ##    ##     #######  ##     ## ####  ######     ##        ##     ##  #######   ######  ########  ######     ##    


SOV_infiltrate_foreign_atomic_programs_dec_cat = {
	SOV_infiltrate_atomic_program = {
		priority = 1

		icon = GFX_decision_generic_political_discourse

		ai_will_do = {
			base = 0.2
			modifier = {
				factor = 20
				FROM = { original_tag = USA }
			}
			modifier = {
				factor = 0.5
				OR = {
					has_tech = nukes
					is_researching_technology = nukes
				}
			}
		}

		target_trigger = {
			FROM = {
				is_major = yes
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			NOT = { has_country_flag = SOV_nuclear_espionage_ongoing_flag }
			FROM = { has_tech = atomic_research }
		}

		visible = {
			has_completed_focus = SOV_kurnatovs_experiments
			FROM = {
				NOT = { has_country_flag = SOV_nuclear_espionage_flag }
				NOT = { has_war_with = ROOT }
			}
		}

		cost = 100

		days_remove = 90

		modifier = {
			political_power_factor = -0.1
		}

		complete_effect = {
			set_country_flag = SOV_nuclear_espionage_ongoing_flag
		}

		remove_effect = {
			hidden_effect = {
				clr_country_flag = SOV_nuclear_espionage_ongoing_flag
				FROM = { set_country_flag = SOV_nuclear_espionage_flag }
				random_list = {
					50 = {
						modifier = {
							factor = 1.5
							FROM = {
								communism > 0.15
							}
						}
						modifier = {
							factor = 1.5
							FROM = {
								communism > 0.25
							}
						}
						modifier = {
							factor = 2
							FROM = {
								communism > 0.5
							}
						}
						ROOT = { country_event = NSB_soviet_atomic_bomb_project.1 } #SUCCESS - Get the bonus
					}
					50 = {
						ROOT = {
							country_event = NSB_soviet_atomic_bomb_project.2  #FAILURE - Get some penalties
							set_variable = { SOV_aggrieved_country_atomic_spies = FROM }
						}
						FROM = {
							country_event = NSB_soviet_atomic_bomb_project.3
						}
					}
				}
			}
			custom_effect_tooltip = SOV_infiltrate_atomic_program_tt
		}
	}
}




 ######   ########  ########    ###    ########    ########     ###    ######## ########  ####  #######  ######## ####  ######     ##      ##    ###    ########  
##    ##  ##     ## ##         ## ##      ##       ##     ##   ## ##      ##    ##     ##  ##  ##     ##    ##     ##  ##    ##    ##  ##  ##   ## ##   ##     ## 
##        ##     ## ##        ##   ##     ##       ##     ##  ##   ##     ##    ##     ##  ##  ##     ##    ##     ##  ##          ##  ##  ##  ##   ##  ##     ## 
##   #### ########  ######   ##     ##    ##       ########  ##     ##    ##    ########   ##  ##     ##    ##     ##  ##          ##  ##  ## ##     ## ########  
##    ##  ##   ##   ##       #########    ##       ##        #########    ##    ##   ##    ##  ##     ##    ##     ##  ##          ##  ##  ## ######### ##   ##   
##    ##  ##    ##  ##       ##     ##    ##       ##        ##     ##    ##    ##    ##   ##  ##     ##    ##     ##  ##    ##    ##  ##  ## ##     ## ##    ##  
######    ##     ## ######## ##     ##    ##       ##        ##     ##    ##    ##     ## ####  #######     ##    ####  ######      ###  ###  ##     ## ##     ## 




SOV_great_patriotic_war = {

	SOV_raise_penal_units = {
		priority = 21

		icon = GFX_decision_generic_arrest

		ai_will_do = {
			base = 5
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			has_country_flag = { flag = SOV_penal_units_raised_flag days > 365 }
			custom_trigger_tooltip = {
				tooltip = SOV_raise_penal_units_days_tt
				has_country_flag = {
					flag = SOV_penal_units_raised_flag
					days > 365
				}
			}
			 
		}

		visible = {
			has_completed_focus = SOV_penal_battalions
			 
		}

		cost = 50

		days_remove = 35

		complete_effect = {
		}

		remove_effect = {
			clr_country_flag = SOV_penal_units_raised_flag
			SOV_spawn_penal_divisions_effect = yes
		}
	}

	SOV_factory_worker_militias = {
		priority = 20

		icon = generic_prepare_civil_war

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 15
				FROM = {
					OR = {
						state = 219 #MOSCOW
						state = 195 #LENINGRAD
						state = 217 #STALINGRAD
						state = 137 #SEVASTOPOL
						state = 206 #MINSK
						state = 202 #KIEV
					}
				}
			}
		}

		state_target = yes

		target_trigger = {
			FROM = {
				is_core_of = ROOT
				OR = {
					industrial_complex > 0
					arms_factory > 0
					dockyard > 0
				}
			}
		}

		target_root_trigger = {
			has_completed_focus = SOV_emergency_powers
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			FROM = {
				NOT = { has_dynamic_modifier = { modifier = SOV_civilian_labor_in_defense } }
			}
		}

		visible = {
			 
			NOT = { has_country_flag = SOV_order_227_flag }			
			FROM = {
				is_controlled_by = ROOT
				any_neighbor_state = {
					controller = { has_war_with = ROOT }
				}
			}
		}



		days_remove = 90

		cancel_if_not_visible = yes

		cancel_effect = {
			FROM = {
				remove_dynamic_modifier = { modifier = SOV_factory_worker_militias_raised }
			}
		}

		complete_effect = {
			hidden_effect = {
				FROM = {
					add_dynamic_modifier = {
						modifier = SOV_factory_worker_militias_raised
						scope = SOV
					}
				}
			}
			custom_effect_tooltip = SOV_factory_worker_militias_state_modifier_tt
		}

		remove_effect = {
			FROM = {
				remove_dynamic_modifier = { modifier = SOV_factory_worker_militias_raised }
			}
		}
	}

	SOV_civilian_labor_in_defense = {
		priority = 10

		icon = POL_organize_strike_two

		state_target = yes

		target_trigger = {
			FROM = {
				is_core_of = ROOT
				OR = {
					has_state_category = city
					has_state_category = large_city
					has_state_category = megalopolis
					has_state_category = metropolis
				}
			}
		}

		ai_will_do = {
			base = 0.1
			modifier = {
				factor = 15
				FROM = {
					OR = {
						state = 219 #MOSCOW
						state = 195 #LENINGRAD
						state = 217 #STALINGRAD
						state = 137 #SEVASTOPOL
						state = 206 #MINSK
						state = 202 #KIEV
					}
				}
			}
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			FROM = {
				NOT = { has_dynamic_modifier = { modifier = SOV_factory_worker_militias_raised } }
			}
		}

		visible = {
			has_completed_focus = SOV_emergency_powers
			 
			NOT = { has_country_flag = SOV_order_227_flag }
			FROM = {
				is_controlled_by = ROOT
				any_neighbor_state = {
					controller = { has_war_with = ROOT }
				}
			}
		}



		days_remove = 90

		cancel_if_not_visible = yes

		cancel_trigger = {
			FROM = {
				OR = {
					NOT = { is_controlled_by = ROOT }
					NOT = {
						any_neighbor_state = {
							controller = { has_war_with = ROOT }
						}
					}
				}
			}
		}

		cancel_effect = {
			FROM = {
				remove_dynamic_modifier = { modifier = SOV_civilian_labor_in_defense }
			}
		}

		complete_effect = {
			hidden_effect = {
				FROM = {
					add_dynamic_modifier = {
						modifier = SOV_civilian_labor_in_defense
						scope = SOV
					}
				}
			}
			custom_effect_tooltip = SOV_civilian_labor_in_defense_state_modifier_tt
		}

		remove_effect = {
			FROM = {
				remove_dynamic_modifier = { modifier = SOV_civilian_labor_in_defense }
			}
		}
	}

	SOV_staggered_retreat = {
		priority = 31

		icon = GFX_decision_generic_military

		ai_will_do = {
			base = 0.5
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			surrender_progress > 0.05
		}

		visible = {
			has_completed_focus = SOV_emergency_powers
			 
			NOT = { has_country_flag = SOV_order_227_flag }
		}



		days_remove = 90

		cancel_trigger = {
			surrender_progress < 0.05
		}

		modifier = {
			army_speed_factor = -0.1
			army_defence_factor = 0.05
			org_loss_when_moving = -0.1
		}
	}
	
	SOV_order_227 = {

		icon = generic_army_support

		available = {
			has_war = yes
			any_enemy_country = {
				is_major = yes
			}
			has_civil_war = no
			NOT = { has_war_with = STA }
			NOT = { has_idea = order_227 }
			OR = {
				NOT = { controls_state = 219 }
				NOT = { controls_state = 217 }
				AND = {
					NOT = { has_full_control_of_state = 237 }
					218 = { CONTROLLER = { has_war_with = SOV } }
					NOT = { has_full_control_of_state = 235 }
					218 = { CONTROLLER = { has_war_with = SOV } }
					NOT = { has_full_control_of_state = 233 }
					218 = { CONTROLLER = { has_war_with = SOV } }
					NOT = { has_full_control_of_state = 231 }
					218 = { CONTROLLER = { has_war_with = SOV } }
				}
				date > 1942.7.28
			}
		}

		cost = 50

		visible = {
			has_war = yes
			any_enemy_country = {
				is_major = yes
			}
			NOT = { has_idea = order_227 }
		}

		complete_effect = {
			add_ideas = order_227
			if = {
				limit = {
					NOT = { has_country_flag = SOV_army_reform_2 }
				}
				set_country_flag = SOV_army_reform_2
				add_to_variable = { SOV_the_red_army_army_org_factor = 0.1 }
				add_to_variable = { SOV_the_red_army_experience_gain_army_factor = 0.1 }
				custom_effect_tooltip = SOV_army_reform_2_tt
			}
		}

		ai_will_do = {
			factor = 4000
		}
	}

	SOV_cancel_order_227 = {

		icon = generic_army_support

		available = {
			has_idea = order_227
		}

		cost = 25

		visible = {
			has_idea = order_227
		}

		complete_effect = {
			remove_ideas = order_227
		}

		ai_will_do = {
			factor = 50

			modifier = {
				factor = 0
				surrender_progress > 0.02
			}
		}
	}

	SOV_peoples_militia_leningrad = {

		icon = category_generic_communism

		available = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
			195 = { is_controlled_by = SOV }
		}

		cost = 40
		days_remove = -1
		fire_only_once = yes
		visible = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
		}

		complete_effect = {
			custom_effect_tooltip = SOV_peoples_militias
			add_war_support = 0.05
			195 = {
				create_unit = {
					division = "division_template = \"Narodnoe Opolcheniye Divisíon\" start_experience_factor = 0.1 start_equipment_factor = 1.0"
					owner = SOV
					count = 12
				}
			}
		}

		ai_will_do = {
			factor = 100
		}
	}

	SOV_peoples_militia_moscow = {

		icon = category_generic_communism

		available = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
			219 = { is_controlled_by = SOV }
		}

		cost = 40
		days_remove = -1
		fire_only_once = yes
		visible = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
		}

		complete_effect = {
			add_war_support = 0.05
			219 = {
				create_unit = {
					division = "division_template = \"Narodnoe Opolcheniye Divisíon\" start_experience_factor = 0.1 start_equipment_factor = 1.0"
					owner = SOV
					count = 12
				}
			}
			custom_effect_tooltip = SOV_peoples_militias
		}

		ai_will_do = {
			factor = 100
		}
	}

	SOV_peoples_militia_stalingrad = {

		icon = category_generic_communism

		available = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
			217 = { is_controlled_by = SOV }
		}

		cost = 40
		days_remove = -1
		fire_only_once = yes
		visible = {
			has_war = yes
			has_completed_focus = SOV_peoples_militia
		}

		complete_effect = {
			add_war_support = 0.05
			217 = {
				create_unit = {
					division = "division_template = \"Narodnoe Opolcheniye Divisíon\" start_experience_factor = 0.1 start_equipment_factor = 1.0"
					owner = SOV
					count = 12
				}
			}
			custom_effect_tooltip = SOV_peoples_militias
		}

		ai_will_do = {
			factor = 100
		}
	}

	#217 "Stalingrad"
	SOV_hold_stalingrad = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 217 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			OR = {
				NOT = {	SOV = { has_full_control_of_state = 218 }}
				NOT = {	SOV = { has_full_control_of_state = 228 }}
				NOT = {	SOV = { has_full_control_of_state = 260 }}
				NOT = {	SOV = { has_full_control_of_state = 238 }}
				NOT = {	SOV = { has_full_control_of_state = 237 }}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			217 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.1
		}
		#Fail
		complete_effect = {
			217 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.2
			add_stability = -0.05
		}
	}
	
	#195 "Leningrad"
	SOV_hold_leningrad = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 195 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			OR = {
				AND = {
					NOT = {	SOV = { has_full_control_of_state = 191 }}
					191 = { is_owned_by = SOV }
				}
				NOT = {	SOV = { has_full_control_of_state = 209 }}
				NOT = {	SOV = { has_full_control_of_state = 263 }}
			}	
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			195 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.3
		}
		#Fail
		complete_effect = {
			195 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.4
			add_stability = -0.05
		}
	}

	#219 "Moscow"
	SOV_hold_moscow = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 219 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			OR = {
				NOT = {	SOV = { has_full_control_of_state = 242 }}
				NOT = {	SOV = { has_full_control_of_state = 246 }}
				NOT = {	SOV = { has_full_control_of_state = 205 }}
				NOT = {	SOV = { has_full_control_of_state = 222 }}
				NOT = {	SOV = { has_full_control_of_state = 258 }}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			219 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.5
		}
		#Fail
		complete_effect = {
			219 = { save_event_target_as = state }
			country_event = wtt_soviet_hold_city.6
			add_stability = -0.05
		}
	}

	#206 "Minsk"
	SOV_hold_minsk = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 206 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			97 = { is_owned_by = SOV }
			OR = {
				NOT = {	SOV = { has_full_control_of_state = 95 }}
				NOT = {	SOV = { has_full_control_of_state = 94 }}
				NOT = {	SOV = { has_full_control_of_state = 784 }}
				NOT = {	SOV = { has_full_control_of_state = 194 }}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			206 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.7
		}
		#Fail
		complete_effect = {
			206 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.8
			add_stability = -0.05
		}
	}

	#202 "Kiev"
	SOV_hold_kiev = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 202 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			OR = {
				NOT = {	SOV = { has_full_control_of_state = 192 }}
				NOT = {	SOV = { has_full_control_of_state = 198 }}
				NOT = {	SOV = { has_full_control_of_state = 199 }}
				NOT = {	SOV = { has_full_control_of_state = 194 }}
				NOT = {	SOV = { has_full_control_of_state = 201 }}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			202 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.9
		}
		#Fail
		complete_effect = {
			202 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.10
			add_stability = -0.05
		}
	}

	#137 "Sevastapol"
	SOV_hold_sevastapol = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			NOT = { controls_state = 137 }
		}

		days_mission_timeout = 180

		fire_only_once = yes

		is_good = yes

		activation = {
			has_war = yes
			has_civil_war = no
			NOT = { has_war_with = STA }
			any_enemy_country = {
				is_major = yes
			}
			OR = {
				NOT = {	SOV = { has_full_control_of_state = 197 }}
				NOT = {	SOV = { has_full_control_of_state = 203 }}
				NOT = {	SOV = { has_full_control_of_state = 196 }}
				NOT = {	SOV = { has_full_control_of_state = 259 }}
			}
		}

		#Success
		timeout_effect = {
			add_stability = 0.05
			add_war_support = 0.05
			137 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.11
		}
		#Fail
		complete_effect = {
			137 = { save_event_target_as = state }			
			country_event = wtt_soviet_hold_city.12
			add_stability = -0.05
		}
	}

	SOV_military_offensive_ongoing = {

		icon = hol_draw_up_staff_plans

		allowed = {
			original_tag = SOV
		}

		fire_only_once = yes

		days_mission_timeout = 30

		is_good = no

		activation = {
			always = no
		}

		cancel_trigger = {
			hidden_trigger = {
				has_war = no
			}
		}

		cancel_effect = {
			#log = "Mission cancelled"
			hidden_effect = {
				SOV_clean_military_offensive_effect = yes
			}
		}

		visible = {
			has_country_flag = SOV_order_227_flag
			has_war = yes
			has_country_flag = SOV_military_offensive_in_progress_flag
		}

		available = { #Conditions to succeed in the offensive
			custom_trigger_tooltip = {
				tooltip = SOV_military_offensive_ongoing_trigger_tt
				all_of_scopes = {
					array = SOV_military_offensive_states
					is_controlled_by = ROOT
				}
			}
		}

		timeout_effect = { #FAIL
			#log = "Var = [?SOV_offensive_main_objective.GetName] // Array = [?SOV_military_offensive_states^0.GetName]" #Debug		
			if = {
				limit = {
					var:SOV_offensive_main_objective = {
						is_controlled_by = ROOT
					}
				}
				custom_effect_tooltip = SOV_military_offensive_ongoing_holding_main_objective_tt
			}
			else = {
				custom_effect_tooltip = SOV_military_offensive_ongoing_not_holding_main_objective_tt
				hidden_effect = {
					add_war_support = -0.1
					add_political_power = -75
				}
			}

			custom_effect_tooltip = SOV_military_offensive_ongoing_failing_main_objective_tt
			effect_tooltip = {
				add_war_support = -0.1
				add_political_power = -75
			}

			SOV_clean_military_offensive_effect = yes	
		}

		complete_effect = { #SUCCESS
			SOV_clean_military_offensive_effect = yes

			add_war_support = 0.1
			add_political_power = 50
		}
	}

	SOV_military_offensive = {
		priority = 30

		icon = GFX_decision_generic_operation

		ai_will_do = {
			base = 0.5
		}

		state_target = yes
		
		target_trigger = {
			FROM = {
				SOV_is_military_offensive_main_objective = yes
			}
		}

		target_root_trigger = {
			has_war = yes
			has_country_flag = SOV_order_227_flag
		}

		on_map_mode = map_and_decisions_view

		allowed = { 
			original_tag = SOV
		}

		available = {
			NOT = { has_country_flag = SOV_military_offensive_in_progress_flag }
			command_power > 49
		}

		visible = {
			 FROM = {
			 	owner = {
			 		has_war_with = ROOT
			 	} 
			 	any_neighbor_state = {
			 		is_controlled_by = ROOT
			 	}
			 }
		}

		cancel_if_not_visible = yes

		cancel_effect = {
			#log = "Preparations cancelled"
			hidden_effect = {
				SOV_clean_military_offensive_effect = yes
			}
		}

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 14
		}
		custom_cost_text = decision_cost_CP_50_pp_15

		days_remove = 14

		modifier = {
			command_power_gain_mult = -0.5
		}

		complete_effect = {
			set_country_flag = SOV_military_offensive_in_progress_flag
		}

		remove_effect = {
			custom_effect_tooltip = SOV_military_offensive_scope_tt
			custom_effect_tooltip = SOV_military_offensive_current_scope_main_objective_tt
			effect_tooltip = {
				FROM = { #RZHEV
					custom_effect_tooltip = SOV_military_offensive_current_scope_negihbors_tt
					every_neighbor_state = { #NEIGHBOR STATES
						limit = {
							controller = { has_war_with = ROOT }
						}
					}
				}
			}
			
			hidden_effect = {
				set_variable = { SOV_offensive_main_objective = FROM } #This variable exists because trying to scope to the element 0 of an array causes an error :D (!)
				FROM = {
					ROOT = { add_to_array = { SOV_military_offensive_states = PREV } }
					every_neighbor_state = { #NEIGHBOR STATES
						limit = {
							controller = { has_war_with = ROOT }
						}
						ROOT = { add_to_array = { SOV_military_offensive_states = PREV } }
					}
				}
				SOV_set_military_offensive_effect = yes

				activate_mission = SOV_military_offensive_ongoing
			}
			custom_effect_tooltip = SOV_military_offensive_activate_decision_tt
		}
	}

	SOV_operation_iskra_ongoing = {

		icon = hol_draw_up_staff_plans

		allowed = {
			original_tag = SOV
		}

		fire_only_once = yes

		days_mission_timeout = 30

		is_good = no

		activation = {
			always = no
		}

		cancel_trigger = {
			hidden_trigger = {
				has_war = no
			}
		}

		cancel_effect = {
			hidden_effect = {
				SOV_clean_military_offensive_effect = yes
			}
		}

		visible = {
			has_country_flag = SOV_order_227_flag
			has_war = yes
			has_country_flag = SOV_military_offensive_in_progress_flag
		}

		available = { #You succeed by having Leningrad being connected to the rest of the country at the end of the mission
			custom_trigger_tooltip = {
				tooltip = SOV_operation_iskra_ongoing_objective_tt
				195 = { is_in_home_area = yes }
			}
		}

		timeout_effect = {  #FAIL
			custom_effect_tooltip = SOV_operation_iskra_ongoing_success_effects_tt
			effect_tooltip = {
				add_war_support = 0.1
				add_political_power = 50
			}
			custom_effect_tooltip = SOV_operation_iskra_ongoing_failure_effects_tt
			effect_tooltip = {
				add_war_support = -0.1
				add_political_power = -75
			}
			
			if = {
				limit = {
					195 = { is_in_home_area = yes }
				}
				custom_effect_tooltip = SOV_operation_iskra_ongoing_success_tt
				hidden_effect = {
					add_war_support = 0.1
					add_political_power = 50
				}
			}
			else = {
				custom_effect_tooltip = SOV_operation_iskra_ongoing_failure_tt
				hidden_effect = {
					add_war_support = -0.1
					add_political_power = -75
				}
			}
			SOV_clean_military_offensive_effect = yes
		}

		complete_effect = {
			SOV_clean_military_offensive_effect = yes
		}
	}

	SOV_operation_iskra = { #SPECIAL OFFENSIVE - LENINGRAD HAS NOT FALLEN BUT IT IS SURROUNDED
		priority = 30

		icon = GFX_decision_generic_operation

		ai_will_do = {
			base = 1
		}
		
		highlight_states = {
			highlight_state_targets = {
				state = 208 #LUGA
				state = 244 #VOLKHOV
			}	
		}

		on_map_mode = map_and_decisions_view

		allowed = { 
			original_tag = SOV
		}

		available = {
			NOT = { has_country_flag = SOV_military_offensive_in_progress_flag }
			command_power > 49
			OR = {
				controls_state = 263 #NOVGOROD
				controls_state = 264 #TIKHVIN
			}
		}

		visible = {
			has_war = yes
			has_country_flag = SOV_order_227_flag
			244 = {
				controller = { has_war_with = ROOT }
			}
			208 = {
				controller = { has_war_with = ROOT }
			}
			195 = { is_controlled_by = ROOT }
		}

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 14
		}
		custom_cost_text = decision_cost_CP_50_pp_15

		fire_only_once = yes

		days_remove = 14

		modifier = {
			command_power_gain_mult = -0.5
		}

		complete_effect = {
			set_country_flag = SOV_military_offensive_in_progress_flag
		}

		remove_effect = {
			custom_effect_tooltip = SOV_operation_iskra_tt	
			hidden_effect = {
				195 = {
					ROOT = { add_to_array = { SOV_military_offensive_states = PREV } }
				}					
				208 = {
					ROOT = { add_to_array = { SOV_military_offensive_states = PREV } }
				}
				244 = {
					ROOT = { add_to_array = { SOV_military_offensive_states = PREV } }
				}
				SOV_set_military_offensive_effect = yes

				activate_mission = SOV_operation_iskra_ongoing
			}
			custom_effect_tooltip = SOV_operation_iskra_activate_decision_tt
		}
	}

	SOV_the_rush_for_berlin = {
		priority = 100

		icon = GFX_decision_generic_nationalism

		ai_will_do = {
			base = 1
		}

		allowed = { 
			original_tag = SOV
		}

		available = {
			any_controlled_state = {
				is_core_of = GER
				NOT = { state = 763 }
				NOT = { state = 5 }
				NOT = { state = 85 }
			}
			any_other_country = {
				is_major = yes
				NOT = { is_in_faction_with = ROOT }
				has_war_with = GER
				any_controlled_state = {
					is_core_of = GER
				}
			}
			has_completed_focus = SOV_lessons_of_war
			has_country_flag = SOV_great_patriotic_war_flag
		}

		visible = {
			has_war_with = GER
			any_controlled_state = {
				is_core_of = GER
			}
			any_other_country = {
				is_major = yes
				NOT = { is_in_faction_with = ROOT }
				has_war_with = GER
			}
		}

		fire_only_once = yes

		custom_cost_trigger = {
			command_power > 49
			has_political_power > 49
		}
		custom_cost_text = decision_cost_CP_50_pp_50

		complete_effect = {
			add_timed_idea = {
				idea = SOV_the_rush_for_berlin
				days = 365
			}
		}
	}
}

economy_decisions = {
	western_ukraine_transformation = {

		icon = hol_draw_up_staff_plans

		highlight_states = { 
			SOV_transform_western_ukraine = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 201
			has_full_control_of_state = 202
			has_full_control_of_state = 198
			has_full_control_of_state = 203
			has_full_control_of_state = 192
			has_full_control_of_state = 197
			has_full_control_of_state = 196
			has_full_control_of_state = 137
			num_of_civilian_factories_available_for_projects > 17
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 201
				has_full_control_of_state = 202
				has_full_control_of_state = 198
				has_full_control_of_state = 203
				has_full_control_of_state = 192
				has_full_control_of_state = 197
				has_full_control_of_state = 196
				has_full_control_of_state = 137
			}
		}

		ai_will_do = {
			factor = 100

			modifier = {
				factor = 0
				
				date < 1942.12.1
			}
		}

		cost = 25
		days_remove = 270
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 18
		}

		remove_effect = {
			economy_fatigue_level_up_2 = yes
			201 = {
				add_extra_state_shared_building_slots = 2
			}
			202 = {
				add_extra_state_shared_building_slots = 2
			}
			198 = {
				add_extra_state_shared_building_slots = 2
			}
			203 = {
				add_extra_state_shared_building_slots = 2
			}
			192 = {
				add_extra_state_shared_building_slots = 2
			}
			197 = {
				add_extra_state_shared_building_slots = 2
			}
			196 = {
				add_extra_state_shared_building_slots = 2
			}
			137 = {
				add_extra_state_shared_building_slots = 2
			}
			hidden_effect = {
				set_country_flag = western_ukraine_transformed
			}
		}
	}
	western_ukraine_agricultural_construction = {

		icon = generic_industry

		highlight_states = { 
			SOV_transform_western_ukraine = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 201
			has_full_control_of_state = 202
			has_full_control_of_state = 198
			has_full_control_of_state = 203
			has_full_control_of_state = 192
			has_full_control_of_state = 197
			has_full_control_of_state = 196
			has_full_control_of_state = 137
			num_of_civilian_factories_available_for_projects > 26
			has_country_flag = western_ukraine_transformed
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 201
				has_full_control_of_state = 202
				has_full_control_of_state = 198
				has_full_control_of_state = 203
				has_full_control_of_state = 192
				has_full_control_of_state = 197
				has_full_control_of_state = 196
				has_full_control_of_state = 137
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 0
		days_remove = 30
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 30
		}

		remove_effect = {
			economy_fatigue_level_up_4 = yes
			201 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			202 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			198 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			203 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			192 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			197 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			196 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			137 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	eastern_ukraine_transformation = {

		icon = hol_draw_up_staff_plans

		highlight_states = { 
			SOV_transform_eastern_ukraine = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 193
			has_full_control_of_state = 225
			has_full_control_of_state = 259
			has_full_control_of_state = 221
			has_full_control_of_state = 226
			has_full_control_of_state = 200
			has_full_control_of_state = 227
			num_of_civilian_factories_available_for_projects > 14
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 193
				has_full_control_of_state = 225
				has_full_control_of_state = 259
				has_full_control_of_state = 221
				has_full_control_of_state = 226
				has_full_control_of_state = 200
				has_full_control_of_state = 227
			}
		}

		ai_will_do = {
			factor = 100

			modifier = {
				factor = 0
				
				date < 1942.12.1
			}
		}

		cost = 25
		days_remove = 270
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 15
		}

		remove_effect = {
			economy_fatigue_level_up_2 = yes
			193 = {
				add_extra_state_shared_building_slots = 2
			}
			225 = {
				add_extra_state_shared_building_slots = 2
			}
			259 = {
				add_extra_state_shared_building_slots = 2
			}
			221 = {
				add_extra_state_shared_building_slots = 2
			}
			226 = {
				add_extra_state_shared_building_slots = 2
			}
			200 = {
				add_extra_state_shared_building_slots = 2
			}
			227 = {
				add_extra_state_shared_building_slots = 2
			}
			hidden_effect = {
				set_country_flag = eastern_ukraine_transformed
			}
		}
	}
	eastern_ukraine_agricultural_construction = {

		icon = generic_industry

		highlight_states = { 
			SOV_transform_eastern_ukraine = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 193
			has_full_control_of_state = 225
			has_full_control_of_state = 259
			has_full_control_of_state = 221
			has_full_control_of_state = 226
			has_full_control_of_state = 200
			has_full_control_of_state = 227
			num_of_civilian_factories_available_for_projects > 24
			has_country_flag = eastern_ukraine_transformed
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 193
				has_full_control_of_state = 225
				has_full_control_of_state = 259
				has_full_control_of_state = 221
				has_full_control_of_state = 226
				has_full_control_of_state = 200
				has_full_control_of_state = 227
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 0
		days_remove = 30
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 25
		}

		remove_effect = {
			economy_fatigue_level_up_4 = yes
			193 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			225 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			259 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			221 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			226 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			200 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			227 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	western_forest_steppe_transformation = {

		icon = hol_draw_up_staff_plans

		highlight_states = { 
			SOV_transform_western_forest_steppe = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 254
			has_full_control_of_state = 258
			has_full_control_of_state = 239
			has_full_control_of_state = 260
			has_full_control_of_state = 265
			has_full_control_of_state = 217
			num_of_civilian_factories_available_for_projects > 9
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 254
				has_full_control_of_state = 258
				has_full_control_of_state = 239
				has_full_control_of_state = 260
				has_full_control_of_state = 265
				has_full_control_of_state = 217
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 25
		days_remove = 270
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 10
		}

		remove_effect = {
			economy_fatigue_level_up_2 = yes
			254 = {
				add_extra_state_shared_building_slots = 2
			}
			258 = {
				add_extra_state_shared_building_slots = 2
			}
			239 = {
				add_extra_state_shared_building_slots = 2
			}
			260 = {
				add_extra_state_shared_building_slots = 2
			}
			265 = {
				add_extra_state_shared_building_slots = 2
			}
			217 = {
				add_extra_state_shared_building_slots = 2
			}
			hidden_effect = {
				set_country_flag = western_forest_steppe_transformed
			}
		}
	}
	western_forest_steppe_agricultural_construction = {

		icon = generic_industry

		highlight_states = { 
			SOV_transform_western_forest_steppe = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 254
			has_full_control_of_state = 258
			has_full_control_of_state = 239
			has_full_control_of_state = 260
			has_full_control_of_state = 265
			has_full_control_of_state = 217
			num_of_civilian_factories_available_for_projects > 13
			has_country_flag = western_forest_steppe_transformed
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 254
				has_full_control_of_state = 258
				has_full_control_of_state = 239
				has_full_control_of_state = 260
				has_full_control_of_state = 265
				has_full_control_of_state = 217
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 0
		days_remove = 30
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 15
		}

		remove_effect = {
			economy_fatigue_level_up_4 = yes
			254 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			258 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			239 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			260 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			265 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			217 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	eastern_forest_steppe_transformation = {

		icon = hol_draw_up_staff_plans

		highlight_states = { 
			SOV_transform_eastern_forest_steppe = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 249
			has_full_control_of_state = 651
			has_full_control_of_state = 251
			has_full_control_of_state = 652
			has_full_control_of_state = 401
			num_of_civilian_factories_available_for_projects > 9
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 249
				has_full_control_of_state = 651
				has_full_control_of_state = 251
				has_full_control_of_state = 652
				has_full_control_of_state = 401
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 25
		days_remove = 270
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 10
		}

		remove_effect = {
			economy_fatigue_level_up_2 = yes
			249 = {
				add_extra_state_shared_building_slots = 2
			}
			651 = {
				add_extra_state_shared_building_slots = 2
			}
			251 = {
				add_extra_state_shared_building_slots = 2
			}
			652 = {
				add_extra_state_shared_building_slots = 2
			}
			401 = {
				add_extra_state_shared_building_slots = 2
			}
			hidden_effect = {
				set_country_flag = eastern_forest_steppe_transformed
			}
		}
	}
	eastern_forest_steppe_agricultural_construction = {

		icon = generic_industry

		highlight_states = { 
			SOV_transform_eastern_forest_steppe = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 249
			has_full_control_of_state = 651
			has_full_control_of_state = 251
			has_full_control_of_state = 652
			has_full_control_of_state = 401
			num_of_civilian_factories_available_for_projects > 14
			has_country_flag = eastern_forest_steppe_transformed
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 249
				has_full_control_of_state = 651
				has_full_control_of_state = 251
				has_full_control_of_state = 652
				has_full_control_of_state = 401
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 0
		days_remove = 30
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 15
		}

		remove_effect = {
			economy_fatigue_level_up_4 = yes
			249 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			651 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			251 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			652 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			401 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
	kuban_transformation = {

		icon = hol_draw_up_staff_plans

		highlight_states = { 
			SOV_transform_kuban = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 234
			has_full_control_of_state = 238
			has_full_control_of_state = 237
			has_full_control_of_state = 235
			num_of_civilian_factories_available_for_projects > 7
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 234
				has_full_control_of_state = 238
				has_full_control_of_state = 237
				has_full_control_of_state = 235
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 25
		days_remove = 270
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 8
		}

		remove_effect = {
			economy_fatigue_level_up_2 = yes
			234 = {
				add_extra_state_shared_building_slots = 2
			}
			238 = {
				add_extra_state_shared_building_slots = 2
			}
			237 = {
				add_extra_state_shared_building_slots = 2
			}
			235 = {
				add_extra_state_shared_building_slots = 2
			}
			hidden_effect = {
				set_country_flag = kuban_transformed
			}
		}
	}
	kuban_agricultural_construction = {

		icon = generic_industry

		highlight_states = { 
			SOV_transform_kuban = yes
		}

		available = {
			tag = SOV
			has_war = no
			has_full_control_of_state = 234
			has_full_control_of_state = 238
			has_full_control_of_state = 237
			has_full_control_of_state = 235
			num_of_civilian_factories_available_for_projects > 11
			has_country_flag = kuban_transformed
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		visible = {
			tag = SOV
			has_completed_focus = SOV_tranformation_of_nature
			has_war = no
			#has_country_leader = { ruling_only = yes name = "Joseph Stalin" }
		}

		cancel_trigger = {
			NOT = { 
				has_full_control_of_state = 234
				has_full_control_of_state = 238
				has_full_control_of_state = 237
				has_full_control_of_state = 235
			}
		}

		ai_will_do = {
			factor = 100
		}

		cost = 0
		days_remove = 30
        fire_only_once = yes

		modifier = {
			civilian_factory_use = 12
		}

		remove_effect = {
			economy_fatigue_level_up_4 = yes
			234 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			238 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			237 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
			235 = {
				add_building_construction = {
					type = industrial_complex
					level = 2
					instant_build = yes
				}
			}
		}
	}
}

#### ##    ## ########  ##     ##  ######  ######## ########  ##    ##    ########  ######## ##        #######   ######     ###    ######## ####  #######  ##    ## 
 ##  ###   ## ##     ## ##     ## ##    ##    ##    ##     ##  ##  ##     ##     ## ##       ##       ##     ## ##    ##   ## ##      ##     ##  ##     ## ###   ## 
 ##  ####  ## ##     ## ##     ## ##          ##    ##     ##   ####      ##     ## ##       ##       ##     ## ##        ##   ##     ##     ##  ##     ## ####  ## 
 ##  ## ## ## ##     ## ##     ##  ######     ##    ########     ##       ########  ######   ##       ##     ## ##       ##     ##    ##     ##  ##     ## ## ## ## 
 ##  ##  #### ##     ## ##     ##       ##    ##    ##   ##      ##       ##   ##   ##       ##       ##     ## ##       #########    ##     ##  ##     ## ##  #### 
 ##  ##   ### ##     ## ##     ## ##    ##    ##    ##    ##     ##       ##    ##  ##       ##       ##     ## ##    ## ##     ##    ##     ##  ##     ## ##   ### 
#### ##    ## ########   #######   ######     ##    ##     ##    ##       ##     ## ######## ########  #######   ######  ##     ##    ##    ####  #######  ##    ## 

#Category only allowed for SOV
SOV_industry_relocation = {
	
	move_leningrad_aluminium_plant = { #195

		icon = aluminium
		
		highlight_states = {
			highlight_state_targets = {
				state = 195
			}
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			has_full_control_of_state = 195
			has_full_control_of_state = 569
			has_equipment = { train_equipment > 19 } #20 trains per factory
		}

		visible = {
			has_completed_focus = SOV_move_industry_to_the_urals
			controls_state = 195
			controls_state = 569
			195 = { has_state_flag = leningrad_aluminium_developed }
			has_civil_war = no
		}

		fire_only_once = yes

		cost = 25
		days_remove = SOV_industrial_relocation_days

		modifier = {
			
		}

		ai_will_do = {
			factor = 0.5
			modifier = {
				factor = 200 # oh shit they are getting close!
				OR = {
					AND = {
						owns_state = 208
						NOT = { controls_state = 208 }
					}
					AND = {
						owns_state = 209
						NOT = { controls_state = 209 }
					}
					AND = {
						owns_state = 244
						NOT = { controls_state = 244 }
					}
					AND = {
						owns_state = 263
						NOT = { controls_state = 263 }
					}
					AND = {
						owns_state = 191
						NOT = { controls_state = 191 }
					}
					AND = {
						owns_state = 146
						NOT = { controls_state = 146 }
					}
				}
			}
			modifier = {
				factor = 0
				SOV_save_pp_for_manpower_trouble = yes
			}
		}

		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision_aluminium_negative
					producer = SOV
				}
			}
			195 = {
				add_resource = {
					type = bauxite
					amount = -12
				}				
			}
			custom_effect_tooltip = SOV_industry_relocation_aluminium_plant_trains_tt
		}

		remove_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision_aluminium
					producer = SOV
				}
			}
			if = {
				limit = {
					controls_state = 569
				}
				569 = {
					add_resource = {
						type = bauxite
						amount = 12
					}
				}
			}
			custom_effect_tooltip = SOV_relocate_industry_from_leningrad_tt
		}
	}

	SOV_relocate_industry_from_moscow_area = {

		icon = generic_construction

		highlight_states = {
			state = 219
		}	

		available = {
			219 = { #Moscow
				is_owned_and_controlled_by = SOV
			} 
			573 = { is_owned_and_controlled_by = SOV } #Zlatoust
			876 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
			has_equipment = { train_equipment > 79 } #20 trains per factory
		}

		visible = {
			has_war = yes
		}

		fire_only_once = yes

		cost = 25
		days_remove = 14

		modifier = {
			
		}

		ai_will_do = {
			factor = 200
		} 

		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision_negative
					producer = SOV
				}
			}
			custom_effect_tooltip = SOV_industry_relocation_trains_tt
		}

		remove_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision
					producer = SOV
				}
			}
			if = {
				limit = {
					controls_state = 219
				}
				219 = { #Moscow
					remove_building = {
						type = arms_factory
						level = 12
					}
					remove_building = {
						type = industrial_complex
						level = 7
					}
					remove_building = {
						type = steel_refinery
						level = 4
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 14
					add_building_construction = {
						type = arms_factory
						level = 6
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 4
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				876 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 9
					add_building_construction = {
						type = arms_factory
						level = 6
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 246
				}
				246 = { #Rzhev
					remove_building = {
						type = arms_factory
						level = 4
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				876 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
				
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 242
				}
				242 = { #Rzhev
					remove_building = {
						type = arms_factory
						level = 1
					}
					remove_building = {
						type = industrial_complex
						level = 3
					}
				}
				573 = { #Zlatoust
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 1
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_moscow_tt
		}
	}

	SOV_relocate_industry_from_leningrad_area = {

		icon = generic_construction

		highlight_states = {
			state = 195
		}

		available = {
			195 = { #Leningrad
				is_owned_and_controlled_by = SOV
				arms_factory > 4
				industrial_complex > 0
			}
			653 = { is_owned_and_controlled_by = SOV } #Zlatoust
			572 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		visible = {
			has_war = yes
		}

		fire_only_once = yes

		cost = 25
		days_remove = 14

		modifier = {
			
		}

		ai_will_do = {
			factor = 200
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 195
				}
				195 = { #Leningrad
					remove_building = {
						type = arms_factory
						level = 6
					}
					remove_building = {
						type = industrial_complex
						level = 1
					}
					remove_building = {
						type = steel_refinery
						level = 3
					}
				}
	
				653 = { #Zlatoust
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
					}
				}
				572 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 208
				}
				208 = { #Leningrad
					remove_building = {
						type = industrial_complex
						level = 5
					}
				}
	
				653 = { #Luga
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = industrial_complex
						level = 5
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.3 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 263
				}
				263 = { #Novogrod
					remove_building = {
						type = industrial_complex
						level = 5
					}
					remove_building = {
						type = arms_factory
						level = 3
					}
				}
	
				256 = { #Cheboksary
					add_extra_state_shared_building_slots = 8
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 5
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.1 }
						damage_building = { type = industrial_complex damage = 0.3 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 209
				}
				263 = { #Pskov
					remove_building = {
						type = arms_factory
						level = 2
					}
				}
	
				256 = { #Cheboksary
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_leningrad_tt
		}
	}

	SOV_relocate_industry_from_stalingrad_area = {

		icon = generic_construction

		highlight_states = {
			state = 217
		}

		available = {
			217 = { #Stalingrad
				is_owned_and_controlled_by = SOV
				industrial_complex > 1
			}
			573 = { is_owned_and_controlled_by = SOV } #Zlatoust
			876 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 14

		modifier = {
			
		}

		ai_will_do = {
			factor = 200
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 217
				}
				217 = { #Stalingrad
					remove_building = {
						type = arms_factory
						level = 8
					}
					remove_building = {
						type = industrial_complex
						level = 6
					}
					remove_building = {
						type = steel_refinery
						level = 1
					}
				}
	
				398 = { #Zlatoust
					add_extra_state_shared_building_slots = 10
					add_building_construction = {
						type = arms_factory
						level = 6
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 4
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				651 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 218
				}
				218 = { #Rostov
					remove_building = {
						type = arms_factory
						level = 6
					}
					remove_building = {
						type = industrial_complex
						level = 1
					}
					remove_building = {
						type = steel_refinery
						level = 2
					}
				}
				651 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 9
					add_building_construction = {
						type = arms_factory
						level = 6
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 245
				}
				245 = { #Millerovo
					remove_building = {
						type = arms_factory
						level = 2
					}
					remove_building = {
						type = industrial_complex
						level = 1
					}
				}
				398 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_smolensk_tt
		}
	}

	SOV_relocate_industry_from_kharkov_area = {

		icon = generic_construction

		highlight_states = {
			state = 220
		}

		available = {
			220 = {
				is_owned_and_controlled_by = SOV
			}
			221 = {
				is_owned_and_controlled_by = SOV
			}
			652 = { is_owned_and_controlled_by = SOV } #Zlatoust
			251 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
		}

		fire_only_once = yes

		cost = 25
		days_remove = 14

		modifier = {
			
		}

		ai_will_do = {
			factor = 200
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 220
				}
				220 = { #Kursk
					remove_building = {
						type = arms_factory
						level = 6
					}
					remove_building = {
						type = industrial_complex
						level = 6
					}
				}
	
				652 = { #Zlatoust
					add_extra_state_shared_building_slots = 7
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				251 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 221
				}
				221 = { #Kharkov
					remove_building = {
						type = arms_factory
						level = 7
					}
					remove_building = {
						type = industrial_complex
						level = 2
					}
					remove_building = {
						type = steel_refinery
						level = 6
					}
				}
	
				652 = { #Zlatoust
					add_extra_state_shared_building_slots = 8
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				251 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 7
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 1
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 227
				}
				227 = { #Stalino
					remove_building = {
						type = industrial_complex
						level = 7
					}
					remove_building = {
						type = steel_refinery
						level = 2
					}
				}
	
				399 = { #Zlatoust
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = industrial_complex
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				249 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = steel_refinery
						level = 1
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 228
				}
				228 = { #Voroshilovgrad
					remove_building = {
						type = industrial_complex
						level = 5
					}
				}
	
				399 = { #Zlatoust
					add_extra_state_shared_building_slots = 2
					add_building_construction = {
						type = industrial_complex
						level = 2
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				249 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 3
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_smolensk_tt
		}
	}
	
	SOV_relocate_industry_from_kiev_area = {

		icon = generic_construction

		highlight_states = {
			state = 202
		}

		available = {
			202 = {
				is_owned_and_controlled_by = SOV
			}
			400 = { is_owned_and_controlled_by = SOV } #Zlatoust
			399 = { is_owned_and_controlled_by = SOV } #Magnitogorsk
			251 = { is_owned_and_controlled_by = SOV } #Kuibyshev
		}

		fire_only_once = yes

		cost = 25
		days_remove = 14

		modifier = {
			
		}

		ai_will_do = {
			factor = 200
		}

		remove_effect = {
			if = {
				limit = {
					controls_state = 202
				}
				202 = { #Kiev
					remove_building = {
						type = arms_factory
						level = 7
					}
					remove_building = {
						type = industrial_complex
						level = 6
					}
				}
	
				400 = { #Zlatoust
					add_extra_state_shared_building_slots = 7
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				399 = { #Magnitogorsk
					add_extra_state_shared_building_slots = 6
					add_building_construction = {
						type = arms_factory
						level = 3
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.2 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 193
				}
				193 = { #Chernigov
					remove_building = {
						type = arms_factory
						level = 2
					}
					remove_building = {
						type = industrial_complex
						level = 3
					}
				}
	
				400 = { #Zlatoust
					add_extra_state_shared_building_slots = 5
					add_building_construction = {
						type = arms_factory
						level = 2
						instant_build = yes
					}
					add_building_construction = {
						type = industrial_complex
						level = 3
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			if = {
				limit = {
					controls_state = 226
				}
				226 = {
					remove_building = {
						type = arms_factory
						level = 4
					}
				}
	
				251 = {
					add_extra_state_shared_building_slots = 4
					add_building_construction = {
						type = arms_factory
						level = 4
						instant_build = yes
					}
	
					hidden_effect = {			
						damage_building = { type = arms_factory damage = 0.3 }
						damage_building = { type = industrial_complex damage = 0.1 }
					}
				}
				custom_effect_tooltip = relocate_industry_repair
			}
			custom_effect_tooltip = SOV_relocate_industry_from_smolensk_tt
		}
	}
}

war_measures = {
	
	SOV_generic_industry_relocation = {
		priority = 10

		icon = generic_construction

		state_target = yes

		#targets = { core_states }

		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of = ROOT
				is_fully_controlled_by = ROOT
				is_on_continent = europe
				OR = {
					has_state_category = town
					has_state_category = large_town
					has_state_category = city
					has_state_category = large_city
					has_state_category = megalopolis
					has_state_category = metropolis
				}
				infrastructure > 2
			}
		}

		target_root_trigger = {
			original_tag = SOV
			has_completed_focus = SOV_move_industry_to_the_urals
			has_civil_war = no
		}

		allowed = {
			original_tag = SOV
		}

		available = {
			FROM = {
				is_fully_controlled_by = ROOT
				infrastructure > 2
			}
			has_equipment = { train_equipment > 79 } #20 trains per factory
		}

		visible = {
			FROM = {
				OR = { #Has at least 4 factories
					arms_factory > 3
					industrial_complex > 3
					AND = {
						arms_factory > 1
						industrial_complex > 1
					}
				}
			}
		}

		cancel_if_not_visible = no

		cost = 15

		days_remove = SOV_industrial_relocation_days

		complete_effect = {  #Attempt to remove 2 CIVS & 2 MILS
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision_negative
					producer = SOV
				}
			}
			custom_effect_tooltip = SOV_industry_relocation_trains_tt
			custom_effect_tooltip = SOV_industry_relocation_complete_effect_tt
			#REMOVE factories
			FROM = {
				hidden_effect = {
					set_temp_variable = { SOV_factories_counter = 0 }

					#Attempt to relocate 50%-50% of mils-civs
					set_temp_variable = { SOV_half_the_factories_to_relocate = SOV.SOV_industrial_relocation_max_factories }
					divide_temp_variable = { SOV_half_the_factories_to_relocate = 2 }
					while_loop_effect = {
						limit = {
							check_variable = { SOV_factories_counter = SOV.SOV_industrial_relocation_max_factories compare = less_than }
						}
						if = { #GO MILS (if possible)
							limit = {
								check_variable = { SOV_factories_counter = SOV_half_the_factories_to_relocate compare = less_than }
							}
							if = {
								limit = {
									arms_factory > 1
								}
								remove_building = {
									type = arms_factory
									level = 2
								}
								if = {
									limit = {
										has_state_flag = SOV_mils_removed_flag
									}
									modify_state_flag = { flag = SOV_mils_removed_flag value = 2 }
								}
								else = {
									set_state_flag = SOV_mils_removed_flag
								}
							}
							else_if = {
								limit = {
									industrial_complex > 1
								}
								remove_building = {
									type = industrial_complex
									level = 2
								}
								if = {
									limit = {
										has_state_flag = SOV_civs_removed_flag
									}
									modify_state_flag = { flag = SOV_civs_removed_flag value = 2 }
								}
								else = {
									set_state_flag = SOV_civs_removed_flag
								}
							}
						}
						else = { #GO CIVS (if possible)
							if = {
								limit = {
									industrial_complex > 1
								}
								remove_building = {
									type = industrial_complex
									level = 2
								}
								if = {
									limit = {
										has_state_flag = SOV_civs_removed_flag
									}
									modify_state_flag = { flag = SOV_civs_removed_flag value = 2 }
								}
								else = {
									set_state_flag = SOV_civs_removed_flag
								}
							}
							else_if = {
								limit = {
									arms_factory > 1
								}
								remove_building = {
									type = arms_factory
									level = 2
								}
								if = {
									limit = {
										has_state_flag = SOV_mils_removed_flag
									}
									modify_state_flag = { flag = SOV_mils_removed_flag value = 2 }
								}
								else = {
									set_state_flag = SOV_mils_removed_flag
								}
							}
						}
						add_to_temp_variable = { SOV_factories_counter = 1 }
					}
				}
			}
		}

		remove_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = {
					type = train_equipment
					amount = SOV_industrial_relocation_trains_decision
					producer = SOV
				}
			}
			custom_effect_tooltip = SOV_industry_relocation_remove_effect_tt
			#RELOCATE FACTORIES
			FROM = {
				set_temp_variable = { SOV_factories_counter = 0 }
				#Factories attempt to get relocated in 2 different states
				set_temp_variable = { SOV_half_the_factories_to_relocate = SOV.SOV_industrial_relocation_max_factories }
				divide_temp_variable = { SOV_half_the_factories_to_relocate = 2 }
				while_loop_effect = { #NOTE: Due to the seed not changing during the execution of this effect, the same state will always be chosen, UNLESS it runs out of slots -> That's the reason for this
					limit = {
						check_variable = { SOV_factories_counter = SOV_half_the_factories_to_relocate compare = less_than }
					}
					SOV_relocate_industry_in_appropriate_state_effect = yes
					add_to_temp_variable = { SOV_factories_counter = 1 }
				}
			}
			custom_effect_tooltip = SOV_relocate_industry_repair_tt
			custom_effect_tooltip = SOV_relocate_industry_lose_control_tt
		}
	}
	
	SOV_relocate_capital_from_moscow = {
		icon = generic_operation
		available = {
			tag = SOV
			has_war = yes
			has_civil_war = no
			OR = {
				NOT = { SOV = { has_full_control_of_state = 219 } }
				NOT = { SOV = { has_full_control_of_state = 217 } }
			}
			SOV = { has_full_control_of_state = 249 }
		}
		visible = {
			tag = SOV
			has_war = yes
			NOT = { SOV = { has_full_control_of_state = 219 } }
		}

		days_remove = 14
		is_good = yes
		cost = 25

		cancel_if_not_visible = yes

		ai_will_do = {
			factor = 150
		}

		remove_effect = {
			set_capital = { state = 249 }
		}
	}

	SOV_relocate_capital_from_kazan = {
		icon = generic_operation
		available = {
			tag = SOV
			has_war = yes
			NOT = { SOV = { has_full_control_of_state = 249 } }
			SOV = { has_full_control_of_state = 572 }
		}
		visible = {
			tag = SOV
			has_war = yes
			NOT = { SOV = { has_full_control_of_state = 249 } }
		}

		days_remove = 14
		is_good = yes
		cost = 25

		cancel_if_not_visible = yes

		ai_will_do = {
			factor = 150
		}

		remove_effect = {
			set_capital = { state = 572 }
		}
	}
}

operations = {

	SOV_tehran_treaty_mission = {

		icon = generic_civil_support

		allowed = {
			original_tag = SOV
		}

		#Fail trigger
		available = {
			has_war_With = JAP
		}

		days_mission_timeout = 90

		fire_only_once = yes

		is_good = yes

		activation = {
			tag = SOV
			NOT = { has_war_with = GER }
			NOT = { has_war_with = JAP }
			is_faction_leader = yes
			has_government = communism
			NOT = { is_puppet_of = GER }
			NOT = {
				has_war_with = ENG
			}
			NOT = {
				has_war_with = USA
			}
			JAP = {
				OR = {
					has_war_with = ENG
					has_war_with = USA
				}
			}
			has_country_flag = agreed_to_tehran_conference
		}

		#Success
		timeout_effect = {
			if = {
				limit = {
					527 = { is_controlled_by = JAP }
				}
				declare_war_on = {
					target = JAP
					type = take_state_focus
					generator = { 527 845 846 537 555 }
				} 
			}
			else = {
				declare_war_on = {
					target = JAP
					type = take_state_focus
					generator = { 537 555 }
				}
			}
		}
		#Fail
		complete_effect = {
		}
	}
	

	SOV_seize_manchuria = {

		icon = generic_operation

		allowed = {
			original_tag = SOV
		}

		available = {
			JAP = { has_completed_focus = JAP_pre_emptive_coup }
			MAN = { is_puppet = no }
			NOT = {
				has_war_with = MAN
			}
		}

		cost = 25
		fire_only_once = yes
		visible = {
			JAP = { has_completed_focus = JAP_strengthen_civilian_government }
			MAN = { exists = yes }
		}

		complete_effect = {
			create_wargoal = {
				target = MAN
				type = annex_everything
			}			
		}

		ai_will_do = {
			factor = 1
			modifier = {
				MAN = {
					is_ai = no
				}
				factor = 0 #we're mean but not that mean
			}
			modifier = {
				threat < 0.25
				factor = 0
			}
		}
	}
}

SOV_military_reform = {
	SOV_army_reform = {

		icon = generic_prepare_civil_war

		available = {
			tag = SOV
			if = {
				limit = {
					NOT = { has_country_flag = SOV_army_reform_1 }
				}
				has_army_experience > 149
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = SOV_army_reform_3 }
					has_idea = order_227
				}
				has_army_experience > 149
			}
			else_if = {
				limit = {
					NOT = { has_country_flag = SOV_army_reform_3 }
					has_completed_focus = SOV_war_heroes
				}
				has_army_experience > 199
			}
			OR = {
				NOT = { has_country_flag = SOV_army_reform_1 }
				AND = {
					custom_trigger_tooltip = {
						tooltip = SOV_has_not_officers_purged_tt
						NOT = { has_idea = SOV_purged_junior_army_officers_1 }
						NOT = { has_idea = SOV_purged_junior_army_officers_2 }
					}
				}
			}
		}

		visible = {
			NOT = { has_country_flag = SOV_army_reform_3 }
		}

		cost = 0
		ai_will_do = {
			factor = 5000
		}
		days_remove = 30

		remove_effect = {
			if = {
				limit = {
					NOT = { has_country_flag = SOV_army_reform_1 }
				}
				hidden_effect = {
					set_country_flag = SOV_army_reform_1
				}
				add_to_variable = { SOV_the_red_army_army_org_factor = 0.25 }
				add_to_variable = { SOV_the_red_army_army_speed_factor = 0.2 }
				add_to_variable = { SOV_the_red_army_army_attack_factor = 0.2 }
				add_to_variable = { SOV_the_red_army_experience_loss_factor = -0.25 }
				add_to_variable = { SOV_the_red_army_land_doctrine_cost_factor = -0.4 }
				custom_effect_tooltip = SOV_army_reform_1_tt
			}
			else_if = {
				limit = {
					has_country_flag = SOV_army_reform_1
					has_country_flag = SOV_army_reform_2
					NOT = { has_country_flag = SOV_army_reform_3 }
				}
				hidden_effect = {
					set_country_flag = SOV_army_reform_3
				}
				set_variable = { SOV_the_red_army_army_org_factor = 0 }
				add_to_variable = { SOV_the_red_army_land_doctrine_cost_factor = -0.6 }
				custom_effect_tooltip = SOV_army_reform_4_tt
			}
			else_if = {
				limit = {
					has_country_flag = SOV_army_reform_1
					NOT = { has_country_flag = SOV_army_reform_2 }
					NOT = { has_country_flag = SOV_army_reform_3 }
				}
				hidden_effect = {
					set_country_flag = SOV_army_reform_2
					set_country_flag = SOV_army_reform_3
				}
				add_to_variable = { SOV_the_red_army_experience_gain_army_factor = 0.1 }
				set_variable = { SOV_the_red_army_army_org_factor = 0 }
				add_to_variable = { SOV_the_red_army_land_doctrine_cost_factor = -0.6 }
				custom_effect_tooltip = SOV_army_reform_3_tt
			}
		}
		complete_effect = {
			if = {
				limit = {
					OR = {
						NOT = { has_country_flag = SOV_army_reform_1 }
						has_country_flag = SOV_army_reform_2
					}
				}
				army_experience = -150
			}
			else = {
				army_experience = -200			
			}			
		}		
	}

	SOV_air_reform = {

		icon = generic_prepare_civil_war

		available = {
			tag = SOV 
			has_air_experience > 199
			has_completed_focus = SOV_evolution_of_the_air_strategy
			OR = {
				NOT = { has_country_flag = SOV_air_reform_1 }
				AND = {
					has_country_flag = SOV_air_reform_1
					custom_trigger_tooltip = {
						tooltip = SOV_has_not_officers_purged_tt
						NOT = { has_idea = SOV_purged_junior_army_officers_1 }
						NOT = { has_idea = SOV_purged_junior_army_officers_2 }
					}
				}
			}
		}

		visible = {
			NOT = { has_country_flag = SOV_air_reform_2 }
		}

		cost = 0
		ai_will_do = {
			factor = 500
		}
		days_remove = 30

		remove_effect = {
			if = {
				limit = {
					NOT = { has_country_flag = SOV_air_reform_1 }
				}
				set_country_flag = SOV_air_reform_1
				add_to_variable = { SOV_soviet_airforce_air_mission_xp_gain_factor = 0.3 }
				add_to_variable = { SOV_soviet_airforce_air_doctrine_cost_factor = -0.5 }
				custom_effect_tooltip = SOV_air_reform_1_tt
			}
			else = {
				set_country_flag = SOV_air_reform_2
				add_to_variable = { SOV_soviet_airforce_air_mission_xp_gain_factor = 0.4 }
				add_to_variable = { SOV_soviet_airforce_air_doctrine_cost_factor = -0.5 }
				add_to_variable = { SOV_soviet_airforce_air_agility_factor = 0.15 }
				add_to_variable = { SOV_soviet_airforce_air_attack_factor = 0.15 }
				add_to_variable = { SOV_soviet_airforce_air_cas_present_factor = 0.15 }
				custom_effect_tooltip = SOV_air_reform_2_tt
			}
		}
		complete_effect = {
			air_experience = -200
		}		
	}

	SOV_naval_reform = {

		icon = generic_prepare_civil_war

		available = {
			tag = SOV 
			has_navy_experience > 99
			has_completed_focus = SOV_advanced_maneuvers
			OR = {
				NOT = { has_country_flag = SOV_navy_reform_1 }
				AND = {
					has_country_flag = SOV_navy_reform_1
					custom_trigger_tooltip = {
						tooltip = SOV_has_not_officers_purged_tt
						NOT = { has_idea = SOV_purged_junior_army_officers_1 }
						NOT = { has_idea = SOV_purged_junior_army_officers_2 }
					}
				}
			}
		}

		visible = {
			NOT = { has_country_flag = SOV_navy_reform_2 }
		}

		cost = 0
		ai_will_do = {
			factor = 500
		}
		days_remove = 30

		remove_effect = {
			if = {
				limit = {
					NOT = { has_country_flag = SOV_navy_reform_1 }
				}
				set_country_flag = SOV_navy_reform_1
				add_to_variable = { SOV_red_fleet_navy_carrier_air_attack_factor = 0.2 }
				add_to_variable = { SOV_red_fleet_navy_capital_ship_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_capital_ship_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_navy_submarine_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_submarine_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_navy_screen_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_screen_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_naval_doctrine_cost_factor = -0.5 }
				custom_effect_tooltip = SOV_navy_reform_1_tt
			}
			else = {
				set_country_flag = SOV_navy_reform_2
				add_to_variable = { SOV_red_fleet_navy_carrier_air_attack_factor = 0.2 }
				add_to_variable = { SOV_red_fleet_navy_capital_ship_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_capital_ship_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_navy_submarine_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_submarine_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_navy_screen_attack_factor = 0.1 }
				add_to_variable = { SOV_red_fleet_navy_screen_defence_factor = 0.05 }
				add_to_variable = { SOV_red_fleet_naval_doctrine_cost_factor = -0.5 }
				custom_effect_tooltip = SOV_navy_reform_2_tt
			}
		}
		complete_effect = {
			navy_experience = -100
		}		
	}
}

political_actions = {

	SOV_negotiate_an_end_to_the_winter_war = {

		icon = eng_trade_unions_support
		
		available = {
			has_war_with = FIN
			NOT = {
				any_enemy_country = {
					is_major = yes
				}
			}
			has_country_flag = SOV_winter_war_time_passed
		}

		visible = {
			original_tag = SOV
			has_war_with = FIN
			OR = {
				FIN = { is_in_faction = no }
				FIN = { is_faction_leader = yes }
			}
			146 = { is_owned_by = FIN }
			NOT = {
				any_enemy_country = {
					is_major = yes
				}
			}
		}

		cost = 0
		fire_only_once = yes

		ai_will_do = {
			factor = 200
			
			modifier = {
				factor = 0
				OR = {
					146 = { is_controlled_by = SOV }
					111 = { is_controlled_by = SOV }
					879 = { is_controlled_by = SOV }
					870 = { is_controlled_by = SOV }
				}
			}
		}
		
		complete_effect = {
			hidden_effect = {
				if = {
					limit = {
						SOV = { has_full_control_of_state = 146 }
					}
					FIN = { set_country_flag = SOV_karjala_is_ours }
				}
			}
			FIN = { country_event = { id = sov_armor.851 days = 1 } }
		}
	}
	


	SOV_demand_bessarabia = {

		allowed = {
			original_tag = SOV
		}

		available = {
			ROM = { exists = yes }
			NOT = { has_war_with = ROM }
			is_neighbor_of	= ROM
			NOT = { has_country_flag = bessarabia_demand }
			78 = {
				is_claimed_by = SOV
				is_owned_by = ROM
			}
			OR = {
				has_country_flag = FRA_eastern_withdrawl
				has_completed_focus = SOV_begin_the_revolution
				FRA = { has_capitulated = yes }
				is_in_faction_with = FRA
				has_war_with = FRA
			}
			OR = {
				has_country_flag = GER_eastern_withdrawl
				has_completed_focus = SOV_begin_the_revolution
				GER = { has_capitulated = yes }
				is_in_faction_with = GER
				has_war_with = GER
				has_idea = SOV_molotov_ribbentrop_pact
			}
		}

		visible = {
			ROM = { exists = yes }
			NOT = { has_war_with = ROM }
			NOT = { has_country_flag = bessarabia_demand }
			has_completed_focus = SOV_claim_on_bessarabia
			78 = {
				is_claimed_by = SOV
				is_owned_by = ROM
			}
		}

		cost = 0
		fire_only_once = yes

		days_remove = 7

		remove_effect = {
			SOV = { country_event = { id = soviet.30 } }
		}

		ai_will_do = {
			factor = 400
		}
	}

	SOV_demand_karjala = {

		allowed = {
			original_tag = SOV
		}

		available = {
			FIN = { exists = yes }
			NOT = { has_war_with = FIN }
			is_neighbor_of	= FIN
			NOT = { has_country_flag = karjala_demand }
			NOT = { FIN = { is_subject_of = SOV } }
			NOT = {
				SOV = {
					controls_state = 146
				}
			}
		}

		visible = {
			FIN = { exists = yes }
			NOT = { has_war_with = FIN }
			NOT = { FIN = { is_subject_of = SOV } }
			NOT = { has_country_flag = karjala_demand }
			has_completed_focus = SOV_secure_leningrad
			NOT = {
				SOV = {
					controls_state = 146
				}
			}
		}

		cost = 0
		fire_only_once = yes

		days_remove = 30

		remove_effect = {
			SOV = { country_event = { id = soviet.31 } }
		}

		ai_will_do = {
			factor = 1000
			
			modifier = {
				factor = 0
				threat > 0.78
			}

			modifier = {
				factor = 0
				date < "1939.10.20"
				is_historical_focus_on = yes
			}
		}
	}

	SOV_estonian_ultimatum = {

		allowed = {
			original_tag = SOV
		}

		available = {
			EST = { exists = yes }
			NOT = { has_war_with = EST }
			NOT = { has_country_flag = estonia_demand }
			OR = {
				has_country_flag = FRA_eastern_withdrawl
				FRA = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = FRA
				has_war_with = FRA
			}
			OR = {
				has_country_flag = GER_eastern_withdrawl
				GER = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = GER
				has_war_with = GER
				has_idea = SOV_molotov_ribbentrop_pact
			}
		}

		visible = {
			EST = { exists = yes }
			NOT = { has_war_with = EST }
			NOT = { has_country_flag = estonia_demand }
			has_completed_focus = SOV_claims_in_baltic
		}

		cost = 0
		fire_only_once = yes

		days_remove = 7

		remove_effect = {
			SOV = { country_event = { id = soviet.32 } }
		}

		ai_will_do = {
			factor = 1000
		}
	}

	SOV_latvian_ultimatum = {

		allowed = {
			original_tag = SOV
		}

		available = {
			LAT = { exists = yes }
			NOT = { has_war_with = LAT }
			NOT = { has_country_flag = latvia_demand }
			OR = {
				has_country_flag = FRA_eastern_withdrawl
				FRA = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = FRA
				has_war_with = FRA
			}
			OR = {
				has_country_flag = GER_eastern_withdrawl
				GER = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = GER
				has_war_with = GER
				has_idea = SOV_molotov_ribbentrop_pact
			}
		}

		visible = {
			LAT = { exists = yes }
			NOT = { has_war_with = LAT }
			NOT = { has_country_flag = latvia_demand }
			has_completed_focus = SOV_claims_in_baltic
		}

		cost = 0
		fire_only_once = yes

		days_remove = 7

		remove_effect = {
			SOV = { country_event = { id = soviet.33 } }
		}

		ai_will_do = {
			factor = 1000
		}
	}

	SOV_lithuanian_ultimatum = {

		allowed = {
			original_tag = SOV
		}

		available = {
			LIT = { exists = yes }
			NOT = { has_war_with = LIT }
			NOT = { has_country_flag = lithuania_demand }
			OR = {
				has_country_flag = FRA_eastern_withdrawl
				FRA = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = FRA
				has_war_with = FRA
			}
			OR = {
				has_country_flag = GER_eastern_withdrawl
				GER = { has_capitulated = yes }
				has_completed_focus = SOV_begin_the_revolution
				is_in_faction_with = GER
				has_war_with = GER
				has_idea = SOV_molotov_ribbentrop_pact
			}
		}

		visible = {
			LIT = { exists = yes }
			NOT = { has_war_with = LIT }
			NOT = { has_country_flag = lithuania_demand }
			has_completed_focus = SOV_claims_in_baltic
		}

		cost = 0
		fire_only_once = yes

		days_remove = 7

		remove_effect = {
			SOV = { country_event = { id = soviet.34 } }
		}

		ai_will_do = {
			factor = 400
		}
	}

	SOV_return_manchuria = {

		allowed = {
			original_tag = SOV
		}

		available = {
			OR = {
				AND = {
					owns_state = 610
					owns_state = 716
					owns_state = 328
					owns_state = 715
					owns_state = 714
					owns_state = 717
				}
				AND = {
					MAN = { is_puppet_of = SOV }
					owns_state = 610
					owns_state = 716
					owns_state = 328
					owns_state = 715
					owns_state = 714
					owns_state = 717
				}
			}
		}
		cost = 0
		fire_only_once = yes
		visible = {
			JAP = { has_completed_focus = JAP_strengthen_civilian_government }
			PRC = { exists = yes }
		}

		complete_effect = {
			PRC = { 
				transfer_state = 609
				transfer_state = 610
				transfer_state = 716
				transfer_state = 715
				transfer_state = 328
				transfer_state = 717
				transfer_state = 714
				country_event = { id = wtt_japan.125 }
			}		
		}

		ai_will_do = {
			factor = 1
		}
	}


	demand_full_integration = {

		allowed = {
			tag = SOV			
		}

		icon = generic_political_actions

		available = {
			FROM = { has_soviet_tribute = yes }
		}

		cost = WTT_communist_china_integration_cost?300

		visible = {
			has_government = communism
			FROM = { has_country_flag = WTT_support_from_soviet }
		}

		targets = { CHI PRC GXC YUN SHX XSM SIK SIC XIK GUC D01 D02 D03 D04 D05 D06 D07 D08 D09 D10 D11 D12 D13 D14 D15 }

		target_trigger = {
			FROM = { has_country_flag = WTT_support_from_soviet }
		}

		ai_will_do = {
			base = 0
			modifier = {
				add = 100
				#Has won against CHI and JAP
				595 = { is_controlled_by = FROM }
				596 = { is_controlled_by = FROM }
				597 = { is_controlled_by = FROM }
				598 = { is_controlled_by = FROM }
				600 = { is_controlled_by = FROM }
				601 = { is_controlled_by = FROM }
				602 = { is_controlled_by = FROM }
				603 = { is_controlled_by = FROM }
				605 = { is_controlled_by = FROM }
				606 = { is_controlled_by = FROM }
				607 = { is_controlled_by = FROM }
				608 = { is_controlled_by = FROM }
				613 = { is_controlled_by = FROM }
				614 = { is_controlled_by = FROM }
				620 = { is_controlled_by = FROM }
			}
			modifier = {
				add = 50
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 200 }
				}
			}
			modifier = {
				add = 50
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 150 }
				}
			}
			modifier = {
				add = 50
				FROM = {
					check_variable = { WTT_communist_china_integration_cost < 100 }
				}
			}
		}

		fire_only_once = yes

		complete_effect = {
			FROM = { country_event = { id = wtt_warlord_vs_prc.31 } }
		}
	}		

	#SOVIET MISSION TO OCCUPY TURKEY
	SOV_set_up_puppet_state_in_turkey = {

		icon = generic_civil_support

		allowed = {
			has_dlc = "Battle for the Bosporus"
			tag = SOV
		}

		available = {
			NOT = { army_manpower_in_state = { state = 354 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 353 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 352 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 349 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 350 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 355 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 800 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 344 amount < 28800 } }
			NOT = { army_manpower_in_state = { state = 348 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 356 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 346 amount < 9600 } }
			NOT = { army_manpower_in_state = { state = 345 amount < 28800 } }
			NOT = { army_manpower_in_state = { state = 343 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 347 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 339 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 342 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 343 amount < 48000 } }
			NOT = { army_manpower_in_state = { state = 49 amount < 124000 } }
		}

		target_trigger = {
			FROM = {
				original_tag = TUR
			}
		}

		cost = 50

		fire_only_once = yes

		days_remove = 90

		visible = {
			has_government = communism
			has_global_flag = GRE_turkey_surrenders
			FROM = {
				NOT = { 
					is_subject_of = SOV 
					is_subject_of = GRE
				}
			}
		}

		cancel_if_not_visible = yes

		remove_effect = {
		}

		complete_effect = {
			TUR = {
				country_event = { id = bftb_greece.34 }
			}
			hidden_effect = {
				clr_global_flag = GRE_turkey_surrenders
			}
		}

		ai_will_do = {
			factor = 0
		}
	}
}